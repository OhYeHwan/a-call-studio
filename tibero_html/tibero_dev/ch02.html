<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제2장 tbJDBC의 사용</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero 애플리케이션 개발자 안내서"/><link rel="up" href="index.html" title="Tibero 애플리케이션 개발자 안내서"/><link rel="prev" href="ch01.html" title="제1장 데이터 타입의 사용"/><link rel="next" href="ch03.html" title="제3장 트리거의 사용"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제2장 <span xmlns="http://www.w3.org/1999/xhtml">tbJDBC</span>의 사용</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="ch03.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="d5e818"/>제2장 <span>tbJDBC</span>의 사용</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="ch02.html#d5e824">2.1. 개요</a></span></dt><dt><span class="section"><a href="ch02.html#d5e846">2.2. JDK 설치</a></span></dt><dt><span class="section"><a href="ch02.html#d5e862">2.3. JDBC의 표준 기능</a></span></dt><dd><dl><dt><span class="section"><a href="ch02.html#d5e879">2.3.1. JDBC 1.0 및 JDBC 2.0</a></span></dt><dt><span class="section"><a href="ch02.html#d5e988">2.3.2. JDBC 3.0</a></span></dt><dt><span class="section"><a href="ch02.html#d5e1086">2.3.3. JDBC 4.0</a></span></dt></dl></dd><dt><span class="section"><a href="ch02.html#d5e1135">2.4. 기본 프로그래밍</a></span></dt><dd><dl><dt><span class="section"><a href="ch02.html#d5e1156">2.4.1. 접속</a></span></dt><dt><span class="section"><a href="ch02.html#d5e1190">2.4.2. 실행</a></span></dt><dt><span class="section"><a href="ch02.html#d5e1255">2.4.3. 호출</a></span></dt><dt><span class="section"><a href="ch02.html#d5e1298">2.4.4. 커밋과 롤백</a></span></dt><dt><span class="section"><a href="ch02.html#d5e1309">2.4.5. 접속 해제</a></span></dt></dl></dd></dl></div>
  

  <p>본 절에서는 <span>tbJDBC</span>의 사용법과 JDBC의 기본 기능, 프로그래밍에 대해서 기술한다.</p>

  <p/>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e824"/>2.1. 개요</h2></div></div></div>
    

    <p><span>Tibero</span>에서는 Java 프로그램 안에서 SQL 문장을 실행하기 위해 데이터베이스를 연결해주는 애플리케이션
    프로그램의 인터페이스를 제공한다. 이러한 인터페이스를 <span><strong class="guibutton"><span>tbJDBC</span></strong></span>(<span>Tibero</span>의 Java
    Database Connectivity)라 한다.<a id="d5e831" class="indexterm"/></p>

    <p><span>tbJDBC</span>는 JDK 버전이 1.4 이상의 환경에서 동작한다. JDBC 4.0을
    기능을 모두 사용하기 위해서는 JDK 6 이상의 환경을 사용하여야 한다. JDK 6 이상에서 사용할 수 있는 드라이버 파일은
    <span><strong class="guibutton"><span>tibero7-jdbc.jar</span></strong></span> 파일의 형태로 제공되며, JDK
    버전이 1.4인 경우에는 <span><strong class="guibutton"><span>tibero7-jdbc-14.jar</span></strong></span> 파일의 형태로
    제공된다.<a id="d5e840" class="indexterm"/></p>

    <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
      <p>본 안내서에서는 JDBC 프로그래밍에 대해 간략히 설명한다. <span>tbJDBC</span>에 대한 자세한 내용은 "<span>Tibero</span> JDBC 개발자
      안내서"를 참고한다.</p>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e846"/>2.2. JDK 설치</h2></div></div></div>
    

    <p><span>tbJDBC</span>를 사용하기 위해서는 <span><strong class="guibutton">JDK
    1.4</strong></span> 이상이 반드시 설치되어 있어야 한다.</p>

    <p>다음 위치에서 JDK를 다운로드할 수 있다.</p>

    <pre class="programlisting"><a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_top">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a></pre>

    <p>만약 시스템이 Oracle사의 JDK를 사용하지 않는다면 각각의 시스템에 적합한 JDK를 찾아 설치한다. 예를 들어
    HP-UX는 HP, AIX는 IBM에서 JDK를 다운로드 받아 설치하면 된다.</p>

    <div class="literallayout"><p/></div>

    <p>각 시스템별 JDK를 설치하는 방법은 다음 위치에서 확인할 수 있다.</p>

    <pre class="programlisting"><a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.oracle.com/technetwork/java/index.html" target="_top">http://www.oracle.com/technetwork/java/index.html</a></pre>

    <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
      <p>벤더별 JDK 설치 방법은 각 벤더에서 제공하는 설치 안내서를 참고한다.</p>
    </div>

    <p/>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e862"/>2.3. JDBC의 표준 기능</h2></div></div></div>
    

    <p><span>tbJDBC</span>는 JDBC 4.0 표준을 준수한다. 다만, 표준에 따르면 필수적으로
    구현해야하는 부분과 벤더별로 구현여부를 선택 가능한 부분을 구분하여 명시하고 있으며, 이러한 추가 기능에 대해서는 지원하지 않을 수도
    있다. 또한 JDBC 4.0은 아래의 JDBC 표준을 모두 포함한다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>JDBC 3.0 API</p>
      </li><li>
        <p>JDBC 2.0 API(JDBC 2.0 Optional Package API and JDBC 2.1 core
        API)</p>
      </li><li>
        <p>JDBC 1.2 API</p>
      </li><li>
        <p>JDBC 1.0 API</p>
      </li></ul></div>

    <p>본 절에서는 <span>tbJDBC</span>에서 구현되는 표준 기능을 JDBC 버전 별로 간략히 설명한다. 보다
    자세한 내용은 Sun사에서 발행한 JDBC 4.0 Specification 문서를 참고한다.<a id="d5e877" class="indexterm"/></p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e879"/>2.3.1. JDBC 1.0 및 JDBC 2.0</h3></div></div></div>
      

      <p>본 절에서는 JDBC 1.0 및 JDBC 2.0의 표준 기능을 지원 여부에 따라 각각 설명한다.</p>

      <p/>

      <div class="literallayout"><p/></div>

      <h4><a id="d5e884"/>지원하는 기능</h4>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>SQL-99 데이터 타입</p>

          <p><span>tbJDBC</span>는 SQL-99에서 새롭게 추가된 데이터 타입 중에 BLOB와
          CLOB만을 지원한다. 따라서 이러한 데이터 타입을 <span>Tibero</span>에서
          사용할 때는 다음과 같은 규칙을 따른다.</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>Blob, Clob 인터페이스는 해당 트랜잭션이 수행 중인 동안만 유효하다.</p>
            </li><li>
              <p>Blob, Clob 인터페이스는 위치 지시자(LOCATOR)를 통해 구현된다. 위치 지시자는 데이터베이스
              서버에 존재하는 데이터의 논리적인 지시자(POINTER)이다.</p>
            </li></ul></div>
        </li><li>
          <p>인터페이스 메소드</p>

          <p>지원하는 인터페이스 메소드(Interface Method)는 다음과 같다.<a id="d5e899" class="indexterm"/></p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>java.sql.Array</p>
            </li><li>
              <p>java.sql.Blob</p>
            </li><li>
              <p>java.sql.CallableStatement</p>
            </li><li>
              <p>java.sql.Clob</p>
            </li><li>
              <p>java.sql.Connection</p>
            </li><li>
              <p>java.sql.DatabaseMetaData</p>
            </li><li>
              <p>java.sql.Driver</p>
            </li><li>
              <p>java.sql.PreparedStatement</p>
            </li><li>
              <p>java.sql.ResultSet</p>
            </li><li>
              <p>java.sql.ResultSetMetaData</p>
            </li><li>
              <p>java.sql.Statement</p>
            </li><li>
              <p>java.sql.Struct</p>
            </li></ul></div>
        </li><li>
          <p>정적 초기화를 구현한 드라이버</p>

          <p>java.sql.Driver 인터페이스 메소드를 구현한 드라이버 클래스는 정적 초기화 블록(Static
          block)에서 Drivermanager.registerDriver 메소드를 호출함으로써, 새로 생성한 드라이버 인스턴스를
          드라이버 관리자(Driver Manager)에 등록할 수 있다.</p>
        </li><li>
          <p>SQL-92 Entry Level의 확장 기능</p>

          <p>DROP TABLE과 ESCAPE 문을 사용할 수 있다.</p>
        </li><li>
          <p>스칼라 함수(Scalar Functions) <a id="d5e934" class="indexterm"/><a id="d5e936" class="indexterm"/></p>

          <p>데이터베이스 서버에서 지원하는 모든 스칼라 함수를 사용할 수 있다. 스칼라 함수는
          <span><strong class="guibutton">DatabaseMetaData</strong></span> 클래스를 통해 확인할 수 있다.</p>
        </li><li>
          <p>멀티스레딩(Multithreading)<a id="d5e942" class="indexterm"/></p>

          <p>여러 개의 스레드가 java.sql과 javax.sql 패키지 내에 존재하는 객체에 모든 연산을 동시에 수행할
          수 있다.</p>
        </li><li>
          <p>스크롤 가능한 결과 집합(Scrollable ResultSet)</p>

          <p>결과 집합을 전 방향 또는 후 방향으로 탐색할 수 있다. 또한 결과 집합 내에서 상대적이거나 절대적인 위치
          이동도 할 수 있다.</p>
        </li><li>
          <p>수정 가능한 결과 집합(Updatable ResultSet)</p>

          <p>결과 집합을 수정할 수 있다.</p>
        </li><li>
          <p>위치 설정을 통한 수정 및 삭제(Positioned Updates and Deletes)</p>

          <p>결과 집합의 커서에서 설정한 현재 위치의 레코드를 수정하거나 삭제하는 기능이다.</p>
        </li><li>
          <p>민감한 결과 집합(Sensitive ResultSet)</p>

          <p>결과 집합의 커서가 열린 후에 발생하는 데이터의 변화를 반영할 수 있다.</p>
        </li><li>
          <p>일괄 수정 작업(Batch Updates)</p>

          <p>여러 번의 수정 작업을 한꺼번에 처리할 수 있다.</p>
        </li><li>
          <p>RowSet 기술</p>

          <p>데이터를 편리하게 전달하고 처리할 수 있다.</p>
        </li><li>
          <p>분산 트랜잭션(Distrubuted Transactions)</p>

          <p>여러 데이터베이스 서버에 이르는 트랜잭션을 가능하게 한다.</p>
        </li></ul></div>

      <div class="literallayout"><p/></div>

      <h4><a id="d5e967"/>지원하지 않는 기능</h4>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>SQL-99 데이터 타입</p>

          <p><span>tbJDBC</span>는 SQL-99 데이터 타입 중에서 Array, Ref,
          Struct를 지원하지 않는다.</p>
        </li><li>
          <p>인터페이스 메소드</p>

          <p>지원하지 않는 인터페이스 메소드는 다음과 같다.</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>java.sql.Ref</p>
            </li><li>
              <p>java.sql.SQLData</p>
            </li><li>
              <p>java.sql.SQLInput</p>
            </li><li>
              <p>java.sql.SQLOutput</p>
            </li></ul></div>
        </li><li>
          <p>잘린(Truncated) 데이터 대한 예외 상황</p>

          <p>JDBC 드라이버가 예기치 않게 데이터 값을 잘라낸 경우 읽기를 할 때에는 Data Truncation 경고,
          쓰기를 할 때에는 Data Truncation 예외(Exception)를 발생시킨다.</p>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e988"/>2.3.2. JDBC 3.0</h3></div></div></div>
      

      <p>본 절에서는 JDBC 3.0의 표준 기능을 지원 여부에 따라 각각 설명한다. JDBC 3.0 API는 J2SE
      platform, version 1.4 이상의 환경에서 사용할 수 있다.</p>

      <h4><a id="d5e991"/>지원하는 기능</h4>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>인터페이스</p>

          <p>지원하는 인터페이스는 다음과 같다.</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>java.sql.ParameterMetaData</p>
            </li><li>
              <p>java.sql.Savepoints</p>
            </li><li>
              <p>javax.sql.ConnectionEventListener</p>
            </li><li>
              <p>javax.sql.ConnectionPoolDataSource</p>
            </li><li>
              <p>javax.sql.DataSource</p>
            </li><li>
              <p>javax.sql.PooledConnection</p>
            </li><li>
              <p>javax.sql.RowSet</p>
            </li><li>
              <p>javax.sql.RowSetInternal</p>
            </li><li>
              <p>javax.sql.RowSetListener</p>
            </li><li>
              <p>javax.sql.RowSetMetaData</p>
            </li><li>
              <p>javax.sql.RowSetReader</p>
            </li><li>
              <p>javax.sql.RowSetWriter</p>
            </li><li>
              <p>javax.sql.XAConnection</p>
            </li><li>
              <p>javax.sql.XADataSource</p>
            </li></ul></div>
        </li><li>
          <p>접속 풀링(Connection Pooling)의 설정<a id="d5e1027" class="indexterm"/></p>

          <p>최대 풀 크기, 최소 풀 크기, 초기 풀 크기 등과 같이 접속 풀링에 사용되는 다양한 파라미터를 설정할 수 있는
          API를 제공한다.</p>
        </li><li>
          <p>문장의 풀링(Statement Pooling)<a id="d5e1032" class="indexterm"/></p>

          <p>접속 풀링과 관련된 문장의 풀링을 제공한다.</p>
        </li><li>
          <p>파라미터 메타데이터<a id="d5e1037" class="indexterm"/></p>

          <p><span><strong class="guibutton">ParameterMetaData</strong></span> 인터페이스를 구현한 JDBC 클래스는
          준비된 문장(Prepared Statement)에서 사용한 파라미터 개수의 정보를 제공한다. 단, 데이터 타입 및
          속성(Property)에 대한 메타데이터(metadata)는 제공하지 않는다.</p>
        </li><li>
          <p>저장점</p>

          <p><span><strong class="guibutton">Savepoint </strong></span>인터페이스를 구현하여 트랜잭션에 대한 저장점 설정과
          커밋 및 롤백 기능을 제공한다. 단, 특정한 저장점을 해제하는
          <span><strong class="guibutton">Connection.releaseSavepoint</strong></span> java.sql 메소드는
          제공하지 않는다.</p>
        </li><li>
          <p>자동 생성 키</p>

          <p>SQL 문장을 실행한 후 결과 집합으로부터 <code class="function">getGeneratedKeys</code>
          함수를 사용하여 결과 로우에 대한 키 또는 사동으로 생성된 컬럼의 값을 얻는다.</p>
        </li><li>
          <p>결과 집합의 유지성(ResultSet Holdability)</p>

          <p>결과 집합이 열려있는 동안에 커밋이 발생했을 때 결과 집합을 그대로 유지할지 아니면 닫을지를 설정한다.
          <span>tbJDBC</span>에서는 결과 집합을 유지하는 방법만을 지원한다.</p>
        </li><li>
          <p>여러 개의 결과 집합 반환</p>

          <p>한 SQL 문장이 여러 개의 결과 집합을 열 수 있도록 지원한다.</p>
        </li><li>
          <p>BLOB와 CLOB 객체에 존재하는 데이터의 수정</p>

          <p>updateXXX API를 통해 BLOB와 CLOB 객체에 포함된 데이터를 수정하는 기능을
          제공한다.</p>
        </li></ul></div>

      <div class="literallayout"><p/></div>

      

      <h4><a id="d5e1061"/>지원하지 않는 기능</h4>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>추가된 데이터 타입</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">타입</th><th>설명</th></tr></thead><tbody><tr><td align="left">java.sql.Types.DATALINK</td><td>URL과 같은 외부 리소스의 접근을 제공한다.</td></tr><tr><td align="left">java.sql.Types.BOOLEAN</td><td>BIT 타입과 논리적으로 동일하다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>REF 객체에 의해 참조된 객체의 검색 및 수정</p>

          <p>REF 객체에 의해 참조된 객체를 검색하고, 수정할 수 있는 기능을 제공한다.</p>
        </li><li>
          <p>그룹 변환 및 데이터 타입의 매핑</p>

          <p>JDBC API를 통해 사용자 정의 데이터 타입(UDT: User Defined Types)과 Java 클래스
          간의 매핑 관계를 설정할 수 있다. 그러나 <span>Tibero</span>에서는
          사용자 정의 데이터 타입을 지원하지 않는다.</p>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1086"/>2.3.3. JDBC 4.0</h3></div></div></div>
      

      <p>본 절에서는 JDBC 4.0의 표준 기능을 지원 여부에 따라 각각 설명한다. JDBC 4.0 API는 Java SE
      platform, version 6 이상의 환경에서 사용할 수 있다.</p>

      <h4><a id="d5e1089"/>지원하는 기능</h4>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>인터페이스</p>

          <p>지원하는 인터페이스는 다음과 같다.</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>java.sql.NClob</p>
            </li><li>
              <p>java.sql.RowId</p>
            </li><li>
              <p>java.sql.SQLXML</p>
            </li><li>
              <p>java.sql.Wrapper</p>
            </li><li>
              <p>javax.sql.StatementEventListener</p>
            </li></ul></div>
        </li><li>
          <p>SQL : 2003에 추가된 XML 데이터 타입 지원</p>

          <p>SQLXML 인터페이스를 통해 XML 데이터 타입을 사용할 수 있다.</p>
        </li><li>
          <p>자동 java.sql.Driver 검출(Auto java.sql.Driver discovery)</p>

          <p>Class.forName을 사용한 java.sql.Driver 클래스의 로드 없이도 드라이버 객체를 사용할 수
          있다.</p>
        </li><li>
          <p>국가별 캐릭터 셋(National Character Set) 지원</p>

          <p>데이터베이스에서 별도로 지정해 사용하는 국가별 캐릭터 셋을 지원하기 위한 API가 추가되었다.</p>
        </li><li>
          <p>향상된 SQLException</p>

          <p>연쇄적으로 연결된 예외를 생성할 수 있게 되어 보다 자세한 원인을 전달해 줄 수 있으며, 새로운 종류의 예외
          타입이 추가되었다.</p>
        </li><li>
          <p>향상된 Blob/Clob 기능</p>

          <p>Blob/Clob 객체를 생성/해제할 수 있는 API를 지원한다.</p>
        </li><li>
          <p>SQL ROWID 데이터 타입의 지원</p>

          <p>RowId 인터페이스를 이용하여 SQL ROWID 타입을 사용할 수 있다.</p>
        </li><li>
          <p>실제 JDBC 객체에 대한 접근 허용</p>

          <p>Wrapper 인터페이스를 이용하여 애플리케이션 서버나 접속 풀링 환경에서도 실제 JDBC 객체에 접근해 사용할
          수 있다.</p>
        </li><li>
          <p>접속 풀링 환경에서 실제 접속 상태에 대한 통지</p>

          <p>접속 풀링 환경에서 실제 접속이 닫히거나 유효하지 않게 되었을 때 그 상태를 풀링된 문장에 통지해
          준다.</p>
        </li></ul></div>

      <div class="literallayout"><p/></div>

      <h4><a id="d5e1130"/>지원하지 않는 기능</h4>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>사용자 정의 타입 조회 및 계층 구조 검색</p>

          <p>사용자 정의 타입의 속성 및 계층 구조를 조회할 수 있는 API가 추가되었다.</p>
        </li></ul></div>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e1135"/>2.4. 기본 프로그래밍</h2></div></div></div>
    

    <p>본 절에서는 <span>tbJDBC</span>에서 제공하는 인터페이스 메소드를 통해 기본적인 Java 프로그램을
    작성하는 방법을 설명한다. 본 절에서 설명하고 있는 전체 소스 코드는 <a href="appendix_a.html" title="Appendix A. tbJDBC 예제">“Appendix A. <span>tbJDBC</span> 예제”</a>를
    참고한다.</p>

    <div class="literallayout"><p/></div>

    <p>다음은 public class가 포함된 JdbcTest 클래스 파일의 일부이다.</p>

    <div class="example"><a id="example_tbjdbc_basic"/><p class="title"><b>[예 2.1] <span>tbJDBC</span>를 사용한 기본 프로그래밍</b></p><div class="example-contents">
      

      

      <pre class="programlisting">import java.sql.CallableStatement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Types;<span><strong class="guibutton">

public class JdbcTest</strong></span>
{
    Connection conn;

    public static void main(String[] args) throws Exception
   {
        JdbcTest test = new JdbcTest();

        test.connect();                  <em class="lineannotation"><span class="lineannotation">    ... ⓐ ...</span></em>
        test.executeStatement();             <em class="lineannotation"><span class="lineannotation">... ⓑ ...</span></em>
        test.executePreparedStatement();     <em class="lineannotation"><span class="lineannotation">... ⓒ ...</span></em>
        test.executeCallableStatement();     <em class="lineannotation"><span class="lineannotation">... ⓓ ...</span></em>
        test.disconnect();                   <em class="lineannotation"><span class="lineannotation">... ⓔ ...</span></em>
    }
  
    /* ... 기능별 멤버 함수를 구현한다. */
}</pre>
    </div></div><br class="example-break"/>

    <p>ⓐ JdbcTest라는 클래스를 통해 데이터베이스에 접속한다.</p>

    <p>ⓑ ~ ⓓ 여러 종류의 멤버 함수를 수행한다.</p>

    <p>ⓔ 데이터베이스 접속을 해제하는 작업을 수행한다.</p>

    <p>다음 절부터는 위 예에서 ⓐ ~ ⓔ 사이에 구현된 멤버 함수를 각각 설명한다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1156"/>2.4.1. 접속</h3></div></div></div>
      

      <p><span><strong class="guibutton">connect 멤버 함수</strong></span>는 기본 드라이버 관리자를 이용하여 데이터베이스에
      <span><strong class="guibutton">접속(connection)</strong></span>하는 동작(ⓐ)을 수행한다. Java에서 기본 제공하는
      <span><strong class="guibutton">java.sql.DriverManager</strong></span> 클래스를 통해 드라이버 관리자 기능을 사용할 수
      있다.<a id="d5e1162" class="indexterm"/><a id="d5e1164" class="indexterm"/><a id="d5e1166" class="indexterm"/></p>

      <div class="example"><a id="example_tbjdbc_connect"/><p class="title"><b>[예 2.2] <span>tbJDBC</span> - 접속</b></p><div class="example-contents">
        

        

        <pre class="programlisting">private void <span><strong class="guibutton">connect()</strong></span> throws ClassNotFoundException
{
    Class.forName("com.<span>tmax.tibero</span>.jdbc.<span>Tb</span>Driver");

    try {
        <span><strong class="guibutton">conn = DriverManager.getConnection(
                "jdbc:<span>tibero</span>:thin:@localhost:8629:<span>tibero</span>", 
                "<span>tibero</span>", "<span>tmax</span>");</strong></span>
    } catch (SQLException e) {
        System.out.println("connection failure!");
        System.exit(-1);
    }
    System.out.println("Connection success!");
}</pre>
      </div></div><br class="example-break"/>

      <p>구현된 내용을 차례대로 설명하면 다음과 같다.</p>

      <div class="orderedlist"><ol type="1" compact="compact"><li>
          <p>사용할 드라이버에 해당하는 클래스를 지정하여 Class.forName 메소드를 호출한다.</p>

          <p>아래에서 드라이버 관리자를 사용하기 전에 사용할 드라이버를 미리 등록하는 과정이다. 사용할 드라이버에 해당하는
          클래스의 이름을 지정하여, Java 가상머신이 드라이버 클래스를 로드하도록 한다.</p>
        </li><li>
          <p>DriverManager.getConnection 메소드를 호출하여 드라이버 관리자를 통해 데이터베이스 연결을
          생성한다. 사용자는 DriverManager.getConnection 메소드의 파라미터로 접속할 데이터베이스의 URL과
          DB 사용자이름 및 비밀번호를 입력한다. DriverManager 클래스는 URL에 맞는 드라이버를 찾아 접속에 성공할
          경우 데이터베이스 연결을 java.sql.Connection 인터페이스의 객체로 돌려준다. 이를 필드 변수 conn에
          할당한다.</p>
        </li><li>
          <p>드라이버 관리자가 URL에 적합한 드라이버를 찾지 못하거나, 드라이버에서 데이터베이스로의 접속에 실패한 경우에는
          SQLException이 throw된다.</p>
        </li></ol></div>

      <p/>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1190"/>2.4.2. 실행</h3></div></div></div>
      

      <p><span>tbJDBC</span>에서는 다른 데이터베이스의 클라이언트에서처럼
      <span><strong class="guibutton">문장(statement)</strong></span>에 대한 개념이 존재한다.
      <span><strong class="guibutton">executeStatement 멤버 함수</strong></span>는 이러한 문장을 실행(execution)하는
      기능(ⓑ)을 수행한다.<a id="d5e1196" class="indexterm"/><a id="d5e1198" class="indexterm"/></p>

      <div class="example"><a id="example_tbjdbc_execution"/><p class="title"><b>[예 2.3] <span>tbJDBC</span> - 실행</b></p><div class="example-contents">
        

        

        <pre class="programlisting">private void <span><strong class="guibutton">executeStatement()</strong></span> throws SQLException
{
    String dropTable   = "drop table emp";
    String createTable = "create table emp (id number, "+
                         " name varchar(20), salary number)";
    String InsertTable = "insert into emp values(1000, 'Park', 5000)";

    Statement stmt = conn.createStatement();

    try {
        stmt.executeUpdate(dropTable);
    } catch(SQLException e) {
        // if there is not the table
    }

    stmt.executeUpdate(createTable);    
    stmt.executeUpdate(InsertTable);

    stmt.close();
}</pre>
      </div></div><br class="example-break"/>

      <p>구현된 내용을 차례대로 설명하면 다음과 같다.</p>

      <div class="orderedlist"><ol type="1" compact="compact"><li>
          <p>dropTable, createTable, InsertTable를 각각 String 객체 참조형 변수로 만든다.
          객체 참조형 변수에 각각 특정 명령을 실행할 SQL 문장을 만든다.</p>
        </li><li>
          <p>연결에서 <code class="function">createStatement</code> 메소드를 호출하여 새로운 문장을
          생성한다.<a id="d5e1212" class="indexterm"/> java.sql.Statement 객체로 반환되며, 이를 이용해 SQL 문장을 실행할 수
          있다.</p>
        </li><li>
          <p><code class="function">executeUpdate(str)</code> 메소드를 이용하여 지정한 SQL 문장을
          실행한다.<a id="d5e1217" class="indexterm"/></p>
        </li></ol></div>

      <div class="literallayout"><p/></div>

      <p>또한 <span><strong class="guibutton">준비된 문장(prepared statement)</strong></span>을 이용하면 파라미터를
      바인딩하여 원하는 작업을 수행할 수 있다. <span><strong class="guibutton">executePreparedStatement 멤버
      함수</strong></span>는 파라미터가 바인딩이 된 질의를 실행하는 기능(ⓒ)을 수행한다.<a id="d5e1223" class="indexterm"/><a id="d5e1225" class="indexterm"/></p>

      <div class="example"><a id="example_tbjdbc_prepared"/><p class="title"><b>[예 2.4] <span>tbJDBC</span> - 준비된 문장의 선언과 파라미터 바인딩</b></p><div class="example-contents">
        

        

        <pre class="programlisting">private void <span><strong class="guibutton">executePreparedStatement()</strong></span> throws SQLException
{
    PreparedStatement pstmt = 
         conn.prepareStatement("select name from emp where id = ?");    <em class="lineannotation"><span class="lineannotation">... ① ...</span></em>

    pstmt.setString(1, "1000");

    ResultSet rs = pstmt.executeQuery();

    while (rs.next()) {
        System.out.println(rs.getString(1));
    }

    pstmt.close();
}</pre>
      </div></div><br class="example-break"/>

      <p>구현된 내용을 차례대로 설명하면 다음과 같다.</p>

      <div class="orderedlist"><ol type="1" compact="compact"><li>
          <p>연결에 prepareStatement 메소드를 호출하여 준비된 문장을 생성한다.</p>

          <p>java.sql.PreparedStatement 인터페이스 객체로 반환되며, execute(),
          executeUpdate(), executeQuery() 메소드를 호출하여 실행할 수 있다.<a id="d5e1238" class="indexterm"/></p>
        </li><li>
          <p><code class="function">setString(bind_no, bind_value)</code> 메소드를 이용하여
          바인딩할 파라미터의 순서를 정하여 값을 설정한다.<span><strong class="guibutton"> pstmt.setString(1,
          "1000")</strong></span>은 준비된 문장의 첫 번째 파라미터(①)에 대응되는
          <span><strong class="guibutton">"1000"</strong></span>이라는 문자열을 바인딩한다.</p>
        </li><li>
          <p>파라미터의 바인딩이 완료된 후 <code class="function">executeQuery</code> 메소드를 실행하면
          결과 집합(ResultSet)를 얻게 된다.<a id="d5e1248" class="indexterm"/> 결과 집합은 개념적으로 <span>tbCLI</span>나 <span>tbESQL</span>의 커서와 동일하다. 결과 집합에
          <code class="function">getString(column_no)</code> 메소드를 사용하면 실행 결과를 문자열로 확인할
          수 있다.<a id="d5e1253" class="indexterm"/></p>
        </li></ol></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1255"/>2.4.3. 호출</h3></div></div></div>
      

      <p><span>tbJDBC</span>를 이용하여 작성한 프로그램에서 PL/SQL를 호출(call)할 수
      있다. 이러한 문장을 <span><strong class="guibutton">호출 가능 문장</strong></span>(callable statement)이라고 한다.
      <span><strong class="guibutton">executeCallableStatement 멤버 함수</strong></span>는 호출 가능 문장을 실행하는
      기능(ⓓ)을 수행한다.<a id="d5e1261" class="indexterm"/><a id="d5e1263" class="indexterm"/></p>

      <div class="example"><a id="example_tbjdbc_call"/><p class="title"><b>[예 2.5] <span>tbJDBC</span> - 호출</b></p><div class="example-contents">
        

        

        <pre class="programlisting">private void <span><strong class="guibutton">executeCallableStatement()</strong></span> throws SQLException
{
    String callSQL = 
        " CREATE PROCEDURE testProc "+
        " (ID_VAL IN NUMBER, SAL_VAL IN OUT NUMBER) as " + 
        " BEGIN" +
        "   update emp" +
        "      set salary = SAL_VAL" +
        "    where id = ID_VAL;" + 
        "   select salary into SAL_VAL" +
        "     from emp" +
        "    where id = ID_VAl;" +
        " END;";
    String dropProc = "DROP PROCEDURE testProc";

    Statement stmt = conn.createStatement();

    try {
        stmt.executeUpdate(dropProc);
    } catch(SQLException e) {
        // if there is not the procedure
    }
        
    stmt.executeUpdate(callSQL);

    CallableStatement cstmt = conn.prepareCall("{call testProc(?, ?)}");
    cstmt.setInt(1, 1000);
    cstmt.setInt(2, 7000);
    cstmt.registerOutParameter(2, Types.INTEGER);
    cstmt.executeUpdate();

    int salary = cstmt.getInt(2);
    System.out.println(salary);

    stmt.close();
    cstmt.close();
}</pre>
      </div></div><br class="example-break"/>

      <p>구현된 내용을 차례대로 설명하면 다음과 같다.</p>

      <div class="orderedlist"><ol type="1" compact="compact"><li>
          <p>사용할 프러시저를 생성한다. <span><strong class="guibutton">java.sql.Statement</strong></span> 객체를
          이용하여 프러시저 생성 SQL 문장을 실행한다.</p>
        </li><li>
          <p>연결에 <code class="function">prepareCall(str)</code> 메소드를 호출하여 호출 가능 문장을
          생성한다.<a id="d5e1278" class="indexterm"/> 생성된 호출 가능 문장은
          <span><strong class="guibutton">java.sql.CallableStatement</strong></span> 인터페이스 객체로
          반환된다.</p>
        </li><li>
          <p>입력 파라미터와 출력 파라미터를 바인딩한다.</p>

          <p>입력 파라미터를 바인딩하는 방법은 <code class="function">setInt(bind_no,
          bind_value)</code> 같은 바인딩 메소드(binding method)를 사용하며, 준비된 문장에서와
          동일하게 사용할 수 있다.</p>

          <p>출력 파라미터에 대해서는 <code class="function">registerOutParameter(bind_no,
          type)</code> 메소드를 이용하여 등록한다.<a id="d5e1287" class="indexterm"/> 예제에서 등록할 출력 파라미터는 1번에서 생성된 프러시저의 두 번째
          파라미터(<span><strong class="guibutton">SAL_VAL IN OUT NUMBER</strong></span>)이다. 이 파라미터는 입출력용으로
          선언되었으므로 출력 파라미터로 등록할 수 있다.</p>
        </li><li>
          <p><code class="function">executeUpdate</code> 메소드를 호출하여 문장을 실행한 후 출력
          파라미터의 타입에 맞는 메소드로 실행 결과를 확인한다. 프러시저의 출력 파라미터는 integer 타입이므로,
          CallableStatement 클래스의
          <code class="function">getInt(bind_no)</code><a id="d5e1294" class="indexterm"/> 메소드를 이용하여 결과 값을 가져온다.<a id="d5e1296" class="indexterm"/></p>
        </li></ol></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1298"/>2.4.4. 커밋과 롤백</h3></div></div></div>
      

      <p>트랜잭션은 하나 이상의 SQL 문장으로 이루어져 있다. SQL 문장이 실행되면서 전체가 커밋(Commit)되든지
      롤백(Rollback)된다.<a id="d5e1301" class="indexterm"/><a id="d5e1303" class="indexterm"/><span> tbJDBC</span>는 Connection 객체에서 트랜잭션을 설정할 수 있다. 초기에는
      <span><strong class="guibutton">auto-commit</strong></span>으로 설정되어 있다.</p>

      <p>트랜잭션의 처리 모드를 변경하려면 다음과 같이 소스 코드를 추가해야 한다.</p>

      <pre class="programlisting">conn.setAutoCommit(false);
conn.rollback();
conn.commit();
conn.setTransactionIsolation(Connection.TRANSACTION_READ_UNCOMMITED)</pre>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1309"/>2.4.5. 접속 해제</h3></div></div></div>
      

      <p><span><strong class="guibutton">disconnect 멤버 함수</strong></span>는 데이터베이스 접속을 해제하는 기능(ⓔ)을
      수행한다.<a id="d5e1313" class="indexterm"/></p>

      <div class="example"><a id="example_tbjdbc_disconnect"/><p class="title"><b>[예 2.6] <span>tbJDBC</span> - 접속 해제</b></p><div class="example-contents">
        

        

        <pre class="programlisting">private void <span><strong class="guibutton">disconnect()</strong></span> throws SQLException
{
    if (conn != null)    
        conn.close();
}</pre>
      </div></div><br class="example-break"/>

      <p>conn 객체가 존재하는 경우 close 멤버 함수를 사용하여 데이터베이스 접속을 해제할 수 있다.<a id="d5e1321" class="indexterm"/></p>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch03.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제1장 데이터 타입의 사용 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제3장 트리거의 사용</td></tr></table></div><div xmlns="" align="center"/></body></html>