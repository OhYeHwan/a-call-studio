<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제6장 유틸리티 API</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero 유틸리티 안내서"/><link rel="up" href="index.html" title="Tibero 유틸리티 안내서"/><link rel="prev" href="chapter_tbdv.html" title="제5장 tbdv"/><link rel="next" href="idx.html" title="색인"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제6장 유틸리티 API</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chapter_tbdv.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="idx.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="chapter_tbcli_function"/>제6장 유틸리티 API</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="chapter_tbcli_function.html#d5e8151">6.1. 헤더 파일</a></span></dt><dt><span class="section"><a href="chapter_tbcli_function.html#d5e8209">6.2. 구조체</a></span></dt><dt><span class="section"><a href="chapter_tbcli_function.html#d5e8628">6.3. 유틸리티 API 목록</a></span></dt><dd><dl><dt><span class="section"><a href="chapter_tbcli_function.html#sect_tbconnect">6.3.1. <span>TBConnect</span></a></span></dt><dt><span class="section"><a href="chapter_tbcli_function.html#sect_tbdisconnect">6.3.2. <span>TBDisconnect</span></a></span></dt><dt><span class="section"><a href="chapter_tbcli_function.html#sect_tbexport">6.3.3. <span>TBExport</span></a></span></dt><dt><span class="section"><a href="chapter_tbcli_function.html#sect_tbimport">6.3.4. <span>TBImport</span></a></span></dt></dl></dd></dl></div>
  

  <p><span>Tibero</span>에서는 유틸리티와 관련된 C와 C++ 함수를 제공하고 있다.
  애플리케이션 프로그램 개발자는 유틸리티 API를 사용하여 기존에 명령 프롬프트에서 수행하던 유틸리티를 애플리케이션 프로그램에서 호출할 수
  있다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e8151"/>6.1. 헤더 파일</h2></div></div></div>
    

    <p>다음은 유틸리티 API가 사용하는 헤더 파일이다.</p>

    <div class="informaltable">
      <table border="1"><colgroup><col width="120" align="left"/><col/></colgroup><thead><tr><th align="left">헤더 파일명</th><th>설명</th></tr></thead><tbody><tr><td align="left"><span>tbutil.h</span></td><td><p>유틸리티 API를 선언하고 이와 관련된 구조체를 정의한다.</p><p>정의할 구조체는
            다음과 같다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                  <p>struct sqlstr</p>
                </li><li style="list-style-type: circle">
                  <p>struct <span><span>TBExpImp</span></span>Meta</p>
                </li><li style="list-style-type: circle">
                  <p>struct <span>TBExport</span>In</p>
                </li><li style="list-style-type: circle">
                  <p>struct <span>TBExport</span>Out</p>
                </li><li style="list-style-type: circle">
                  <p>struct <span>TBExport</span>Struct</p>
                </li><li style="list-style-type: circle">
                  <p>struct <span>TBImport</span>In</p>
                </li><li style="list-style-type: circle">
                  <p>struct <span>TBImport</span>Out</p>
                </li><li style="list-style-type: circle">
                  <p>struct <span>TBImport</span>Struct</p>
                </li></ul></div></td></tr><tr><td align="left">sqlca.h<a id="d5e8195" class="indexterm"/></td><td><p>유틸리티 내부에서 발생한 에러 정보를 애플리케이션 프로그램에 전달하는 구조체를
            선언한다.</p><p>선언할 구조체는 다음과 같다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                  <p>struct sqlca</p>
                </li></ul></div></td></tr><tr><td align="left">sqlcli.h<a id="d5e8205" class="indexterm"/></td><td>ODBC 표준인 헤더 파일이며, 표준 API와 매크로를 정의한다.</td></tr></tbody></table>
    </div>

    <p/>

    
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e8209"/>6.2. 구조체</h2></div></div></div>
    

    <p>다음은 유틸리티 API에서 정의할 수 있는 구조체이다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>sqlstr 구조체<a id="d5e8215" class="indexterm"/></p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="110" align="left"/><col width="60" align="left"/><col width="110" align="left"/><col/></colgroup><thead><tr><th align="left">필드</th><th align="left">용도</th><th align="left">타입</th><th>설명</th></tr></thead><tbody><tr><td align="left">length</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td>문자열의 길이를 명시한다.</td></tr><tr><td align="left">data</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td>문자열이 저장된 포인터를 명시한다.</td></tr></tbody></table>
        </div>
      </li><li>
        <p><span>TBExpImp</span>Meta 구조체<a id="d5e8242" class="indexterm"/></p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="110" align="left"/><col width="60" align="left"/><col width="110" align="left"/><col/></colgroup><thead><tr><th align="left">필드</th><th align="left">용도</th><th align="left">타입</th><th>설명</th></tr></thead><tbody><tr><td align="left">fieldTerm</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td>컬럼(필드)의 구분자로, 사용할 문자열을 명시한다.</td></tr><tr><td align="left">fieldTermLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td>컬럼(필드)의 구분자로, 사용할 문자열의 길이를 명시한다.</td></tr><tr><td align="left">lineTerm</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td>레코드의 구분자로, 사용할 문자열을 명시한다.</td></tr><tr><td align="left">lineTermLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td>레코드의 구분자로, 사용할 문자열의 길이를 명시한다.</td></tr><tr><td align="left">enclStart</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td><p>컬럼의 데이터를 감쌀 시작 문자열을 명시한다.</p><p>시작 문자열을
                큰따옴표(" ")로 명시하면, 컬럼의 데이터 맨 앞에 큰따옴표가 붙게 된다.</p></td></tr><tr><td align="left">enclStartLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td>컬럼의 데이터를 감쌀 시작 문자열의 길이를 명시한다.</td></tr><tr><td align="left">enclEnd</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td><p>컬럼의 데이터를 감쌀 종료 문자열을 명시한다.</p><p>종료 문자열을
                큰따옴표(" ")로 명시하면, 컬럼의 데이터 맨 뒤에 큰따옴표가 붙게 된다.</p></td></tr><tr><td align="left">enclEndLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td>컬럼의 데이터를 감쌀 종료 문자열의 길이를 명시한다.</td></tr><tr><td align="left">escape</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td>컬럼의 데이터를 해석할 때 필요한 ESCAPE 문자열을 명시한다. 단, <span>TBImport</span> 구조체에서만 사용한다.</td></tr><tr><td align="left">escapeLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td>컬럼의 데이터를 해석할 때 필요한 ESCAPE 문자열의 길이를 명시한다. 단, <span>TBImport</span> 구조체에서만 사용한다.</td></tr></tbody></table>
        </div>
      </li><li>
        <p><span>TBExport</span>In 구조체<a id="d5e8316" class="indexterm"/></p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="110" align="left"/><col width="60" align="left"/><col width="110" align="left"/><col/></colgroup><thead><tr><th align="left">필드</th><th align="left">용도</th><th align="left">타입</th><th>설명</th></tr></thead><tbody><tr><td align="left">iMeta</td><td align="left">입력</td><td align="left"><span>TBExpImp</span>Meta *</td><td><p><span>TBExpImp</span>Meta 구조체의
                포인터이다.</p><p>데이터를 추출할 때 필요한 입력 메타데이터를
                명시한다.</p></td></tr></tbody></table>
        </div>
      </li><li>
        <p><span>TBExport</span>Out 구조체<a id="d5e8343" class="indexterm"/></p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="110" align="left"/><col width="60" align="left"/><col width="110" align="left"/><col/></colgroup><thead><tr><th align="left">필드</th><th align="left">용도</th><th align="left">타입</th><th>설명</th></tr></thead><tbody><tr><td align="left">oRowsExported</td><td align="left">출력</td><td align="left">SQLINTEGER</td><td>데이터 파일에 추출된 레코드의 개수가 기록된다.</td></tr></tbody></table>
        </div>
      </li><li>
        <p><span>TBExport</span>Struct 구조체<a id="d5e8366" class="indexterm"/></p>

        <div class="informaltable"><a id="tbl_TBExportStruct"/>
          <table border="1"><colgroup><col width="110" align="left"/><col width="60" align="left"/><col width="110" align="left"/><col/></colgroup><thead><tr><th align="left">필드</th><th align="left">용도</th><th align="left">타입</th><th>설명</th></tr></thead><tbody><tr><td align="left">piDataFileName</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td>추출된 데이터가 저장될 파일의 경로명을 명시한다.</td></tr><tr><td align="left">iDataFileNameLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td><p>데이터 파일명의 길이를 명시한다.</p><p>파일명이 NULL 문자로 종료된
                경우 SQL_NTS를 명시한다.</p></td></tr><tr><td align="left">piActionString</td><td align="left">입력</td><td align="left">sqlstr *</td><td>SELECT 문을 이용하여 대상 테이블 또는 뷰의 데이터를 지정한다. SELECT 문에 명시한
                컬럼의 순서대로 추출된 데이터가 저장된다.</td></tr><tr><td align="left">iFileType</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td>현재는 컬럼 구분자를 사용하는 형태인 SQL_DEL만 사용할 수 있다.</td></tr><tr><td align="left">piMsgFileName</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td>데이터를 추출할 때 발생하는 에러와 경고 그리고 유용한 정보를 기록하는 메시지 파일명을
                명시한다.</td></tr><tr><td align="left">iMsgFileNameLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td><p>메시지 파일명의 길이를 명시한다.</p><p>파일명이 NULL 문자로 종료된
                경우 SQL_NTS를 명시한다.</p></td></tr><tr><td align="left">piExportInfoIn</td><td align="left">입력</td><td align="left"><span>TBExport</span>In *</td><td><p><span>TBExport</span>In 구조체의
                포인터이다.</p><p>데이터를 추출할 때 필요한 입력 메타데이터를
                명시한다.</p></td></tr><tr><td align="left">piExportInfoOut</td><td align="left">입력</td><td align="left"><span>TBExport</span>Out *</td><td><p><span>TBExport</span>Out 구조체의
                포인터이다.</p><p>데이터를 추출한 후에 발생한 결과정보를 저장한다.</p></td></tr></tbody></table>
        </div>
      </li><li>
        <p><span>TBImport</span>In 구조체<a id="d5e8436" class="indexterm"/></p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="110" align="left"/><col width="60" align="left"/><col width="110" align="left"/><col/></colgroup><thead><tr><th align="left">필드</th><th align="left">용도</th><th align="left">타입</th><th>설명</th></tr></thead><tbody><tr><td align="left">iMeta</td><td align="left">입력</td><td align="left"><span>TBExpImp</span>Meta *</td><td><p><span>TBExpImp</span>Meta 구조체의
                포인터이다.</p><p>데이터를 로드할 때 필요한 입력 메타데이터를
                명시한다.</p></td></tr><tr><td align="left">iRowCount</td><td align="left">입력</td><td align="left">SQLINTEGER</td><td><p>로드할 레코드의 개수를 명시한다.</p><p>사용자가 값을 0으로 지정한 경우
                데이터 파일의 모든 레코드를 로드한다.</p></td></tr><tr><td align="left">iSkipCount</td><td align="left">입력</td><td align="left">SQLINTEGER</td><td>데이터 파일에서 로드할 대상을 제외하기 위해 건너뛸 레코드의 개수를 명시한다.</td></tr><tr><td align="left">iCommitCount</td><td align="left">입력</td><td align="left">SQLINTEGER</td><td>데이터를 로드 중에 한 번씩 커밋하려고 할 때 그 개수를 명시한다. 단, 성능적인 이슈로 사용자가
                명시한 개수 단위로 커밋이 일어나지는 않는다.</td></tr><tr><td align="left">iErrorCount</td><td align="left">입력</td><td align="left">SQLINTEGER</td><td>사용자가 허용하는 에러 레코드의 개수이다. 데이터를 로드 중에 에러 레코드 개수가 허용치보다
                많으면, 로드를 중단한다.</td></tr></tbody></table>
        </div>
      </li><li>
        <p><span>TBImport</span>Out 구조체<a id="d5e8485" class="indexterm"/></p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="110" align="left"/><col width="60" align="left"/><col width="110" align="left"/><col/></colgroup><thead><tr><th align="left">필드</th><th align="left">용도</th><th align="left">타입</th><th>설명</th></tr></thead><tbody><tr><td align="left">oRowsRead</td><td align="left">출력</td><td align="left">SQLINTEGER</td><td>데이터 파일에서 읽은 레코드의 개수를 기록한다.</td></tr><tr><td align="left">oRowsSkipped</td><td align="left">출력</td><td align="left">SQLINTEGER</td><td>데이터 파일에서 건너뛴 레코드의 개수를 기록한다.</td></tr><tr><td align="left">oRowsInserted</td><td align="left">출력</td><td align="left">SQLINTEGER</td><td>해당 테이블 또는 뷰에 입력(INSERT 연산)된 레코드의 개수를 기록한다.</td></tr><tr><td align="left">oRowsUpdated</td><td align="left">출력</td><td align="left">SQLINTEGER</td><td>해당 테이블 또는 뷰에 수정(UPDATE 연산)된 레코드의 개수를 기록한다.</td></tr><tr><td align="left">oRowsRejected</td><td align="left">출력</td><td align="left">SQLINTEGER</td><td>데이터 로드에 실패한 레코드의 개수를 기록한다.</td></tr><tr><td align="left">oRowsCommitted</td><td align="left">출력</td><td align="left">SQLINTEGER</td><td>커밋에 성공한 레코드의 개수를 기록한다.</td></tr></tbody></table>
        </div>
      </li><li>
        <p><span>TBImport</span>Struct 구조체<a id="d5e8533" class="indexterm"/></p>

        <div class="informaltable"><a id="tbl_TBImportStruct"/>
          <table border="1"><colgroup><col width="110" align="left"/><col width="60" align="left"/><col width="110" align="left"/><col/></colgroup><thead><tr><th align="left">필드</th><th align="left">용도</th><th align="left">타입</th><th>설명</th></tr></thead><tbody><tr><td align="left">piDataFileName</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td>로드할 데이터 파일의 경로명을 명시한다.</td></tr><tr><td align="left">iDataFileNameLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td><p>데이터 파일명의 길이를 명시한다.</p><p>파일명이 NULL 문자로 종료된
                경우 SQL_NTS를 명시한다.</p></td></tr><tr><td align="left">piActionString</td><td align="left">입력</td><td align="left">sqlstr *</td><td><p>로드할 대상 테이블과 컬럼을 명시하고, 상세한 메타데이터를 명시한
                문자열이다.</p><p><span>tbLoader</span> 유틸리티의 컨트롤 파일에서 사용하는 문자열과
                동일한 문법이다. 이 문법에 대한 내용은 <span>tbLoader</span> 유틸리티의 컨트롤 파일의 형식을
                참고한다.</p></td></tr><tr><td align="left">iFileType</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td>현재는 컬럼 구분자를 사용하는 형태인 SQL_DEL만 사용할 수 있다.</td></tr><tr><td align="left">piMsgFileName</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td>데이터를 로드할 때 발생하는 에러와 경고 그리고 유용한 정보를 기록하는 메시지 파일명을
                명시한다.</td></tr><tr><td align="left">iMsgFileNameLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td><p>메시지 파일명의 길이를 명시한다.</p><p>파일명이 NULL 문자로 종료된
                경우 SQL_NTS를 명시한다.</p></td></tr><tr><td align="left">piBadFileName</td><td align="left">입력</td><td align="left">SQLCHAR *</td><td>데이터를 로드할 때 에러가 발생한 데이터를 모아서 기록하는 오류 데이터 파일이다.</td></tr><tr><td align="left">iBadFileNameLen</td><td align="left">입력</td><td align="left">SQLSMALLINT</td><td><p>오류 데이터 파일명의 길이를 명시한다.</p><p>파일명이 NULL 문자로
                종료된 경우 SQL_NTS를 명시한다.</p></td></tr><tr><td align="left">iDPL</td><td align="left">입력</td><td align="left">BOOL</td><td>데이터를 로드할 때 Direct Path Load 방식의 사용 여부를 지정한다.</td></tr><tr><td align="left">iTrailNullCols</td><td align="left">입력</td><td align="left">BOOL</td><td>데이터 파일의 레코드에 없는 마지막 컬럼의 데이터를 NULL 로 취급 여부를
                지정한다.</td></tr><tr><td align="left">piImportInfoIn</td><td align="left">입력</td><td align="left"><span>TBImport</span>In *</td><td><p><span>TBImport</span>In 구조체의
                포인터이다.</p><p>데이터를 로드할 때 필요한 입력 메타데이터를
                지정한다.</p></td></tr><tr><td align="left">poImportInfoOut</td><td align="left">입력</td><td align="left"><span>TBImport</span>Out *</td><td><p><span>TBImport</span>Out 구조체의 포인터이다.
                </p><p>데이터를 로드한 후에 발생한 결과정보를 로드한다.</p></td></tr></tbody></table>
        </div>
      </li></ul></div>

    <p/>

    <p/>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e8628"/>6.3. 유틸리티 API 목록</h2></div></div></div>
    

    <p>다음은 유틸리티 API 목록이다.</p>

    <div class="informaltable">
      <table border="1"><colgroup><col width="140" align="left"/><col width="110" align="left"/><col/></colgroup><thead><tr><th align="left">함수 타입</th><th align="left">함수</th><th>헤더 파일</th></tr></thead><tbody><tr><td align="left">데이터베이스 연결</td><td align="left"><a href="chapter_tbcli_function.html#sect_tbconnect" title="6.3.1. TBConnect"><span>TBConnect</span></a></td><td><span>tbutil.h</span></td></tr><tr><td align="left">데이터베이스 연결해제</td><td align="left"><a href="chapter_tbcli_function.html#sect_tbdisconnect" title="6.3.2. TBDisconnect"><span>TBDisconnect</span></a></td><td><span>tbutil.h</span></td></tr><tr><td align="left">데이터 추출</td><td align="left"><a href="chapter_tbcli_function.html#sect_tbexport" title="6.3.3. TBExport"><span>TBExport</span></a></td><td><span>tbutil.h</span></td></tr><tr><td align="left">데이터 로드</td><td align="left"><a href="chapter_tbcli_function.html#sect_tbimport" title="6.3.4. TBImport"><span>TBImport</span></a></td><td><span>tbutil.h</span></td></tr></tbody></table>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_tbconnect"/>6.3.1. <span>TBConnect</span></h3></div></div></div>
      

      <p>데이터베이스 연결정보(SID, 사용자명, 패스워드)를 이용하여 <span>Tibero</span> 서버에 연결하는 함수이다.</p>

      <p><code class="function"><span>TBConnect</span></code> 함수의 세부 내용은 다음과
      같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
            <p>문법</p>

            <pre class="programlisting">SQLRETURN SQL_API
<span>TBConnect</span>(SQLCHAR *dnsname, SQLCHAR *username, SQLCHAR *pwd, 
          struct sqlca *pSqlca);</pre>
          </li><li>
            <p>파라미터</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="110" align="left"/><col width="70" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th align="left">용도</th><th>설명</th></tr></thead><tbody><tr><td align="left">dnsname</td><td align="left">입력</td><td><span>tbdsn</span>.tbr(또는 <span>tb</span>net_alias.tbr) 파일에 정의된
                    SID이다.</td></tr><tr><td align="left">username</td><td align="left">입력</td><td>사용자명을 지정한다.</td></tr><tr><td align="left">pwd</td><td align="left">입력</td><td>패스워드를 지정한다.</td></tr><tr><td align="left">pSqlca</td><td align="left">출력</td><td>반환 코드가 SQL_SUCCESS가 아닌 경우 유틸리티 내부에서 발생한 에러 정보를
                    포함한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>반환 코드</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">반환 코드</th><th>설명</th></tr></thead><tbody><tr><td align="left">SQL_SUCCESS</td><td>함수가 성공적으로 완료된 상태</td></tr><tr><td align="left">SQL_SUCCESS_WITH_INFO</td><td>함수가 성공적으로 완료되었으나, 경고 메시지가 있는 상태</td></tr><tr><td align="left">SQL_ERROR</td><td>치명적인 에러가 발생한 상태</td></tr></tbody></table>
            </div>
          </li><li>
            <p>관련 함수</p>

            <p><a href="chapter_tbcli_function.html#sect_tbdisconnect" title="6.3.2. TBDisconnect"><span>TBDisconnect</span></a></p>
          </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_tbdisconnect"/>6.3.2. <span>TBDisconnect</span></h3></div></div></div>
      

      <p>데이터베이스 연결정보(SID)에 해당하는 <span>Tibero</span> 서버와의 연결을 해제하는 함수이다.</p>

      <p><code class="function"><span>TBDisconnect</span></code> 함수의 세부 내용은 다음과
      같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
            <p>문법</p>

            <pre class="programlisting">SQLRETURN SQL_API
<span>TBDisconnect</span>(SQLCHAR *dnsname, struct sqlca *pSqlca);</pre>
          </li><li>
            <p>파라미터</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="110" align="left"/><col width="70" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th align="left">용도</th><th>설명</th></tr></thead><tbody><tr><td align="left">dnsname</td><td align="left">입력</td><td><span>tbdsn</span>.tbr(또는 <span>tb</span>net_alias.tbr)파일에 정의된
                    SID이다.</td></tr><tr><td align="left">pSqlca</td><td align="left">출력</td><td>반환 코드가 SQL_SUCCESS가 아닌 경우 유틸리티 내부에서 발생한 에러 정보를
                    포함한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>반환 코드</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">반환 코드</th><th>설명</th></tr></thead><tbody><tr><td align="left">SQL_SUCCESS</td><td>함수가 성공적으로 완료된 상태</td></tr><tr><td align="left">SQL_SUCCESS_WITH_INFO</td><td>함수가 성공적으로 완료되었으나, 경고 메시지가 있는 상태</td></tr><tr><td align="left">SQL_ERROR</td><td>치명적인 에러가 발생한 상태</td></tr></tbody></table>
            </div>
          </li><li>
            <p>관련 함수</p>

            <p><a href="chapter_tbcli_function.html#sect_tbconnect" title="6.3.1. TBConnect"><span>TBConnect</span></a></p>
          </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_tbexport"/>6.3.3. <span>TBExport</span></h3></div></div></div>
      

      <p>데이터베이스에 존재하는 데이터를 외부 파일로 추출하는 함수이다. 외부 파일은 추출된 데이터를 텍스트 형태로 표시하며,
      컬럼 구분자와 레코드 구분자를 이용하여 컬럼과 레코드를 추출한다. 이렇게 추출된 외부 파일은 <span>tbLoader</span> 유틸리티의 데이터 파일 형태를 취한다. 사용자는 SELECT 문을
      이용하여 추출할 데이터를 선정할 수 있다. 단, 대상 테이블 또는 뷰의 SELECT 권한이 있어야 한다.</p>

      <p><code class="function"><span>TBExport</span></code> 함수의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <pre class="programlisting">SQLRETURN SQL_API
<span>TBExport</span>(SQLINTEGER versionNumber, <span>TBExport</span>Struct *pParamStruct,
         struct sqlca *pSqlca);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="110" align="left"/><col width="70" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th align="left">용도</th><th>설명</th></tr></thead><tbody><tr><td align="left">versionNumber</td><td align="left">입력</td><td>유틸리티 라이브러리의 버전번호이다. 이 파라미터는 유틸리티 라이브러리가 변경될 것에 대비하여
                  하위 버전과의 호환성을 위해 존재한다. 현재 버전번호는 1이다.</td></tr><tr><td align="left">pParamStruct</td><td align="left">입출력</td><td>이 파라미터를 사용하여 추출할 대상 정보를 명시하고, 추출 후에는 결과정보를 받는다. 자세한
                  내용은 <a href="chapter_tbcli_function.html#tbl_TBExportStruct"><span>"TBExport</span>Struct 구조체"</a>를
                  참고한다.</td></tr><tr><td align="left">pSqlca</td><td align="left">출력</td><td>반환 코드가 SQL_SUCCESS가 아닌 경우 유틸리티 내부에서 발생한 에러 정보를
                  포함한다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>반환 코드</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">반환 코드</th><th>설명</th></tr></thead><tbody><tr><td align="left">SQL_SUCCESS</td><td>함수가 성공적으로 완료된 상태</td></tr><tr><td align="left">SQL_SUCCESS_WITH_INFO</td><td>함수가 성공적으로 완료되었으나, 경고 메시지가 있는 상태</td></tr><tr><td align="left">SQL_ERROR</td><td>치명적인 에러가 발생한 상태</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <pre class="programlisting">#include "<span>tbutil.h</span>"

#define DNS_NAME  "DEFAULT"
#define USER_NAME "SYS"
#define PWD       "<span>tibero</span>"

int main(int argc, char *argv[]) {
    SQLRETURN      rc = SQL_SUCCESS;
    SQLINTEGER     versionNumber = 1;
    SQLCHAR        dataFileName[256];
    SQLCHAR        actionString[256];
    SQLCHAR        msgFileName[256];
    SQLCHAR        fieldTerm[5];
    SQLCHAR        lineTerm[5];
    SQLCHAR        enclStart[5];
    SQLCHAR        enclEnd[5];

    struct sqlca   ca           = {"\0", 0, 0, {0, "\0"}, "\0",
                                   {0, 0, 0, 0, 0, 0}, "\0", "\0"};
    <span>TBExport</span>Struct exportStruct = {NULL, 0, NULL, NULL, NULL, 0, NULL,
                                   0, NULL, NULL};
    <span>TBExport</span>In     exportIn     = {{NULL, 0, NULL, 0, NULL, 0, NULL, 0, NULL, 0}};
    <span>TBExport</span>Out    exportOut    = {0};

    rc= <span>TBConnect</span>((SQLCHAR *)DNS_NAME, (SQLCHAR *)USER_NAME, (SQLCHAR *)PWD, &amp;ca);
    
    if (rc != SQL_SUCCESS) return -1;

    strcpy((char *)dataFileName, "./all_tables.dat");
    strcpy((char *)actionString, "select * from all_tables");
    strcpy((char *)msgFileName, "./all_tables.log");
    strcpy((char *)fieldTerm, ",");
    strcpy((char *)lineTerm, "\n");
    strcpy((char *)enclStart, "\"");
    strcpy((char *)enclEnd, "\"");

    /* setting data file name */
    exportStruct.piDataFileName   = dataFileName;
    exportStruct.iDataFileNameLen = strlen((char *)dataFileName);

    /* setting action String */
    exportStruct.piActionString = calloc(1, sizeof(sqlstr));
    exportStruct.piActionString-&gt;data   = actionString;
    exportStruct.piActionString-&gt;length = strlen((char *)actionString);

    /* setting file type */
    exportStruct.iFileType = SQL_DEL;

    /* setting message file name */
    exportStruct.piMsgFileName   = msgFileName;
    exportStruct.iMsgFileNameLen = strlen((char *)msgFileName);

    /* setting field term, line term etc.. */
    exportIn.iMeta.fieldTerm    = fieldTerm;
    exportIn.iMeta.fieldTermLen = strlen((char *)fieldTerm);
    exportIn.iMeta.lineTerm     = lineTerm;
    exportIn.iMeta.lineTermLen  = strlen((char *)lineTerm);
    exportIn.iMeta.enclStart    = enclStart;
    exportIn.iMeta.enclStartLen = strlen((char *)enclStart);
    exportIn.iMeta.enclEnd      = enclEnd;
    exportIn.iMeta.enclEndLen   = strlen((char *)enclEnd);

    /* setting export input, output information */
    exportStruct.piExportInfoIn  = &amp;exportIn;
    exportStruct.poExportInfoOut = &amp;exportOut;

    /* setting file type */
    rc = <span>TBExport</span>(versionNumber, &amp;exportStruct, &amp;ca);
    if (rc != SQL_SUCCESS) return -1;

    /* disconnect */
    rc= <span>TBDisconnect</span>((SQLCHAR *)DNS_NAME, &amp;ca);
    if (rc != SQL_SUCCESS) return -1;

    return 1;
}</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_tbimport"/>6.3.4. <span>TBImport</span></h3></div></div></div>
      

      <p>외부 파일에 존재하는 데이터를 데이터베이스에 로드하는 함수이다. 여기서 외부 파일은 <span>tbLoader</span> 유틸리티가 지원하는 고정된 레코드 형태와 분리된 레코드 형태를
      지원한다. 단, 대상 테이블 또는 뷰의 INSERT 권한이 있어야 한다.</p>

      <p><code class="function"><span>TBImport</span></code> 함수의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <pre class="programlisting">SQLRETURN SQL_API <span>TBImport</span>(SQLINTEGER versionNumber,
                           <span>TBImport</span>Struct *pParamStruct,
                           struct sqlca *pSqlca);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="110" align="left"/><col width="70" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th align="left">용도</th><th>설명</th></tr></thead><tbody><tr><td align="left">versionNumber</td><td align="left">입력</td><td>유틸리티 라이브러리의 버전번호이다. 이 파라미터는 유틸리티 라이브러리가 변경될 것에 대비하여
                  하위 버전과의 호환성을 위해 존재한다. 현재 버전번호는 1이다.</td></tr><tr><td align="left">pParamStruct</td><td align="left">입출력</td><td>이 파라미터를 사용하여 로드할 대상 정보를 명시하고, 로드 후에는 결과정보를 받는다. 자세한
                  내용은<a href="chapter_tbcli_function.html#tbl_TBImportStruct"><span> "TBImport</span>Struct 구조체"</a>를
                  참고한다.</td></tr><tr><td align="left">pSqlca</td><td align="left">출력</td><td>반환 코드가 SQL_SUCCESS가 아닌 경우 유틸리티 내부에서 발생한 에러 정보를
                  포함한다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>반환 코드</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">반환 코드</th><th>설명</th></tr></thead><tbody><tr><td align="left">SQL_SUCCESS</td><td>함수가 성공적으로 완료된 상태</td></tr><tr><td align="left">SQL_SUCCESS_WITH_INFO</td><td>함수가 성공적으로 완료되었으나, 경고 메시지가 있는 상태</td></tr><tr><td align="left">SQL_ERROR</td><td>치명적인 에러가 발생한 상태</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <pre class="programlisting">#include "<span>tbutil.h</span>"

#define DNS_NAME  "DEFAULT"
#define USER_NAME "SYS"
#define PWD       "<span>tibero</span>"

int main(int argc, char *argv[]) {
 SQLRETURN      rc = SQL_SUCCESS;
 SQLINTEGER     versionNumber = 1;
 SQLCHAR        dataFileName[256];
 SQLCHAR        actionString[256];
 SQLCHAR        msgFileName[256];
 SQLCHAR        badFileName[256];
 SQLCHAR        fieldTerm[5];
 SQLCHAR        lineTerm[5];
 SQLCHAR        enclStart[5];
 SQLCHAR        enclEnd[5];
 SQLCHAR        escape[5];

 struct sqlca   ca           = {"\0", 0, 0, {0, "\0"}, "\0",
                               {0, 0, 0, 0, 0, 0}, "\0", "\0"};
 <span>TBImport</span>Struct importStruct = {NULL, 0, NULL, NULL, NULL, 0, NULL,
                                0, NULL, 0, 0, NULL, NULL};
 <span>TBImport</span>In     importIn     = {{NULL, 0, NULL, 0, NULL, 0, NULL, 0, NULL, 0},
                                0, 0, 0, 0};
 <span>TBImport</span>Out    importOut    = {0, 0, 0, 0, 0, 0};

 rc= <span>TBConnect</span>((SQLCHAR *)DNS_NAME, (SQLCHAR *)USER_NAME, (SQLCHAR *)PWD, &amp;ca);
 if (rc != SQL_SUCCESS) return -1;

 strcpy((char *)actionString, "LOAD DATA "
                            "APPEND "
                            "INTO TABLE DEPT "
                            "MULTI INSERT INDEXES "
                            "(position, deptno, dname CONSTANT \"co dep\", loc)");
 strcpy((char *)dataFileName, "./test.dat");
 strcpy((char *)msgFileName, "./test.log");
 strcpy((char *)badFileName, "./test.bad");
 strcpy((char *)fieldTerm,   ",b");
 strcpy((char *)lineTerm,    "abbb\n");
 strcpy((char *)enclStart,   "{$");
 strcpy((char *)enclEnd,     "$}");
 strcpy((char *)escape,      "XX");

 /* setting data file name */
 importStruct.piDataFileName   = dataFileName;
 importStruct.iDataFileNameLen = strlen((char *)dataFileName);

 /* setting action String */
 importStruct.piActionString = calloc(1, sizeof(sqlstr));
 importStruct.piActionString-&gt;data   = actionString;
 importStruct.piActionString-&gt;length = strlen((char *)actionString);

 /* setting file type */
 importStruct.iFileType = SQL_DEL;

 /* setting message file name */
 importStruct.piMsgFileName   = msgFileName;
 importStruct.iMsgFileNameLen = strlen((char *)msgFileName);

 /* setting bad data file name */
 importStruct.piBadFileName   = badFileName;
 importStruct.iBadFileNameLen = strlen((char *)badFileName);

 /* turn on DPL mode */
 importStruct.iDPL            = 2;

 /* setting field term, line term etc.. */
 importIn.iMeta.fieldTerm    = fieldTerm;
 importIn.iMeta.fieldTermLen = strlen((char *)fieldTerm);
 importIn.iMeta.lineTerm     = lineTerm;
 importIn.iMeta.lineTermLen  = strlen((char *)lineTerm);
 importIn.iMeta.enclStart    = enclStart;
 importIn.iMeta.enclStartLen = strlen((char *)enclStart);
 importIn.iMeta.enclEnd      = enclEnd;
 importIn.iMeta.enclEndLen   = strlen((char *)enclEnd);
 importIn.iMeta.escape       = escape;
 importIn.iMeta.escapeLen    = strlen((char *)escape);

 importIn.iRowcount          = 0;
 importIn.iSkipcount         = 0;
 importIn.iCommitcount       = 2;
 importIn.iErrorcount        = 50;

 /* setting export input, output information */
 importStruct.piImportInfoIn  = &amp;importIn;
 importStruct.poImportInfoOut = &amp;importOut;

 /* setting file type */
 rc = <span>TBImport</span>(versionNumber, &amp;importStruct, &amp;ca);
 if (rc != SQL_SUCCESS) return -1;    

   fprintf(stdout, "oRowsRead[%ld]", importOut.oRowsRead);
   fprintf(stdout, "oRowsSkipped[%ld]", importOut.oRowsSkipped);
   fprintf(stdout, "oRowsInserted[%ld]", importOut.oRowsInserted);
   fprintf(stdout, "oRowsUpdated[%ld]", importOut.oRowsUpdated);
   fprintf(stdout, "oRowsRejected[%ld]", importOut.oRowsRejected);
   fprintf(stdout, "oRowsCommitted[%ld]", importOut.oRowsCommitted);

   /* disconnect */
   rc= <span>TBDisconnect</span>((SQLCHAR *)DNS_NAME, &amp;ca);
   if (rc != SQL_SUCCESS) return -1;

   return 1;
}</pre>
        </li></ul></div>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chapter_tbdv.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="idx.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제5장 <span>tbdv</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 색인</td></tr></table></div><div xmlns="" align="center"/></body></html>