<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제1장 tbCLI 소개</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero tbCLI 안내서"/><link rel="up" href="index.html" title="Tibero tbCLI 안내서"/><link rel="prev" href="about.html" title="안내서에 대하여"/><link rel="next" href="ch02.html" title="제2장 데이터 타입"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제1장 <span xmlns="http://www.w3.org/1999/xhtml">tbCLI</span> 소개</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="about.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="ch02.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="d5e405"/>제1장 <span>tbCLI</span> 소개</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="ch01.html#d5e410">1.1. 개요</a></span></dt><dt><span class="section"><a href="ch01.html#d5e465">1.2. 구성요소</a></span></dt><dd><dl><dt><span class="section"><a href="ch01.html#d5e469">1.2.1. <span>tbCLI</span> 핸들</a></span></dt><dt><span class="section"><a href="ch01.html#d5e520">1.2.2. <span>tbCLI</span> 함수</a></span></dt><dt><span class="section"><a href="ch01.html#d5e542">1.2.3. <span>tbCLI</span> 에러 메시지</a></span></dt></dl></dd><dt><span class="section"><a href="ch01.html#d5e600">1.3. 프로그램 구조</a></span></dt><dd><dl><dt><span class="section"><a href="ch01.html#sect_tbcli_program_1">1.3.1. 시작 설정 부분</a></span></dt><dt><span class="section"><a href="ch01.html#sect_tbcli_program_2">1.3.2. SQL 문장 실행 및 에러 처리 부분</a></span></dt><dt><span class="section"><a href="ch01.html#sect_tbcli_program_3">1.3.3. 종료 설정 부분</a></span></dt></dl></dd></dl></div>
  

  <p>본 장에서는 <span>tbCLI</span>의 기본 개념과 구성요소, 프로그램의 구조를 소개한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e410"/>1.1. 개요<a id="d5e412" class="indexterm"/></h2></div></div></div>
    

    <p><span><strong class="guibutton"><span>tbCLI</span></strong></span>는 <span>Tibero</span>가 제공하는 Call Level Interface(CLI)로 사용자의 애플리케이션 프로그램과 <span>Tibero</span> 간의 SQL 인터페이스 역할을 수행한다. 사용자는 <span>tbCLI</span>
    라이브러리를 통해 <span>Tibero</span>에 접근하려는 C 또는 C++ 애플리케이션 프로그램을 쉽게 작성할
    수 있다.</p>

    <p><span>tbCLI</span>는 ODBC(Open Database Connectivity) 및
    X/Open Call Level Interface Standard를 기초로 개발되었다. <span>tbCLI</span>는
    ODBC 2.0의 Level 2 및 ODBC 3.0의 Level 1의 모든 조건, 그리고 ODBC 3.0 Level 2의 대부분의
    조건을 만족한다. 따라서 ODBC나 CLI를 이용해 작성된 기존의 애플리케이션 프로그램은 <span>tbCLI</span>
    환경으로 쉽게 전환될 수 있다. <a id="d5e426" class="indexterm"/><a id="d5e428" class="indexterm"/><a id="d5e430" class="indexterm"/></p>

    <p>특히 <span>tbCLI</span>는 아래 그림과 같은
    <span><strong class="guibutton">클라이언트/서버</strong></span> 환경에서 유용하다.</p>

    <div class="figure"><a id="fig_tbcli_prog_struct"/><p class="title"><b>[그림 1.1] 클라이언트/서버 환경</b></p><div class="figure-contents">
      

      <div xmlns="" class="mediaobject" align="left"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="470"><tr><td align="left"><img src="resources/tibero_cs_env.png" align="top" width="470" alt="클라이언트/서버 환경"/></td></tr></table></div>
    </div></div><br class="figure-break"/>

    <p>클라이언트의 애플리케이션 프로그램이 <span>tbCLI</span>의 API를 호출하면, 데이터베이스 시스템이 이를 처리하고 그 결과를
    클라이언트로 반환해준다. 물론 사용자는 <span>tbESQL</span> 등의 인터페이스를 이용하여 데이터를 처리할 수 있지만, <span>tbCLI</span>를
    사용함으로써 애플리케이션 프로그램과 데이터를 더 세밀하게 조작할 수
    있다.</p><div class="literallayout"><p/></div>

    <p><span>tbCLI</span>는 다음과 같은 특징이 있다.<a id="d5e447" class="indexterm"/></p><div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>실행 파일을 생성할 때 프리컴파일러(Precompiler)가 필요 없다.</p>

          <p><span>tbCLI</span>는 <span>tbESQL</span>과 마찬가지로 일반적인 프로그램 언어와 SQL 문장의 장점을
          융합한 인터페이스이다. 하지만 <span>tbESQL</span>과 다르게 일반적인 프로그램에 가깝다.</p>
        </li><li>
          <p>모듈을 효율적으로 관리할 수 있으며, 가독성이 뛰어나다.</p>
        </li><li>
          <p>애플리케이션 패키지를 바인딩할 필요가 없다.</p>
        </li><li>
          <p>접근할 데이터베이스의 통계(statistics)를 사용할 수 있다.</p>
        </li><li>
          <p>스레드의 안정성을 보장한다. 애플리케이션 프로그램을 멀티 스레드로 작성할 수 있도록 스레드의 안정성을
          보장한다.</p>
        </li></ul></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e465"/>1.2. 구성요소</h2></div></div></div>
    

    <p>본 절에서는 <span>tbCLI</span> 프로그램을 작성하거나 실행하기 전에 기본적으로 알아야 할 구성요소에 대해
    설명한다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e469"/>1.2.1. <span>tbCLI</span> 핸들<a id="d5e472" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">핸들</strong></span>은 <span>tbCLI</span>에서 관리하고 있는 몇 가지 주요 데이터 구조에 대한
      포인터(pointer)이다. 핸들을 사용함으로써 <span>tbCLI</span>
      프로그램은 복잡한 구조를 갖는 데이터를 보다 편리하게 관리할 수 있다.</p>

      <p>핸들의 내부 데이터는 데이터 구조에 작업이 이루어지면 자동으로 갱신되기 때문에 애플리케이션 프로그램 개발자는 핸들이
      가리키는 데이터 구조의 세부 사항에 대해 알 필요가 없으며, 내부 데이터를 직접 접근할 필요도 없다.</p>

      <p><span>tbCLI</span> 프로그램은 다음과 같이 네 가지 핸들을 사용한다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p><span><strong class="guibutton">환경 핸들(environment handle)</strong></span><a id="d5e485" class="indexterm"/><a id="d5e487" class="indexterm"/></p>

          <p><span>tbCLI</span> 프로그램의 환경에 대한 데이터를 포함한다. 포함되는 데이터로는
          현재 환경의 상태, 환경에 할당되어 있는 연결 핸들의 리스트, 환경에 대한 에러 정보 등이다.</p>
        </li><li>
          <p><span><strong class="guibutton">연결 핸들(connection handle)</strong></span><a id="d5e495" class="indexterm"/><a id="d5e497" class="indexterm"/></p>

          <p>데이터소스(data source)와의 연결에 대한 데이터를 포함한다. 포함되는 데이터로는 현재 연결 상태,
          연결에 할당되어 있는 문장 핸들의 리스트, 연결에 대한 에러 정보 등이다.</p>
        </li><li>
          <p><span><strong class="guibutton">문장 핸들(statement handle)</strong></span><a id="d5e504" class="indexterm"/><a id="d5e506" class="indexterm"/></p>

          <p><span>tbCLI</span> 프로그램에서 실행할 하나의 SQL 문장에 대한 데이터를
          포함한다. 포함되는 데이터로는 현재 문장 상태, 문장 내의 입력 파라미터 및 출력 컬럼의 리스트, 문장에 대한 에러 정보
          등이다.</p>
        </li><li>
          <p><span><strong class="guibutton">서술자 핸들(descriptor handle)</strong></span><a id="d5e514" class="indexterm"/><a id="d5e516" class="indexterm"/></p>

          <p>문장 핸들과 연관된 결과 집합(ResultSet)의 각 컬럼이나 바인드된 파라미터의 데이터를 포함한다. 포함되는
          데이터로는 SQL 문장의 입력 파라미터, 출력 컬럼에 대한 메타데이터(metadata) 등이다.</p>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e520"/>1.2.2. <span>tbCLI</span> 함수</h3></div></div></div>
      

      <p><span>tbCLI</span> 프로그램에서 데이터베이스 작업을 수행하기 위해서는 <span>tbCLI</span>
      함수를 사용해야 한다. 대부분의 <span>tbCLI</span> 함수는 대상이 되는 핸들을 입력 파라미터로 받으며,
      <span><strong class="guibutton">SQLRETURN</strong></span> 타입의 반환 코드를 갖는다.<a id="d5e528" class="indexterm"/></p>

      <p>다음은 <span>tbCLI</span> 함수 중에서 SQL 문장을 직접 실행할 수 있는
      <code class="function">SQLExecDirect</code> 함수<a id="d5e533" class="indexterm"/>의 프로토타입이다.</p>

      <pre class="programlisting">SQLRETURN SQLExecDirect(SQLHSTMT StatementHandle, SQLCHAR *SQLString,
                        SQLINTEGER SQLStringSize);</pre>

      <p><span>tbCLI</span> 함수는 기능별로 몇 개의 그룹으로 나누어 제공된다. 예를 들면 핸들을
      할당하거나 연결과 관련된 함수, SQL 문장 실행과 관련된 함수, SQL 질의 결과의 검색과 관련된 함수, 서술자 관련 함수,
      에러 정보와 관련된 함수, 데이터소스 정보와 관련된 함수 등이 있다.</p>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
        <p><span>tbCLI</span> 함수의 사용에 대한 자세한 내용은 <a href="chapter_tbcli_function.html" title="제3장 tbCLI 함수">“제3장 <span>tbCLI</span> 함수”</a>를 참고한다.</p>
      </div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e542"/>1.2.3. <span>tbCLI</span> 에러 메시지</h3></div></div></div>
      

      <p><span>tbCLI</span> 프로그램은 <span>tbCLI</span>
      함수를 실행한 후 반환되는 코드에 의해 실행 결과를 얻는다. 그러나 사용자는 보다 더 다양한 정보를 필요로 한다. 이러한 정보를
      제공하기 위해서 <span>tbCLI</span>는 진단 레코드를 생성한다.</p>

      <p>진단 레코드는 수행한 함수의 반환 코드뿐만 아니라 실행 결과에 대한 다양한 정보를 갖고 있다.<a id="d5e550" class="indexterm"/></p>

      <p>진단 레코드는 다음과 같이 두 가지 레코드로 구성된다.</p><div class="itemizedlist"><ul type="disc" compact="compact"><li>
            <p><span><strong class="guibutton">헤더 레코드(header record)</strong></span><a id="d5e557" class="indexterm"/></p>

            <p>반환 코드, 로우 개수, 상태 레코드의 개수, 실행된 명령의 타입 등의 필드로 구성되어 있다. 반환 코드가
            SQL_INVALID_HANDLE인 경우를 제외하고 <span>tbCLI</span> 함수가 실행되면 항상 헤더 레코드가 생성된다.</p>
          </li><li>
            <p><span><strong class="guibutton">상태 레코드(status record)</strong></span><a id="d5e564" class="indexterm"/></p>

            <p>상태 레코드는 경고 및 에러에 대한 정보를 포함한다.</p>

            <p>반환 코드가 SQL_ERROR, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA,
            SQL_NEED_DATA, SQL_STILL_EXECUTING인 경우 생성된다.</p>

            <p>상태 레코드의 필드 중에서 가장 중요한 필드 중의 하나는
            <span><strong class="guibutton">SQLSTATE</strong></span> 필드이다. 에러 또는 경고 코드를 표준화한 것으로 값은
            X/Open과 ISO/IEC 표준으로 정해져 있다. 형식은 <span><strong class="guibutton">CCSSS</strong></span> 다섯
            자리의 문자열이며, CC는 에러 클래스, SSS는 에러 서브 클래스를 의미한다.<a id="d5e571" class="indexterm"/></p>
          </li></ul></div>

      <p>진단 레코드는 하나의 헤더 레코드로 시작되고 경우에 따라 1개 이상의 상태 레코드가 추가된다. 진단 레코드의 값을 얻기
      위해서는 <code class="function">SQLGetDiagRec</code>와
      <code class="function">SQLGetDiagField</code> 함수를 사용해야 한다. 이 두 함수는 파라미터로 주어진 핸들에
      포함된 진단 레코드의 정보를 반환하는 역할만을 수행한다. 진단 레코드는 환경, 연결, 문장, 서술자 핸들에서 사용되고
      관리된다.</p>

      <div class="informaltable">
        <table border="1"><colgroup><col width="140" align="left"/><col/></colgroup><thead><tr><th align="left">함수</th><th>설명</th></tr></thead><tbody><tr><td align="left"><code class="function">SQLGetDiagField</code><a id="d5e587" class="indexterm"/></td><td>진단 레코드 중 단일 필드의 정보를 얻기 위해 사용하는 함수이다. 헤더 레코드와 상태 레코드 모두에
              사용할 수 있다.</td></tr><tr><td align="left"><code class="function">SQLGetDiagRec</code><a id="d5e593" class="indexterm"/></td><td>상태 레코드에 포함된 SQLSTATE 코드, 에러 코드, 진단 메시지 등의 여러 개의 필드 값을 동시에
              얻기 위해 사용하는 함수이다. 상태 레코드에만 사용할 수 있다.</td></tr></tbody></table>
      </div>

      <p/>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
        <p>에러 메시지에 대한 자세한 내용은 <a href="chapter_error_message.html" title="제4장 tbCLI 에러 메시지">“제4장 <span>tbCLI</span> 에러 메시지”</a>를
        참고한다.</p>
      </div>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e600"/>1.3. 프로그램 구조<a id="d5e602" class="indexterm"/></h2></div></div></div>
    

    <p><span>tbCLI</span> 프로그램은 아래 그림과 같이 크게 나눈다.</p>

    <div class="figure"><a id="fig_tbcli_prog_struct"/><p class="title"><b>[그림 1.2] <span>tbCLI</span> 프로그램의 구조</b></p><div class="figure-contents">
      

      <div xmlns="" class="mediaobject" align="left"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="440"><tr><td align="left"><img src="resources/tibero_tbcli_program_structure.png" align="top" width="440" alt="tbCLI 프로그램의 구조"/></td></tr></table></div>
    </div></div><br class="figure-break"/>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p><span><strong class="guibutton">시작 설정 부분</strong></span>(Starting setting)</p>
        </li><li>
          <p><span><strong class="guibutton">SQL 문장 실행 및 에러 처리 부분</strong></span>(SQL query
          execution and error handling)</p>
        </li><li>
          <p><span><strong class="guibutton">종료 설정 부분</strong></span>(Ending setting)</p>
        </li></ul></div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_tbcli_program_1"/>1.3.1. 시작 설정 부분<a id="d5e626" class="indexterm"/></h3></div></div></div>
      

      <p><span>tbCLI</span> 프로그램을 시작하기 위해서는 우선 초기화 설정을 해야 한다. 초기화
      설정을 하려면 환경 핸들과 연결 핸들을 할당하고 데이터소스와의 실제 연결을 수행해야 한다. 여기서 데이터소스<a id="d5e632" class="indexterm"/>란 <span>Tibero</span>의 소프트웨어 및 하드웨어의 전체 구성을 의미한다.</p>

      <p>다음은 <span>tbCLI</span> 프로그램을 시작하는 예이다.</p>

      <div class="example"><a id="example_tbcli_program_initial"/><p class="title"><b>[예 1.1] <span>tbCLI</span> 프로그램의 시작 설정</b></p><div class="example-contents">
          

          

          <pre class="programlisting">SQLHENV h_env;

SQLHDBC h_dbc;

SQLRETURN rc = SQL_SUCCESS;

...<span><strong class="guibutton">

rc = SQLAllocHandle(SQL_HANDLE_ENV, NULL, &amp;h_env);</strong></span><em class="lineannotation"><span class="lineannotation">   ... ① ...</span></em>

if (rc != SQL_SUCCESS) <em class="lineannotation"><span class="lineannotation">  ...</span></em><span><strong class="guibutton">


rc = SQLAllocHandle(SQL_HANDLE_DBC, h_env, &amp;h_dbc);</strong></span><em class="lineannotation"><span class="lineannotation">  ... ② ...</span></em>

if (rc != SQL_SUCCESS) <em class="lineannotation"><span class="lineannotation">  ...</span></em><span><strong class="guibutton">


rc = SQLConnect(h_dbc, (SQLCHAR *)ds_name, SQL_NTS, (SQLCHAR *)user,
                SQL_NTS, (SQLCHAR *)passwd, SQL_NTS);</strong></span><em class="lineannotation"><span class="lineannotation">   ... ③ ...</span></em>

if (rc != SQL_SUCCESS &amp;&amp; rc != SQL_SUCCESS_WITH_INFO) <em class="lineannotation"><span class="lineannotation">  ...</span></em></pre>

          <p>①, ② 초기화 설정을 위해 환경 핸들과 연결 핸들을 할당한다.</p>

          <p>③ <code class="function">SQLConnect</code> 함수를 통해 데이터소스에 연결한다.</p>

          <p>이 함수를 호출할 때에는 파라미터로 데이터소스의 이름(ds_name)과 사용자의 이름(user),
          패스워드(passwd)를 함께 전달해야 한다. 뿐만 아니라 파라미터의 길이도 함께 설정해 주어야 하는데 위의 <a href="ch01.html#example_tbcli_program_initial" title="[예 1.1] tbCLI 프로그램의 시작 설정">[예 1.1]</a>에서는 길이 대신 NULL로 끝나는
          문자열(null-terminating string) 즉 SQL_NTS를 설정한다.<a id="d5e656" class="indexterm"/><a id="d5e658" class="indexterm"/></p>

          <p>④ 데이터소스에 연결하는 과정이 끝나면 <span>tbCLI</span> 프로그램은 SQL 문장을 실행하기 위해 다음과 같이 반드시 한
          개 이상의 문장 핸들을 할당한다.</p>

          

          <pre class="programlisting">SQLHSTMT h_stmt;

...<span><strong class="guibutton">

rc = SQLAllocHandle(SQL_HANDLE_STMT, h_dbc, &amp;h_stmt);</strong></span><em class="lineannotation"><span class="lineannotation">  ... ④ ...</span></em>

if (rc != SQL_SUCCESS) <em class="lineannotation"><span class="lineannotation">  ...</span></em></pre>
        </div></div><p><br class="example-break"/></p>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_tbcli_program_2"/>1.3.2. SQL 문장 실행 및 에러 처리 부분<a id="d5e668" class="indexterm"/></h3></div></div></div>
      

      <p>SQL 문장을 실행하는 방법은 다음과 같이 두 가지가 있다.</p>

      <p/>

      <h4><a id="d5e674"/>직접 실행</h4>

      <p>SQL 문장을 <code class="function">SQLExecDirect</code> 함수를 이용하여 한 번에 실행하는
      방법이다.<a id="d5e677" class="indexterm"/></p>

      <p>다음은 직접 실행의 예이다.</p>

      <div class="example"><a id="d5e681"/><p class="title"><b>[예 1.2] <span>tbCLI</span> 프로그램의 SQL 문장 실행 - 직접 실행</b></p><div class="example-contents">
        

        

        <pre class="programlisting">SQLCHAR *update = "UPDATE EMP SET SALARY = SALARY * 1.05 "
                  "WHERE DEPTNO = 5";

rc = SQLExecDirect(h_stmt, update, SQL_NTS);
if (rc != SQL_SUCCESS) ...</pre>
      </div></div><br class="example-break"/>

      <div class="literallayout"><p/></div>

      <h4><a id="d5e686"/>준비된 실행</h4>

      <p><code class="function">SQLPrepare</code>와 <code class="function">SQLExecute</code>
      함수를 이용하여 두 단계에 걸쳐 실행하는 방법이다.<a id="d5e690" class="indexterm"/></p>

      <p>대부분 SQL 문장 내에 파라미터가 포함된 경우에는 주로 준비된 실행 방법을 이용한다.
      <code class="function">SQLPrepare</code>와 <code class="function">SQLExecute</code> 함수 사이에
      <code class="function">SQLBindParameter</code> 함수를 호출하여 파라미터에 실제 값을 설정한다. 다음은 두
      개의 입력 파라미터를 포함한 SQL 문장을 실행하는 예이다.</p>

      <div class="example"><a id="d5e697"/><p class="title"><b>[예 1.3] <span>tbCLI</span> 프로그램의 SQL 문장 실행 - 준비된 실행</b></p><div class="example-contents">
        

        

        <pre class="programlisting">SQLCHAR *update = "UPDATE EMP SET SALARY = SALARY * ? "
                  "WHERE DEPTNO = ?";
double ratio = 0.0;
short deptno = 0;
    ...<span><strong class="guibutton">

rc = SQLPrepare(h_stmt, update, SQL_NTS);</strong></span><em class="lineannotation"><span class="lineannotation">   ... ① ...</span></em>

if (rc != SQL_SUCCESS) ...<span><strong class="guibutton">

rc = SQLBindParameter(h_stmt, 1, SQL_PARAM_INPUT, SQL_C_DOUBLE,
                      SQL_DOUBLE, 5, 2, &amp;ratio, 0, NULL);</strong></span><em class="lineannotation"><span class="lineannotation">      ... ⓐ ...</span></em>

if (rc != SQL_SUCCESS) ...<span><strong class="guibutton">

rc = SQLBindParameter(h_stmt, 2, SQL_PARAM_INPUT, SQL_C_SHORT,
                      SQL_SMALLINT, 0, 0, &amp;deptno, 0, NULL);</strong></span><em class="lineannotation"><span class="lineannotation">  ... ⓑ ...</span></em>

if (rc != SQL_SUCCESS) ...

ratio = 1.05;
deptno = 5;<span><strong class="guibutton">

SQLExecute(h_stmt);</strong></span><em class="lineannotation"><span class="lineannotation">    ... ② ...</span></em>

if (rc != SQL_SUCCESS) ...</pre>

        <p>위의 예에서는 SQL 문장 내의 입력 파라미터를 물음표(?)로 표시한다. 입력 파라미터의 위치를 표시할 때에는 1
        이상의 정수를 사용한다.</p>

        <p>① 준비된(prepared) SQL 문장에 포함된 각각의 입력 파라미터의 값을 저장하고 있는 변수의 포인터를
        설정한다. 각각의 입력 파라미터(ⓐ, ⓑ)에 입출력 방향, C 또는 C++의 데이터 타입, SQL의 데이터 타입,
        정밀도(precision), 범위(scale) 등을 함께 설정한다.</p>

        <p>② SQL 문장을 실행한다. 이 문장을 실행하면 설정된 입력 파라미터에 의해 EMP 테이블이 갱신된다.</p>
      </div></div><br class="example-break"/>

      <div class="literallayout"><p/></div>

      <p>SQL 문장을 실행하고 나서 몇 개의 로우가 갱신되었는지 확인하려면
      <code class="function">SQLRowCount</code> 함수를 사용한다.</p>

      <p>사용하는 방법은 다음과 같다.</p>

      <pre class="programlisting">rc = SQLRowCount(h_stmt, &amp;count);</pre>

      <p>각 함수의 반환 코드는 수행 결과에 대한 정보를 가지고 있으므로, 함수를 호출한 후에는 항상 반환 코드를 확인해야
      한다.</p>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_tbcli_program_3"/>1.3.3. 종료 설정 부분<a id="d5e720" class="indexterm"/></h3></div></div></div>
      

      <p><span>tbCLI</span> 프로그램을 종료하기 위해서는 <a href="ch01.html#sect_tbcli_program_1" title="1.3.1. 시작 설정 부분">“1.3.1. 시작 설정 부분”</a>에서 수행한 작업과 반대되는 작업을 수행해야 한다.</p>

      <p>다음은 <span>tbCLI</span> 프로그램을 종료하는 예이다.</p>

      <div class="example"><a id="d5e729"/><p class="title"><b>[예 1.4] <span>tbCLI</span> 프로그램의 종료 설정</b></p><div class="example-contents">
        

        

        <pre class="programlisting"><span><strong class="guibutton">rc = SQLDisconnect(h_dbc);</strong></span><em class="lineannotation"><span class="lineannotation">             ... ① ...</span></em>

if (rc != SQL_SUCCESS) ...<span><strong class="guibutton">

SQLFreeHandle(SQL_HANDLE_DBC, h_dbc);</strong></span><em class="lineannotation"><span class="lineannotation">  ... ② ...</span></em><span><strong class="guibutton">

SQLFreeHandle(SQL_HANDLE_ENV, h_env);</strong></span><em class="lineannotation"><span class="lineannotation">  ... ③ ...</span></em></pre>

        <p>① 데이터소스의 연결을 해제한다.</p>

        <p>②, ③ 할당한 연결 핸들과 환경 핸들을 시스템에 반환한다.</p>
      </div></div><br class="example-break"/>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="about.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch02.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">안내서에 대하여 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제2장 데이터 타입</td></tr></table></div><div xmlns="" align="center"/></body></html>