<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제36장 DBMS_SPACE</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero tbPSM 참조 안내서"/><link rel="up" href="index.html" title="Tibero tbPSM 참조 안내서"/><link rel="prev" href="chap_dbms_session.html" title="제35장 DBMS_SESSION"/><link rel="next" href="chap_dbms_space_admin.html" title="제37장 DBMS_SPACE_ADMIN"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제36장 DBMS_SPACE</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chap_dbms_session.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="chap_dbms_space_admin.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="chap_dbms_space"/>제36장 DBMS_SPACE</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="chap_dbms_space.html#d5e13894">36.1. 개요</a></span></dt><dt><span class="section"><a href="chap_dbms_space.html#d5e13901">36.2. 프러시저</a></span></dt><dd><dl><dt><span class="section"><a href="chap_dbms_space.html#DBMS_SPACE_SPACE_USAGE">36.2.1. SPACE_USAGE </a></span></dt><dt><span class="section"><a href="chap_dbms_space.html#DBMS_SPACE_UNUSED_SPACE">36.2.2. UNUSED_SPACE </a></span></dt></dl></dd></dl></div>
  

  <p>본 장에서는 DBMS_SPACE 패키지의 기본 개념과 패키지 내의 프러시저를 사용하는 방법을 설명한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e13894"/>36.1. 개요</h2></div></div></div>
    

    <p><span><strong class="guibutton">DBMS_SPACE</strong></span><a id="d5e13898" class="indexterm"/>는 세그먼트의 크기와 공간 사용에 대한 정보를 제공하는 패키지이다.</p>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e13901"/>36.2. 프러시저</h2></div></div></div>
    

    <p>본 절에서는 DBMS_SPACE 패키지에서 제공하는 프러시저를 알파벳 순으로 설명한다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_SPACE_SPACE_USAGE"/>36.2.1. SPACE_USAGE <a id="d5e13906" class="indexterm"/></h3></div></div></div>
      

      <p>세그먼트의 High Water Mark(이하 HWM) 아래의 공간(즉, 현재 사용하는 공간)에 대한 사용 정보를
      제공한다. 단, 비트맵 블록(bitmap block), 세그먼트 헤더(segment header), 익스텐트 맵 블록(extent
      map block)의 정보는 포함되지 않는다.</p>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
        <p>High Water Mark란 테이블, 인덱스, 클러스터가 생성되고 한 번도 사용되지 않은 공간을
        의미한다.</p>
      </div>

      <div class="literallayout"><p/></div>

      <p>SPACE_USAGE 프러시저<a id="d5e13914" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">DBMS_SPACE.SPACE_USAGE
(
    segment_owner       IN  VARCHAR2,
    segment_name        IN  VARCHAR2,
    segment_type        IN  VARCHAR2,
    unformatted_blocks  OUT NUMBER,
    unformatted_bytes   OUT NUMBER,
    fs1_blocks          OUT NUMBER,
    fs1_bytes           OUT NUMBER,
    fs2_blocks          OUT NUMBER,
    fs2_bytes           OUT NUMBER,
    fs3_blocks          OUT NUMBER,
    fs3_bytes           OUT NUMBER,
    fs4_blocks          OUT NUMBER,
    fs4_bytes           OUT NUMBER,
    full_blocks         OUT NUMBER,
    full_bytes          OUT NUMBER,
    partition_name      IN  VARCHAR2 DEFAULT NULL
);       </pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">segment_owner</td><td>스키마 객체를 소유한 사용자의 이름이다.</td></tr><tr><td align="left">segment_name</td><td>스키마 객체의 이름이다.</td></tr><tr><td align="left">segment_type</td><td><p>스키마 객체의 종류로, 다음 중 하나의 값을
                  갖는다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li>
                        <p>TABLE</p>
                      </li><li>
                        <p>TABLE PARTITION</p>
                      </li><li>
                        <p>TABLE SUBPATITION</p>
                      </li><li>
                        <p>INDEX</p>
                      </li><li>
                        <p>INDEX PARTITION</p>
                      </li><li>
                        <p>INDEX SUBPATITION</p>
                      </li><li>
                        <p>CLUSTER</p>
                      </li><li>
                        <p>LOB</p>
                      </li><li>
                        <p>LOB PARTITION</p>
                      </li><li>
                        <p>LOB SUBPATITION</p>
                      </li></ul></div></td></tr><tr><td align="left">unformatted_blocks</td><td>세그먼트의 HWM 아래에서 포맷되지 않은 블록의 개수이다.</td></tr><tr><td align="left">unformatted_bytes</td><td>세그먼트의 HWM 아래에서 포맷되지 않은 블록의 양(in bytes)이다.</td></tr><tr><td align="left">fs1_blocks</td><td>0%와 25% 사이에 free space를 갖는 블록의 개수이다.</td></tr><tr><td align="left">fs1_bytes</td><td>0%와 25% 사이에 free space를 갖는 블록의 양(in bytes)이다.</td></tr><tr><td align="left">fs2_blocks</td><td>25%와 50% 사이에 free space를 갖는 블록의 개수이다.</td></tr><tr><td align="left">fs2_bytes</td><td>25%와 50% 사이에 free space를 갖는 블록의 양(in
                  bytes)이다.</td></tr><tr><td align="left">fs3_blocks</td><td>50%와 75% 사이에 free space를 갖는 블록의 개수이다.</td></tr><tr><td align="left">fs3_bytes</td><td>50%와 75% 사이에 free space를 갖는 블록의 양(in
                  bytes)이다.</td></tr><tr><td align="left">fs4_blocks</td><td>75%와 100% 사이에 free space를 갖는 블록의 개수이다.</td></tr><tr><td align="left">fs4_bytes</td><td>75%와 100% 사이에 free space를 갖는 블록의 양(in
                  bytes)이다.</td></tr><tr><td align="left">full_blocks</td><td>full로 marking된 블록의 개수이다.</td></tr><tr><td align="left">full_bytes</td><td>full로 marking된 블록의 양(in bytes)이다.</td></tr><tr><td align="left">partition_name</td><td><p>다음의 경우에 따라 다르게 정의된다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li>
                        <p>파티션이면 파티션의 이름이다.</p>
                      </li><li>
                        <p>파티션이 compose 방식이라면 서브파티션(subpartition)의
                        이름이다.</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제 </p><pre class="programlisting">set serveroutput on;

DECLARE
  unformatted_blocks NUMBER;
  unformatted_bytes  NUMBER;
  fs1_blocks NUMBER;
  fs1_bytes NUMBER;
  fs2_blocks NUMBER;
  fs2_bytes NUMBER;
  fs3_blocks NUMBER;
  fs3_bytes NUMBER;
  fs4_blocks NUMBER;
  fs4_bytes NUMBER;
  full_blocks NUMBER;
  full_bytes NUMBER;

BEGIN
  DBMS_SPACE.SPACE_USAGE('SYS', 'EMP', 'TABLE'
                         ,unformatted_blocks
                         ,unformatted_bytes
                         ,fs1_blocks
                         ,fs1_bytes
                         ,fs2_blocks
                         ,fs2_bytes
                         ,fs3_blocks
                         ,fs3_bytes
                         ,fs4_blocks
                         ,fs4_bytes
                         ,full_blocks
                         ,full_bytes);
  DBMS_OUTPUT.PUT_LINE('Space utilization (TABLES) ');
  DBMS_OUTPUT.PUT_LINE('unformatted_blocks: '|| TO_CHAR(unformatted_blocks) );
  DBMS_OUTPUT.PUT_LINE('unformatted_bytes: '|| TO_CHAR(unformatted_bytes) );
  DBMS_OUTPUT.PUT_LINE('fs1_blocks: '|| TO_CHAR(fs1_blocks) );
  DBMS_OUTPUT.PUT_LINE('fs1_bytes: '|| TO_CHAR(fs1_bytes) );
  DBMS_OUTPUT.PUT_LINE('fs2_blocks: '|| TO_CHAR(fs2_blocks) );
  DBMS_OUTPUT.PUT_LINE('fs2_bytes: '|| TO_CHAR(fs2_bytes) );
  DBMS_OUTPUT.PUT_LINE('fs3_blocks: '|| TO_CHAR(fs3_blocks) );
  DBMS_OUTPUT.PUT_LINE('fs3_bytes: '|| TO_CHAR(fs3_bytes) );
  DBMS_OUTPUT.PUT_LINE('fs4_blocks: '|| TO_CHAR(fs4_blocks) );
  DBMS_OUTPUT.PUT_LINE('fs4_bytes: '|| TO_CHAR(fs4_bytes) );
  DBMS_OUTPUT.PUT_LINE('full_blocks: '|| TO_CHAR(full_blocks) );
  DBMS_OUTPUT.PUT_LINE('full_bytes: '|| TO_CHAR(full_bytes) );
END;        </pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_SPACE_UNUSED_SPACE"/>36.2.2. UNUSED_SPACE <a id="d5e14011" class="indexterm"/></h3></div></div></div>
      

      <p>세그먼트의 HWM 위의 공간(즉, 현재 사용하지 않는 공간)에 대한 사용 정보를 제공한다.</p>

      <div class="literallayout"><p/></div>

      <p>UNUSED_SPACE 프러시저<a id="d5e14017" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">DBMS_SPACE.UNUSED_SPACE
(
    segment_owner              IN  VARCHAR2,
    segment_name               IN  VARCHAR2,
    segment_type               IN  VARCHAR2,
    total_blocks               OUT NUMBER,
    total_bytes                OUT NUMBER,
    unused_blocks              OUT NUMBER,
    unused_bytes               OUT NUMBER,
    last_used_extent_file_id   OUT NUMBER,
    last_used_extent_block_id  OUT NUMBER,
    last_used_block            OUT NUMBER,
    partition_name             IN  VARCHAR2 DEFAULT NULL
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">segment_owner</td><td>스키마 객체를 소유한 사용자의 이름이다.</td></tr><tr><td align="left">segment_name</td><td>스키마 객체의 이름이다.</td></tr><tr><td align="left">segment_type</td><td><p>스키마 객체의 종류로, 다음 중 하나의 값을
                  갖는다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li>
                        <p>TABLE</p>
                      </li><li>
                        <p>TABLE PARTITION</p>
                      </li><li>
                        <p>TABLE SUBPATITION</p>
                      </li><li>
                        <p>INDEX</p>
                      </li><li>
                        <p>INDEX PARTITION</p>
                      </li><li>
                        <p>INDEX SUBPATITION</p>
                      </li><li>
                        <p>CLUSTER</p>
                      </li><li>
                        <p>LOB</p>
                      </li><li>
                        <p>LOB PARTITION</p>
                      </li><li>
                        <p>LOB SUBPATITION</p>
                      </li></ul></div></td></tr><tr><td align="left">total_blocks</td><td>세그먼트의 전체 블록의 개수이다.</td></tr><tr><td align="left">total_bytes</td><td>세그먼트의 전체 블록의 양(in bytes)이다.</td></tr><tr><td align="left">unused_blocks</td><td>세그먼트의 HWM 위의 블록의 개수이다.</td></tr><tr><td align="left">unused_bytes</td><td>세그먼트의 HWM 위의 블록의 양(in bytes)이다.</td></tr><tr><td align="left">last_used_extent_file_id</td><td>맨 마지막에 INSERT를 위해 사용된 익스텐트가 속한 파일 ID이다.</td></tr><tr><td align="left">last_used_extent_block_id</td><td>맨 마지막에 INSERT를 위해 사용된 익스텐트가 속한 시작 블록(starting block)의
                  ID이다. 파일 ID와 같이 합하면 DBA가 된다.</td></tr><tr><td align="left">last_used_extent_block</td><td>맨 마지막에 INSERT를 위해 사용된 블록의 숫자(익스텐트 내에서의
                  오프셋)이다.</td></tr><tr><td align="left">partition_name</td><td><p>다음의 경우에 따라 다르게 정의된다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li>
                        <p>파티션이면 파티션의 이름이다.</p>
                      </li><li>
                        <p>파티션이 compose 방식이라면 서브파티션(subpartition)의
                        이름이다.</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제 </p><pre class="programlisting">set serveroutput on;

DECLARE
  total_blocks   NUMBER;
  total_bytes    NUMBER;
  unused_blocks  NUMBER;
  unused_bytes   NUMBER;
  last_used_extent_file_id   NUMBER;
  last_used_extent_block_id  NUMBER;
  last_used_block            NUMBER;

BEGIN
  DBMS_SPACE.UNUSED_SPACE('SYS', 'EMP', 'TABLE'
                          ,total_blocks
                          ,total_bytes
                          ,unused_blocks
                          ,unused_bytes
                          ,last_used_extent_file_id
                          ,last_used_extent_block_id
                          ,last_used_block);

  DBMS_OUTPUT.PUT_LINE('Unused space utilization (TABLES) ');
  DBMS_OUTPUT.PUT_LINE('total_blocks: '|| TO_CHAR(total_blocks) );
  DBMS_OUTPUT.PUT_LINE('total_bytes: '|| TO_CHAR(total_bytes) );
  DBMS_OUTPUT.PUT_LINE('unused_blocks: '|| TO_CHAR(unused_blocks) );
  DBMS_OUTPUT.PUT_LINE('unused_bytes: '|| TO_CHAR(unused_bytes) );
  DBMS_OUTPUT.PUT_LINE('last_used_extent_file_id: '|| 
                        TO_CHAR(last_used_extent_file_id) );
  DBMS_OUTPUT.PUT_LINE('last_used_extent_block_id: '|| 
                        TO_CHAR(last_used_extent_block_id) );
  DBMS_OUTPUT.PUT_LINE('last_used_block: '|| TO_CHAR(last_used_block) );
END;</pre>
        </li></ul></div>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chap_dbms_session.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="chap_dbms_space_admin.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제35장 DBMS_SESSION </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제37장 DBMS_SPACE_ADMIN</td></tr></table></div><div xmlns="" align="center"/></body></html>