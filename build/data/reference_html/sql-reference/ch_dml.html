<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제8장 데이터 조작어</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero SQL 참조 안내서"/><link rel="up" href="index.html" title="Tibero SQL 참조 안내서"/><link rel="prev" href="ch_ddl.html" title="제7장 데이터 정의어"/><link rel="next" href="ch_transaction_and_session_management.html" title="제9장 트랜잭션 및 세션 관리 언어"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제8장 데이터 조작어</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch_ddl.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="ch_transaction_and_session_management.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="ch_dml"/>제8장 데이터 조작어</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="ch_dml.html#sect_INSERT">8.1. INSERT</a></span></dt><dt><span class="section"><a href="ch_dml.html#sect_UPDATE">8.2. UPDATE</a></span></dt><dt><span class="section"><a href="ch_dml.html#sect_DELETE">8.3. DELETE</a></span></dt><dt><span class="section"><a href="ch_dml.html#sect_CALL">8.4. CALL</a></span></dt><dt><span class="section"><a href="ch_dml.html#sect_MERGE">8.5. MERGE</a></span></dt><dt><span class="section"><a href="ch_dml.html#sect_parallel_dml">8.6. 병렬 DML</a></span></dt><dd><dl><dt><span class="section"><a href="ch_dml.html#d5e32309">8.6.1. 수행 방법</a></span></dt><dt><span class="section"><a href="ch_dml.html#d5e32329">8.6.2. 제약 사항</a></span></dt></dl></dd></dl></div>
  

  

  <p><a id="d5e31292" class="indexterm"/><a id="d5e31294" class="indexterm"/><a id="d5e31296" class="indexterm"/>본 장에서는 DML를 자세히 설명한다. DML 명령어는 알파벳 순으로 나열하고, 각 명령어에 대한 설명과 문법,
  특권, 예제를 기술한다. 문법을 설명할 때는 <a href="ch_sql_expressions.html" title="제3장 SQL 연산">“제3장 SQL 연산”</a>의 형식을 그대로 따르고,
  키워드 와 문법의 구성요소는 별도의 표로 설명한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="sect_INSERT"/>8.1. INSERT<a id="d5e31301" class="indexterm"/></h2></div></div></div>
    

    <p>INSERT 구문은 테이블 또는 뷰에 0개 이상의 ROW를 삽입한다.</p>

    <div class="literallayout"><p/></div>

    <p>INSERT의 세부 내용은 다음과 같다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>문법</p>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/insert.png"/></div>

          

          <div xmlns="" class="mediaobject"><img src="resources/single_table_insert.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/into_clause.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/dml_table_expression.png"/></div>

          
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/values_clause.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/multi_table_insert.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/conditional_insert_clause.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/returning_clause.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/error_logging_clause.png"/></div>
        </div>
      </li><li>
        <p>특권</p>

        <p>INSERT ANY TABLE 시스템 특권을 가진 사용자는 모든 테이블과 모든 뷰에서 ROW를 삽입할 수 있다.
        테이블에 ROW를 삽입하기 위해서는 테이블을 사용자가 소유하고 있거나, 그 테이블에 대해 INSERT 스키마 오브젝트 특권을
        가지고 있어야 한다.</p>

        <p>뷰의 기반 테이블에 ROW를 삽입하기 위해서는 다음의 두 가지 조건을 동시에 만족해야 한다.</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>사용자가 뷰를 가지고 있거나 뷰에 대한 INSERT 스키마 오브젝트 특권이 있어야 한다.</p>
          </li><li>
            <p>뷰가 속한 스키마의 사용자가 뷰의 기반 테이블을 가지고 있거나 기반 테이블에 대해 INSERT 스키마
            오브젝트 특권을 가지고 있어야 한다.</p>
          </li></ul></div>
      </li><li>
        <p>구성요소</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>insert</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">single_table_insert</td><td>하나의 테이블 또는 뷰에 값을 명시하여 하나의 ROW를 삽입하거나 부질의를 통해서 ROW를
                    삽입할 수 있다.</td></tr><tr><td align="left">multi_table_insert</td><td><p>하나 이상의 테이블에 부질의로부터 계산된 ROW를 삽입할 수 있다.
                    </p><p>부질의에 별칭을 지정할 수는 없고 부질의의 SELECT 리스트의 컬럼을 참조하여
                    values_clause 또는 WHEN 조건절을 구성할 수는
                    있다.</p><p>multi_table_insert는 로컬 테이블에만 수행할 수 있다. 뷰
                    또는 원격(Remote) 테이블에는 수행될 수 없다.</p></td></tr></tbody></table>
            </div>
          </li><li>
            <p>single_table_insert</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">into_clause</td><td>특정 컬럼에만 ROW를 삽입하고자 할 때 사용한다.</td></tr><tr><td align="left">values_clause</td><td><p>삽입되는 ROW의 컬럼 값을 지정한다. </p><p>삽입할 컬럼 값의
                    나열 순서는 값을 삽입하고자 하는 컬럼과 같은 순서가 되어야 한다. 값을 삽입할 컬럼을 나열한 경우 같은
                    순서로 컬럼 값을 나열해야 하고, 값을 삽입할 컬럼을 나열하지 않은 경우 테이블 내에 정의된 컬럼 순서에
                    따라 컬럼 값을 나열해야 한다.</p></td></tr><tr><td align="left">returning_clause</td><td><p>returning_clause를 사용해 삽입이 일어난 결과 ROW의 값을 반환
                    받을 수 있다. 삽입이 일어난 ROW로부터 연산식의 값을 계산해 그 결과를 호스트 변수 또는
                    <span>tbPSM</span> 변수에
                    저장한다.</p><p>returning_clause에는 다음과 같은 제약조건이
                    있다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                          <p>expr은 단순 연산식 또는 단독으로 사용된 단일 그룹 집단 함수(GROUP BY
                          절이 없음)만 가능하다.</p>
                        </li><li style="list-style-type: circle">
                          <p>하나의 returning_clause에 단순 연산식과 단일 그룹 집단 함수가 같이
                          나올 수는 없다.</p>
                        </li><li style="list-style-type: circle">
                          <p>단일 그룹 집단 함수 내에 예약어 DISTINCT를 사용할 수 없다.</p>
                        </li><li style="list-style-type: circle">
                          <p>LONG 타입의 값을 returning_clause를 통해 받을 수
                          없다.</p>
                        </li></ul></div></td></tr><tr><td align="left">subquery</td><td><p>부질의 결과 반환되는 모든 ROW를 삽입한다. 구체적인 문법은 <a href="ch_sql_queries.html#sect_SELECT" title="5.1. SELECT">“5.1. SELECT”</a>를 참고한다.</p><p>부질의를 통하여 컬럼 값을
                    삽입하는 경우 부질의 결과 반환되는 ROW의 컬럼의 개수 및 순서는 값을 삽입하고자 하는 컬럼의 개수 및
                    순서와 일치해야 한다. 부질의는 임의의 테이블, 뷰를 참조할 수 있으며, 삽입 대상이 되는 테이블 또는
                    뷰를 참조할 수도 있다. 삽입 대상 테이블 또는 뷰를 참조할 때는 별칭을 통하여
                    참조한다.</p></td></tr><tr><td align="left">error_logging_clause</td><td>에러가 발생할 경우 수행을 중단하지 않고 에러 내용과 삽입하려던 데이터를 에러 로깅
                    테이블(Error logging table)에 저장한 후 다음 ROW에 대해서 진행한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>into_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">dml_table_expression</td><td>ROW를 삽입할 객체를 명시한다.</td></tr><tr><td align="left">column</td><td><p>특정 컬럼에만 값을 삽입할 경우에는 해당 컬럼의 이름을
                    나열한다.</p><p>나열되지 않은 컬럼에는 기본값이 선언되어 있으면 기본값이 삽입되고 그렇지
                    않으면 NULL이 삽입된다. 만약 나열되지 않은 컬럼에 대하여 NOT NULL 제약조건이 정의되어
                    있다면, 새로운 ROW를 삽입하지 않고 에러를 반환한다.</p><p>값을 삽입할 컬럼을
                    나열하지 않으면 모든 컬럼에 대하여 삽입할 값을 지정해야 한다. 만약 하나의 INSERT 문장에 의하여
                    ROW의 삽입이 진행되다가 에러가 발생한 경우에 이전에 삽입된 모든 ROW도 함께
                    제거된다.</p></td></tr></tbody></table>
            </div>
          </li><li>
            <p>dml_table_expression</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">schema</td><td>삽입할 객체가 속해 있는 스키마명을 명시한다. 생략하면 현재 사용자의 스키마에서 객체를
                    찾는다.</td></tr><tr><td align="left"><p>table</p><p>view</p><p>subquery</p></td><td><p>테이블이나 뷰의 이름 또는 삽입할 컬럼을 가지고 있는 부질의를 명시한다. 테이블에
                    INSERT를 수행하면 테이블에 연결된 INSERT 트리거가 동작한다.</p><p>뷰 또는
                    부질의를 명시할 경우 하나의 키 보존 테이블에 대한 삽입이 수행된다. 뷰에 삽입하려면 뷰가 갱신 가능한
                    뷰여야 한다. 예를 들어 뷰의 정의에 다음이 포함되어 있으면 그 뷰는 갱신 가능한 뷰가
                    아니다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                          <p>집합 연산자</p>
                        </li><li style="list-style-type: circle">
                          <p>DISTINCT 연산자</p>
                        </li><li style="list-style-type: circle">
                          <p>집단 함수<span>또는
                          분석 함수</span></p>
                        </li><li style="list-style-type: circle">
                          <p>GROUP BY 또는 CONNECT BY 절</p>
                        </li><li style="list-style-type: circle">
                          <p>WITH READ ONLY</p>
                        </li></ul></div><p>뷰가 WITH CHECK OPTION과 함께 정의되어 있으면
                    갱신한 결과를 뷰가 SELECT할 수 있어야만 갱신이 가능하다.</p></td></tr><tr><td align="left">PARTITION (partition)</td><td>테이블이 분할 테이블인 경우 파티션명을 명시할 수 있다. 이를 사용하면 데이터베이스 성능
                    향상에 도움이 된다.</td></tr><tr><td align="left">dblink</td><td>데이터베이스 링크의 이름 전체 또는 부분을 명시한다. 데이터베이스 링크를 명시할 때는 반드시
                    앞에 '@'를 붙여야 한다.</td></tr><tr><td align="left">WITH CHECK OPTION</td><td>삽입 결과를 뷰 또는 부질의가 SELECT할 수 없으면 삽입이 허용되지 않도록
                    한다.</td></tr><tr><td align="left">alias</td><td>테이블, 뷰, 부질의가 INSERT 문의 다른 곳에서 참조될 수 있도록 별칭을
                    지정한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>values_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">expr</td><td>컬럼 값을 반환하는 임의의 연산식이다. 컬럼은 명시할 수 없다. 구체적인 문법은 <a href="ch_sql_expressions.html#sect_expressions" title="3.3. 연산식">“3.3. 연산식”</a>을 참고한다.</td></tr><tr><td align="left">DEFAULT</td><td>컬럼에 삽입할 값으로 DEFAULT라고 지정한 경우 해당 컬럼의 기본값이 선언되어 있으면
                    기본값을 삽입하고 그렇지 않으면 NULL을 삽입한다. 뷰에 대해서는 DEFAULT라고 지정할 수
                    없다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>returning_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">expr</td><td>결과 ROW로부터 returning_clause를 통해 반환할 값을 계산하는 연산식이다.
                    자세한 내용은 <a href="ch_sql_expressions.html#sect_expressions" title="3.3. 연산식">“3.3. 연산식”</a>을 참고한다.</td></tr><tr><td align="left">data_item</td><td>ROW로부터 계산한 expr 값을 저장할 호스트 변수 또는 <span>tbPSM</span> 변수를 지정한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>error_logging_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">table</td><td><p>에러 로깅 테이블의 이름을 명시한다. 명시하지 않으면
                    <span><strong class="guibutton">'ERR$_'</strong></span>를 삽입하려는 테이블명 앞에 붙여서 사용한다.
                    </p><p>DBMS_ERRLOG 패키지를 이용하여 자동으로 생성할 수 있다. 사용자가 직접
                    생성할 수도 있지만 권장하지는 않는다.</p></td></tr><tr><td align="left">expr</td><td>문자열을 반환하는 임의의 표현식이다. 수행문의 태그용으로 사용한다.</td></tr><tr><td align="left">REJECT LIMIT</td><td>허용하는 최대 에러 개수를 명시한다. 최대 에러 개수보다 많은 에러가 발생하면 DML문은
                    수행이 실패하고 롤백된다. 이 절을 명시하지 않는다면 기본값은 0이다.</td></tr></tbody></table>
            </div>

            <p>다음과 같은 에러를 처리할 수 있다.</p>

            <div class="itemizedlist"><ul type="square" compact="compact"><li>
                <p>NOT NULL 제약조건</p>
              </li><li>
                <p>CHECK 제약조건</p>
              </li><li>
                <p>UNIQUE 제약조건</p>
              </li><li>
                <p>PRIMARY KEY, FOREIGN KEY 제약조건</p>
              </li><li>
                <p>데이터 타입 에러</p>
              </li></ul></div>

            <p>다음의 경우에는 사용할 수 없다.</p>

            <div class="itemizedlist"><ul type="square" compact="compact"><li>
                <p>DEFERED 제약조건</p>
              </li><li>
                <p>Direct-Path INSERT, Multi Table INSERT, MERGE 문</p>
              </li><li>
                <p>UPDATE 문의 UNIQUE 제약조건, PRIMARY KEY, FOREIGN KEY
                제약조건</p>
              </li><li>
                <p>LONG, LOB 타입의 컬럼을 가지는 테이블</p>
              </li></ul></div>
          </li><li>
            <p>multi_table_insert</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">ALL into_clause</td><td>예약어 ALL 다음에 여러 개의 into_clause를 사용하면 부질의의 결과 ROW에
                    대해서 각 into_clause를 한 번씩 수행한다.</td></tr><tr><td align="left">values_clause</td><td><p>삽입되는 ROW의 컬럼 값을 지정한다. subquery의 컬럼을 사용할 수
                    있다.</p><p>삽입할 컬럼 값의 나열 순서는 값을 삽입하고자 하는 컬럼과 같은 순서가
                    되어야 한다. 값을 삽입할 컬럼을 나열한 경우 같은 순서로 컬럼 값을 나열해야 하고, 값을 삽입할 컬럼을
                    나열하지 않은 경우 테이블 내에 정의된 컬럼 순서에 따라 컬럼 값을 나열해야
                    한다.</p></td></tr><tr><td align="left">subquery</td><td><p>부질의 결과 반환되는 모든 ROW를 삽입한다. 구체적인 문법은 <a href="ch_sql_queries.html#sect_SELECT" title="5.1. SELECT">“5.1. SELECT”</a>를 참고한다.</p><p>부질의를 통하여 컬럼 값을
                    삽입하는 경우 부질의 결과 반환되는 ROW의 컬럼의 개수 및 순서는 값을 삽입하고자 하는 컬럼의 개수 및
                    순서와 일치해야 한다. 부질의는 임의의 테이블, 뷰를 참조할 수 있으며, 삽입 대상이 되는 테이블 또는
                    뷰를 참조할 수도 있다. 삽입 대상 테이블 또는 뷰를 참조할 때는 별칭을 통하여
                    참조한다.</p></td></tr><tr><td align="left">conditional_insert_clause</td><td>WHEN 조건절을 통하여 into_clause를 수행할지 안 할지를 판단한다. WHEN
                    조건절은 부질의의 select 리스트를 참조해야 하며, 하나의 multi_table_insert 는 최대
                    127개의 WHEN 절을 가질 수 있다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>conditional_insert_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">ALL</td><td><p>ALL을 명시했을 경우 WHEN 조건절을 만족하는 모든 into_clause를
                    수행한다.</p><p> ALL 또는 FIRST를 명시하지 않았을 경우 기본값은
                    ALL이다.</p></td></tr><tr><td align="left">FIRST</td><td>FIRST를 명시했을 경우 WHEN 조건절을 만족하는 첫 번째 into_clause 하나만
                    수행하고 나머지 into_clause는 건너뛴다.</td></tr><tr><td align="left">WHEN condition THEN</td><td>condition 부분에 조건을 명시한다. 조건을 만족할 경우 into_clause를
                    수행한다.</td></tr><tr><td align="left">into_clause</td><td>특정 컬럼에만 ROW를 삽입하고자 할 때 사용한다.</td></tr><tr><td align="left">values_clause</td><td><p>삽입되는 ROW의 컬럼 값을 지정한다.</p><p>삽입할 컬럼 값의
                    나열 순서는 값을 삽입하고자 하는 컬럼과 같은 순서가 되어야 한다. 값을 삽입할 컬럼을 나열한 경우 같은
                    순서로 컬럼 값을 나열해야 하고, 값을 삽입할 컬럼을 나열하지 않은 경우 테이블 내에 정의된 컬럼 순서에
                    따라 컬럼 값을 나열해야 한다.</p></td></tr><tr><td align="left">ELSE</td><td>어느 WHEN 조건절도 만족하지 못했다면 ELSE 절 뒤에 나온 into_clause를
                    수행한다. ELSE 절이 없을 경우에는 아무 일도 하지 않는다.</td></tr></tbody></table>
            </div>
          </li></ul></div>
      </li><li>
        <p>예제</p>

        <p>다음은 <span><strong class="guibutton">INSERT</strong></span>를 사용하는 예이다.</p>

        <pre class="programlisting">INSERT INTO EMP VALUES (35, 'John', 'Houston', 30000, 5);
INSERT INTO EMP (EMPNO, ENAME, DEPTNO) VALUES (35, John, 5);
INSERT INTO EMP VALUES (35, 'John', DEFAULT, 30000, NULL);</pre>

        <p/>

        <p>다음은 <span><strong class="guibutton">error logging
        </strong></span>절을 사용하는 예이다.</p>

        <pre class="programlisting">SQL&gt; create table p (a number primary key);

Table 'P' created.

SQL&gt; insert into p values (1);

1 row inserted.

SQL&gt; insert into p values (2);

1 row inserted.

SQL&gt; insert into p values (3);

1 row inserted.

SQL&gt; insert into p values (4);

1 row inserted.

SQL&gt; create table f (a number references p(a));

Table 'F' created.

SQL&gt; insert into f values (1);

1 row inserted.

SQL&gt; insert into f values (3);

1 row inserted.

SQL&gt; exec dbms_errlog.create_error_log('f');

PSM completed.

SQL&gt; commit;

Commit completed.

SQL&gt; insert into f (select 1 from dual union all select 5 from dual) log errors 
reject limit 1;

1 row inserted.

SQL&gt; select * from f;

         A
----------
         1
         3
         1

3 rows selected.

SQL&gt; select * from err$_f;

TIB_ERR_NUMBER$
---------------
TIB_ERR_MESG$
--------------------------------------------------------------------------------
TIB_ERR_ROWID$     TIB_ERR_OPTYP$
------------------ --------------------
TIB_ERR_TAG$
--------------------------------------------------------------------------------
A
--------------------------------------------------------------------------------
         -10008
 INTEGRITY constraint ('SYS'.'SYS_CON25700497') violated: primary key not found.

                   I

5

1 row selected.</pre>
      </li></ul></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="sect_UPDATE"/>8.2. UPDATE<a id="d5e31649" class="indexterm"/></h2></div></div></div>
    

    <p>UPDATE 구문은 테이블 또는 뷰 내의 ROW에 지정된 컬럼의 값을 갱신한다.</p>

    <div class="literallayout"><p/></div>

    <p>UPDATE의 세부 내용은 다음과 같다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>문법</p>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/update.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/dml_table_expression.png"/></div>

          
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/set_clause.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/where_clause.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/returning_clause.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/error_logging_clause.png"/></div>
        </div>
      </li><li>
        <p>특권</p>

        <p>UPDATE ANY TABLE 시스템 특권을 가지고 있으면 사용자는 모든 테이블과 모든 뷰를 갱신할 수 있다.
        테이블을 갱신하기 위해서는 테이블을 사용자가 소유하고 있거나, 그 테이블에 대해 UPDATE 스키마 오브젝트 특권을 가지고
        있어야 한다.</p>

        <p>뷰의 기반 테이블을 갱신하기 위해서는 다음의 두 가지 조건을 동시에 만족해야 한다.</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>사용자가 뷰를 가지고 있거나 뷰에 대한 UPDATE 스키마 오브젝트 특권이 있어야 한다.</p>
          </li><li>
            <p>뷰가 속한 스키마의 사용자가 뷰의 기반 테이블을 가지고 있거나 기반 테이블에 대해 UPDATE 스키마
            오브젝트 특권을 가지고 있어야 한다.</p>
          </li></ul></div>
      </li><li>
        <p>구성요소</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>update</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">dml_table_expression</td><td>갱신할 테이블 객체를 명시한다.</td></tr><tr><td align="left">set_clause</td><td>set_clause를 사용해서 갱신할 컬럼의 값을 명시한다.</td></tr><tr><td align="left">where_clause</td><td>조건이 TRUE인 ROW에 대해서만 갱신을 수행하도록 지정한다. 이 절을 생략하면 테이블
                    또는 뷰의 모든 ROW에 대해 갱신을 수행한다.</td></tr><tr><td align="left">returning_clause</td><td>returning_clause를 사용해 갱신이 일어난 결과 ROW의 값을 반환 받을 수
                    있다. 갱신이 일어난 ROW로부터 연산식의 값을 계산해 그 결과를 호스트 변수 또는 <span>tbPSM</span> 변수에 저장한다.</td></tr><tr><td align="left">error_logging_clause</td><td>에러가 발생할 경우 수행을 중단하지 않고 에러 내용과 삽입하려던 데이터를 에러 로깅
                    테이블(Error logging table)에 저장한 후 다음 ROW에 대해서 진행한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>dml_table_expression</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">schema</td><td>갱신할 객체가 속해 있는 스키마를 명시한다. 생략하면 현재 사용자의 스키마에서 객체를
                    찾는다.</td></tr><tr><td align="left"><p>table</p><p>view</p><p>subquery</p></td><td><p>테이블이나 뷰의 이름 또는 갱신할 컬럼을 가지고 있는 부질의를 명시한다.
                    <span>테이블에 UPDATE를 수행하면 테이블에 연결된
                    UPDATE 트리거가 동작한다. </span>뷰를 명시할 경우 뷰의 기반 테이블이 갱신된다. 뷰를
                    갱신하려면 뷰가 갱신 가능한 뷰여야 한다. 예를 들어 뷰의 정의에 다음이 포함되어 있으면 그 뷰는 갱신
                    가능한 뷰가 아니다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                          <p>집합 연산자</p>
                        </li><li style="list-style-type: circle">
                          <p>DISTINCT 연산자</p>
                        </li><li style="list-style-type: circle">
                          <p>집단 함수<span> 또는 분석
                          함수</span></p>
                        </li><li style="list-style-type: circle">
                          <p>GROUP BY 또는 CONNECT BY 절</p>
                        </li><li style="list-style-type: circle">
                          <p>WITH READ ONLY</p>
                        </li></ul></div></td></tr><tr><td align="left">dblink</td><td><p>데이터베이스 링크의 이름 전체 또는 부분을 명시한다. 데이터베이스 링크를 명시할
                    때는 반드시 앞에 '@'를 붙여야만 한다.</p><p>데이터베이스 링크에는 다음과 같은
                    제약조건이 있다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                          <p>원격 테이블에서는 <span>Tibero</span>에서 지원하지
                          않는 사용자정의 타입 또는 REF 객체에 대한 질의를 할 수 없다.</p>
                        </li><li style="list-style-type: circle">
                          <p>원격 테이블에서는 <span>Tibero</span>에서 지원하지
                          않는 ANYTYPE, ANYDATA 또는 ANYDATASET 타입의 컬럼에 대한 질의를 할 수
                          없다.</p>
                        </li></ul></div></td></tr><tr><td align="left">PARTITION (partition)</td><td>테이블이 분할 테이블인 경우 파티션명을 명시할 수 있다. 이를 사용하면 데이터베이스 성능
                    향상에 도움이 된다.</td></tr><tr><td align="left">WITH CHECK OPTION</td><td>갱신의 결과를 부질의가 SELECT할 수 없으면 갱신이 허용되지 않도록 한다.</td></tr><tr><td align="left">alias</td><td>테이블, 뷰, 부질의가 UPDATE 문의 다른 곳에서 참조될 수 있도록 별칭을
                    지정한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>set_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">column</td><td><p>갱신할 컬럼의 이름을 명시한다. 명시하지 않은 컬럼의 값은 바뀌지
                    않는다.</p><p>대용량 객체형 컬럼을 명시할
                    경우 컬럼이 분할 테이블의 분할 키 정의에 참여하고 있을 때는 UPDATE의 결과로 인해 현재 ROW가
                    참여하고 있는 파티션에 이 ROW가 계속 참여할 수 없을 때는 UPDATE가
                    실패한다.</p></td></tr><tr><td align="left">subquery</td><td><p>최대 1개의 ROW를 반환하는 스칼라 서브쿼리 (scalar subquery)를
                    명시한다. 여러 ROW가 반환되면 UPDATE가
                    실패한다.</p><p>update_set_clause에서 하나의 컬럼을 명시했을 경우는
                    부질의도 SELECT 리스트를 통해 하나의 값만 반환해 주어야 한다. update_set_clause에서
                    여러 개의 컬럼을 명시했을 경우는 부질의가 SELECT 리스트를 통해 반환하는 값의 개수와 컬럼의 개수가
                    일치하여야 한다.</p><p>부질의가 ROW를 반환하지 못했을 경우 컬럼에 갱신되는 값은
                    NULL이다.</p></td></tr><tr><td align="left">expr</td><td>컬럼에 갱신할 새 값을 명시하는 연산식이다. 자세한 내용은 <a href="ch_sql_expressions.html#sect_expressions" title="3.3. 연산식">“3.3. 연산식”</a>을 참고한다.</td></tr><tr><td align="left">DEFAULT</td><td><p>컬럼에 기본값이 지정된 경우 그 값을 갱신할 값으로 지정한다.
                    </p><p>기본값이 없는데 명시했을 경우는 NULL로 갱신된다. 뷰를 갱신할 때는
                    DEFAULT를 명시할 수 없다.</p></td></tr></tbody></table>
            </div>
          </li><li>
            <p>where_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">condition</td><td>WHERE 예약어 뒤에 조건식을 명시한다. 조건식이 TRUE인 ROW만 갱신 하도록
                    지정한다. 갱신의 대상이 되는 ROW를 기반으로 condition 값을 계산하며, 부질의를 포함할 수
                    있다. where_clause를 생략하면 테이블 또는 뷰의 모든 ROW를 갱신한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>returning_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">expr</td><td>결과 ROW로부터 returning_clause 절을 통해 반환할 값을 계산하는 연산식이다.
                    자세한 내용은 <a href="ch_sql_expressions.html#sect_expressions" title="3.3. 연산식">“3.3. 연산식”</a>을 참고한다.</td></tr><tr><td align="left">data_item</td><td>ROW로부터 계산한 expr 값을 저장할 호스트 변수 또는 <span>tbPSM</span> 변수에 저장한다.</td></tr></tbody></table>
            </div>

            <p>returning_clause에는 다음과 같은 제약조건이 있다.</p>

            <div class="itemizedlist"><ul type="square" compact="compact"><li>
                <p>expr은 단순 연산식 또는 단독으로 사용된 단일 그룹 집단 함수(GROUP BY 절이 없음)만
                가능하다.</p>
              </li><li>
                <p>하나의 returning_clause에 단순 연산식과 단일 그룹 집단 함수가 같이 나올 수는
                없다.</p>
              </li><li>
                <p>단일 그룹 집단 함수 내에 예약어 DISTINCT를 사용할 수도 없다.</p>
              </li><li>
                <p>LONG 타입의 값을 returning_clause를 통해 받을 수 없다.</p>
              </li></ul></div>
          </li></ul></div>
      </li><li>
        <p>예제</p>

        <p>다음은 <span><strong class="guibutton">UPDATE</strong></span>를 사용하는 예이다.</p>

        <pre class="programlisting">UPDATE EMP SET SALARY = 35000;
UPDATE EMP SET SALARY = 35000 WHERE DEPTNO = 5;
UPDATE EMP SET DEPTNO = DEFAULT WHERE DEPTNO IS NULL;
UPDATE EMP
SET SALARY = SALARY * 1.05,
ADDR = (SELECT LOC FROM DEPT WHERE DEPTNO = 5)
WHERE DEPTNO = 5;</pre>
      </li></ul></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="sect_DELETE"/>8.3. DELETE<a id="d5e31863" class="indexterm"/></h2></div></div></div>
    

    <p>DELETE 구문은 테이블이나 뷰에서 ROW를 삭제한다. 뷰의 경우(가능할 때만) ROW가 삭제될 기반 테이블이 하나로
    정해진다. <span>테이블은 파티션으로 분할되어 있을 수
    있다.</span></p>

    <div class="literallayout"><p/></div>

    <p>DELETE의 세부 내용은 다음과 같다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>문법</p><div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/delete.png"/></div>
          </div><p> </p><div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/dml_table_expression.png"/></div>

            
          </div><p> </p><div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/where_clause.png"/></div>
          </div><p> </p><div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/returning_clause.png"/></div>
          </div><div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/error_logging_clause.png"/></div>
          </div>
      </li><li>
        <p>특권</p>

        <p>DELETE ANY TABLE 시스템 특권을 가진 사용자는 모든 테이블과 모든 뷰에서 ROW를 삭제할 수 있다.
        테이블에서 ROW를 삭제하기 위해서는 테이블을 사용자가 소유하고 있거나, 그 테이블에 대해 DELETE 스키마 오브젝트 특권을
        가지고 있어야 한다.</p>

        <p>뷰의 기반 테이블에서 ROW를 삭제하기 위해서는 다음의 두 가지 조건을 동시에 만족해야 한다.</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>사용자가 뷰를 가지고 있거나 뷰에 대한 DELETE 스키마 오브젝트 특권이 있어야 한다.</p>
          </li><li>
            <p>뷰가 속한 스키마의 사용자가 뷰의 기반 테이블을 가지고 있거나 기반 테이블에 대해 DELETE 스키마
            오브젝트 특권을 가지고 있어야 한다.</p>
          </li></ul></div>
      </li><li>
        <p>구성요소</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>delete</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">dml_table_expression</td><td>삭제할 테이블 객체를 명시한다.</td></tr><tr><td align="left">where_clause</td><td><p>조건이 TRUE인 ROW만 삭제하도록 지정한다.</p><p> 삭제의
                    대상이 되는 ROW를 기반으로 조건의 값을 계산하며, 부질의를 포함할 수 있다. 이 절을 생략하면 테이블
                    또는 뷰의 기반 테이블의 모든 ROW를 삭제한다. 자세한 내용은 <a href="ch_sql_expressions.html#sect_conditions" title="3.4. 조건식">“3.4. 조건식”</a>을 참고한다.</p></td></tr><tr><td align="left">returning_clause</td><td>returning_clause를 사용하면 삭제해서 없어져 버린 ROW의 값을 반환 받을 수
                    있다. 삭제된 ROW로부터 연산식의 값을 계산해 그 결과를 호스트 변수 또는 <span>tbPSM</span> 변수에 저장한다.</td></tr><tr><td align="left">error_logging_clause</td><td>에러가 발생할 경우 수행을 중단하지 않고 에러 내용과 삽입하려던 데이터를 에러 로깅
                    테이블(Error logging table)에 저장한 후 다음 ROW에 대해서 진행한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>dml_table_expression</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">schema</td><td>테이블이나 뷰가 속해 있는 스키마를 명시한다. 생략하면 현재 사용자의 스키마에서 객체를
                    찾는다.</td></tr><tr><td align="left"><p>table</p><p>view</p><p>subquery</p></td><td><p>테이블이나 뷰의 이름 또는 삭제할 ROW를 포함하는 ROW 집합을 SELECT하는
                    부질의를 명시한다. 테이블에 DELETE를 수행하면 테이블에 연결된 DELETE 트리거가
                    동작한다.</p><p>뷰를 명시할 경우 뷰의 기반 테이블에서 ROW가 삭제된다. 뷰에서
                    ROW를 삭제하려면 뷰가 갱신 가능한 뷰여야 한다. 예를 들어 뷰의 정의에 다음이 포함되어 있으면 그
                    뷰는 갱신 가능한 뷰가 아니다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                          <p>집합 연산자</p>
                        </li><li style="list-style-type: circle">
                          <p>DISTINCT 연산자</p>
                        </li><li style="list-style-type: circle">
                          <p>집단 함수 <span>또는 분석
                          함수</span></p>
                        </li><li style="list-style-type: circle">
                          <p>GROUP BY 또는 CONNECT BY 절</p>
                        </li><li style="list-style-type: circle">
                          <p>WITH READ ONLY</p>
                        </li></ul></div><p>ROW를 삭제한 후에도 테이블이나 인덱스에서 그 ROW가
                    차지하고 있었던 공간은 그대로 유지된다.</p></td></tr><tr><td align="left">PARTITION (partition)</td><td>테이블이 분할 테이블인 경우 파티션명을 명시할 수 있다. 이를 사용하면 데이터베이스 성능
                    향상에 도움이 된다.</td></tr><tr><td align="left">dblink</td><td><p>데이터베이스 링크의 이름 전체 또는 부분을 명시한다. 데이터베이스 링크를 명시할
                    때는 반드시 앞에 '@'를 붙여야만 한다.</p><p>데이터베이스 링크에는 다음과 같은
                    제약조건이 있다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                          <p>원격 테이블에서는 <span>Tibero</span>에서 지원하지 않는
                          사용자정의 타입 또는 REF 객체에 대한 질의를 할 수 없다.</p>
                        </li><li style="list-style-type: circle">
                          <p>원격 테이블에서는 <span>Tibero</span>에서 지원하지 않는
                          ANYTYPE, ANYDATA 또는 ANYDATASET 타입의 컬럼에 대한 질의를 할 수
                          없다.</p>
                        </li></ul></div></td></tr><tr><td align="left">subquery_restriction_clause</td><td>예약어 WITH READ ONLY가 명시되어 있으면 삭제할 수 없다. WITH CHECK
                    OPTION은 무시된다.</td></tr><tr><td align="left">alias</td><td>테이블, 뷰, 부질의가 DELETE 문의 다른 곳에서 참조될 수 있도록 별칭을
                    지정한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>where_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">condition</td><td>WHERE 예약어 뒤에 조건식을 명시한다. 조건식이 TRUE인 ROW만 제거하도록 지정한다.
                    제거의 대상이 되는 ROW를 기반으로 condition 값을 계산하며, 부질의를 포함할 수 있다.
                    where_clause를 생략하면 테이블 또는 뷰의 모든 ROW를 제거한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>returning_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">expr</td><td>결과 ROW로부터 returning_clause 절을 사용해 반환할 값을 계산할 때 사용하는
                    연산식이다. 자세한 내용은 <a href="ch_sql_expressions.html#sect_expressions" title="3.3. 연산식">“3.3. 연산식”</a>을
                    참고한다.</td></tr><tr><td align="left">data_item</td><td>ROW로부터 계산된 expr 값을 호스트 변수 또는 <span>tbPSM</span> 변수에 저장한다.</td></tr></tbody></table>
            </div>

            <p>returning_clause에는 다음과 같은 제약조건이 있다.</p>

            <div class="itemizedlist"><ul type="square" compact="compact"><li>
                <p>expr은 단순 연산식 또는 단독으로 사용된 단일 그룹 집단 함수(GROUP BY 절이 없음)만
                가능하다.</p>
              </li><li>
                <p>하나의 returning_clause에 단순 연산식과 단일 그룹 집단 함수가 같이 나올 수는
                없다.</p>
              </li><li>
                <p>단일 그룹 집단 함수 내에 예약어 DISTINCT를 사용할 수도 없다.</p>
              </li><li>
                <p>LONG 타입의 값을 returning_clause를 통해 받을 수 없다.</p>
              </li></ul></div>
          </li></ul></div>
      </li><li>
        <p>예제</p>

        <p>다음은 <span><strong class="guibutton">DELETE</strong></span>를 사용하는 예이다.</p>

        <pre class="programlisting">DELETE FROM EMP;
DELETE FROM John.EMP WHERE SALARY &lt; 20000 </pre>
      </li></ul></div>

    <p/>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="sect_CALL"/>8.4. CALL<a id="d5e32044" class="indexterm"/></h2></div></div></div>
    

    <p>CALL 구문은 단독으로 정의되거나 패키지 내에 정의된 프러시저나 함수를 실행한다.</p>

    <div class="literallayout"><p/></div>

    <p>CALL의 세부 내용은 다음과 같다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>문법</p>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/call.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/routine_clause.png"/></div>
        </div>
      </li><li>
        <p>특권</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>단독으로 정의된 프러시저나 함수를 실행하려면 그 프러시저나 함수에 대한 EXECUTE 스키마 오브젝트 특권을
            가지고 있어야 한다.</p>
          </li><li>
            <p>프러시저나 함수가 패키지 내에 정의된 경우에는 패키지에 대한 EXECUTE 특권을 가지고 있어야
            한다.</p>
          </li><li>
            <p>또한 EXECUTE ANY PROCEDURE 시스템 특권이 있으면 어떤 프러시저나 함수라도 실행할 수
            있다.</p>
          </li></ul></div>
      </li><li>
        <p>구성요소</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>call</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">routine_clause</td><td>단독으로 정의된 프러시저나 함수가 속해있는 스키마, 프러시저나 함수의 이름 등 세부내용을
                    명시한다.</td></tr><tr><td align="left">INTO</td><td>함수를 실행하는 경우에만 INTO 절을 명시해야 한다.</td></tr><tr><td align="left">:host_variable</td><td>반환 값을 저장할 호스트 변수를 명시한다.</td></tr><tr><td align="left">:indicator_variable</td><td>호스트 변수의 값 또는 상태를 표시하기 위한 지시자 변수를 명시한다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>routine_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">schema</td><td>단독으로 정의된 프러시저나 함수가 속해 있는 스키마를 명시한다. 또는 프러시저나 함수를
                    포함하는 패키지가 속해 있는 스키마를 명시한다.</td></tr><tr><td align="left">package</td><td>프러시저나 함수를 포함하는 패키지를 명시한다.</td></tr><tr><td align="left">function</td><td>실행하고자 하는 함수의 이름을 명시한다.</td></tr><tr><td align="left">procedure</td><td>실행하고자 하는 프러시저의 이름을 명시한다.</td></tr><tr><td align="left">argument</td><td><p>프러시저나 함수가 파라미터를 받는 경우에는 파라미터를
                    명시한다.</p><p>argument에는 다음과 같은 제약조건이
                    있다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                          <p>파라미터에는 의사 컬럼을 사용할 수 없다.</p>
                        </li><li style="list-style-type: circle">
                          <p>IN OUT 또는 OUT으로 명시된 파라미터는 대응하는 호스트 변수가 있어야
                          한다.</p>
                        </li><li style="list-style-type: circle">
                          <p>파라미터의 수는 반환 값을 포함하여 1000개까지 사용할 수 있다.</p>
                        </li><li style="list-style-type: circle">
                          <p>4KB 이상의 크기를 가지는 문자열 또는 RAW, LONG RAW 데이터를
                          파라미터로 사용할 수 없다.</p>
                        </li></ul></div></td></tr></tbody></table>
            </div>
          </li></ul></div>
      </li><li>
        <p>예제</p>

        <p>다음은 <span><strong class="guibutton">CALL</strong></span>을 사용하는 예이다.</p>

        <pre class="programlisting">CALL get_board_name (30);</pre>
      </li></ul></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="sect_MERGE"/>8.5. MERGE<a id="d5e32141" class="indexterm"/></h2></div></div></div>
    

    <p>MERGE 구문은 하나, 또는 그 이상의 원본(Source) 데이터로부터 ROW를 선택하여 테이블에 삽입 또는 갱신 작업을
    수행한다. 삽입, 갱신 작업 중 어느 작업을 수행할 것인지를 결정하는 조건을 명시할 수 있다.</p>

    <p>MERGE는 여러 작업을 통합할 수 있는 편리한 방법이다. MERGE를 수행함으로써 여러 삽입, 갱신, 삭제 작업을
    수행하여야 하는 수고를 덜 수 있다. 하나의 MERGE 문에서 같은 ROW를 여러 번 갱신할 수 없다.</p>

    <div class="literallayout"><p/></div>

    <p>MERGE의 세부 내용은 다음과 같다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>문법</p>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/merge.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/merge_update_clause.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/merge_insert_clause.png"/></div>
        </div>

        <div class="informalfigure">
          <div xmlns="" class="mediaobject"><img src="resources/where_clause.png"/></div>
        </div>
      </li><li>
        <p>특권</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>MERGE를 수행하기 위해서는 대상(Target) 데이터에 대한 INSERT 스키마 오브젝트 특권과
            UPDATE 스키마 오브젝트 특권을 가지고 있어야 하며, 원본 데이터에 대한 SELECT 스키마 오브젝트 특권을 가지고
            있어야 한다.</p>
          </li><li>
            <p>merge_update_clause에 DELETE clause를 명시하게 위해서는 대상 데이터에 대한
            DELETE 스키마 오브젝트 특권 또한 가지고 있어야 한다.</p>
          </li></ul></div>
      </li><li>
        <p>구성요소</p>

        <div class="itemizedlist"><ul type="circle" compact="compact"><li>
            <p>merge</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">hint</td><td>힌트를 명시한다.</td></tr><tr><td align="left">INTO</td><td>데이터를 삽입 또는 갱신할 테이블을 지정한다.</td></tr><tr><td align="left">schema</td><td>스키마의 이름을 명시한다.</td></tr><tr><td align="left">alias</td><td>별칭을 명시한다.</td></tr><tr><td align="left">USING</td><td>삽입 또는 갱신할 원본 데이터를 명시하기 위해 USING 절을 사용한다. 원본 데이터로는
                    테이블, 뷰, 또는 부질의의 결과가 사용될 수 있다.</td></tr><tr><td align="left">table, view, subquery</td><td>원본 데이터로 사용될 테이블, 뷰, 부질의를 명시한다.</td></tr><tr><td align="left">ON (condition)</td><td><p>MERGE작업이 수행될 조건을 명시하기 위해 ON 절을 사용한다.
                    condition 부분에 조건식을 명시한다.</p><p>대상 데이터의 테이블의 각 ROW에
                    대하여 조건이 TRUE일 경우 원본 데이터의 테이블의 대응하는 데이터로 ROW를 갱신한다. 모든 ROW에
                    대하여 조건이 FAULSE일 경우 대응하는 원본 데이터 테이블의 ROW를 대상 데이터 테이블에
                    삽입한다.</p></td></tr><tr><td align="left">merge_update_clause</td><td><p>merge_update_clause는 대상 데이터 테이블의 새 컬럼 값을
                    명시한다. </p><p>ON 절이 참일 경우 이 갱신을 수행한다. 갱신이 실행되면 대상 데이터
                    테이블에 설정된 모든 갱신 트리거가 작동된다.
                    </p><p>merge_update_clause는 단독으로 명시될 수도 있고
                    merge_insert_clause와 같이 명시될 수도 있다. 만약 두 가지 모두 명시될 경우 순서는
                    상관 없다. merge_update_clause를 먼저 명시해도 되고,
                    merge_insert_clause를 먼저 명시해도 된다. merge_update_clause는 ON
                    절에서 참조된 컬럼은 갱신할 수 없다는 제약이 있다.</p></td></tr><tr><td align="left">merge_insert_clause</td><td><p>merge_insert_clause는 ON 절의 조건이 거짓일 경우 대상 데이터
                    테이블에 삽입될 값을 명시한다.</p><p>삽입이 실행되면 대상 데이터 테이블에 정의된 모든
                    삽입 트리거가 작동된다. 모든 원본 데이터의 ROW를 테이블에 삽입하기 위해서 ON 절 조건에 0=1과
                    같이 항상 거짓으로 평가되는 필터를 사용하면 된다. 이러한 방법은 merge_update_clause를
                    생략하는 것과는 다르다. merge_update_clause를 생략하는 경우에 데이터베이스는 조인을
                    수행하지만 필터를 사용할 경우에 데이터베이스는 조인을 하지 않고 무조건 삽입을
                    수행한다.</p><p>merge_insert_clause는 단독으로 명시될 수도 있고
                    merge_update_clause 와 같이 명시될 수도 있다. 두 가지 모두 명시될 경우 순서는 상관
                    없다.</p></td></tr></tbody></table>
            </div>
          </li><li>
            <p>merge_update_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">column</td><td>갱신을 수행할 컬럼의 이름을 명시한다.</td></tr><tr><td align="left">expr</td><td>컬럼의 값을 갱신하는 데 사용될 임의의 연산식이다.</td></tr><tr><td align="left">DEFAULT</td><td>컬럼이 값을 기본값으로 갱신할 때 사용된다.</td></tr><tr><td align="left">where_clause</td><td><p>갱신 조건의 설정을 위해서 where_clause를 명시한다.
                    </p><p>원본 데이터에 대한 조건과 대상 데이터에 대한 조건 모두 명시될 수
                    있다.</p></td></tr><tr><td align="left">DELETE where_clause</td><td>갱신 중 데이터를 삭제하기 위해서 DELETE where_clause를 명시한다.
                    DELETE where_clause에 의해 삭제되는 ROW는 갱신에 의해 영향을 받은 ROW 뿐이다.
                    ROW가 삭제되면 설정된 모든 삭제 트리거가 작동된다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>merge_insert_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">column</td><td>삽입을 수행할 컬럼의 이름을 명시한다. 이 부분을 생략하면, 대상 데이터 테이블의 컬럼의
                    수는 VALUES 절에 명시된 값의 수와 일치하여야 한다.</td></tr><tr><td align="left">expr</td><td>컬럼의 값을 삽입하는 데 사용될 임의의 연산식이다.</td></tr><tr><td align="left">DEFAULT</td><td>컬럼이 값을 기본값으로 삽입할 때 사용된다.</td></tr><tr><td align="left">where_clause</td><td>특정 조건을 만족시키는 ROW만을 삽입하고자 할 때에는 where_clause를 명시한다.
                    이 조건은 원본 데이터의 테이블의 값만을 참조할 수 있다.</td></tr></tbody></table>
            </div>
          </li><li>
            <p>where_clause</p>

            <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">condition</td><td>갱신 조건이나 삽입 조건을 설정하기 위해서 where_clause를 명시한다.
                    condition에는 조건식을 명시한다.</td></tr></tbody></table>
            </div>
          </li></ul></div>
      </li><li>
        <p>예제</p>

        <p>다음은 <span><strong class="guibutton">MERGE</strong></span>를 사용하는 예이다.</p>

        <pre class="programlisting">MERGE INTO BONUS USING PERSONNEL
ON (B.PNUM = PERSONNEL.PNUM)
WHEN MATCHED THEN UPDATE SET BONUS.BONUS = BONUS.BONUS*1.5
DELETE WHERE (PERSONNEL.SALARY &gt; 3000)
WHEN NOT MATCHED THEN INSERT VALUES (PERSONNEL.PNUM, PERSONNEL.SALARY*0.2);</pre>
      </li></ul></div>

    <p/>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="sect_parallel_dml"/>8.6. 병렬 DML</h2></div></div></div>
    

    <p><span>Tibero</span>는 다음의 DML 문장을 병렬로 수행할 수 있다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>INSERT INTO SELECT</p>

        <p>병렬 DML도 병렬 질의와 마찬가지로 PARALLEL 힌트를 지정하여 사용할 수 있다. INSERT INTO
        SELECT 문장은 PARALLEL 힌트의 위치에 따라 어느 부분을 병렬화할 것인지 지정할 수 있다. SELECT 뒤에만
        힌트를 주면 SELECT하는 부분만 병렬화되고 INSERT 뒤에만 힌트를 주면 실제 INSERT하는 작업만 병렬화하게 된다.
        따라서 두 작업 모두 병렬화하기 위해서는 INSERT, SELECT 뒤에 모두 힌트를 주어야 한다.</p>
      </li><li>
        <p>UPDATE</p>
      </li><li>
        <p>DELETE</p>
      </li></ul></div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e32309"/>8.6.1. 수행 방법</h3></div></div></div>
      

      <p>DML을 병렬로 수행하기 위해서는 우선 다음과 같이 세션에 병렬 DML의 실행 여부를 설정해 주어야 한다.</p>

      <pre class="programlisting">SQL&gt; ALTER SESSION ENABLE PARALLEL DML;
Session altered.</pre>

      <p>위의 예에서처럼 ALTER SESSION 문장으로 세션의 속성을 변경시키지 않으면 PARALLEL 힌트는 동작하지 않고
      병렬 DML은 수행되지 않는다.</p><div class="literallayout"><p/></div><p>다음은 트랜잭션이 수행되는 중에 병렬
      DML을 수행했을 때 발생하는 에러이다.</p><pre class="programlisting">SQL&gt; INSERT INTO TEMP_TBL VALUES (1, 1);
1 row inserted.

SQL&gt; ALTER SESSION ENABLE PARALLEL DML;
TBR-12064: Unable to alter the session PDML state within a transaction</pre><p>트랜잭션이
      수행되는 중에는 COMMIT 또는 ROLLBACK 명령어로 현재 트랜잭션의 수행을 종료해야만, ALTER SESSION 문장을
      수행할 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>병렬 DML을 수행할 때 트랜잭션과 관련해 다음 두 가지 제약조건이 있으며, 이러한 제약이 있는 것은 트랜잭션의
      정합성을 보장하기 위해서이다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>병렬 DML을 수행한 트랜잭션에서는 병렬 DML로 수정한 테이블에 어떠한 접근도 할 수 없다.</p>
        </li><li>
          <p>같은 트랜잭션 내에서 수정한 테이블에 대해 병렬 DML로 접근하려 할 경우에도 병렬 DML을 수행할 수
          없다.</p>
        </li></ul></div>

      <p>다음은 병렬 DML을 수행한 트랜잭션에서는 병렬 DML로 수정한 테이블에 접근하는 경우 에러가 발생하는
      예이다.</p>

      <pre class="programlisting">SQL&gt; ALTER SESSION ENABLE PARALLEL DML;
Session altered.

SQL&gt; INSERT /*+ parallel (3) */ INTO TEMP_TBL2 SELECT /*+ parallel (3) */ * FROM
     TEMP_TBL;
100000 rows inserted.

SQL&gt; SELECT COUNT(*) FROM TEMP_TBL2;
TBR-12063: Unable to read or modify an object after modifying it in parallel</pre>

      <div class="literallayout"><p/></div>

      <p>다음은 같은 트랜잭션에서 수정한 테이블에 대해 병렬 DML로 접근할 경우에 에러가 발생하는 예이다.</p>

      <pre class="programlisting">SQL&gt; ALTER SESSION ENABLE PARALLEL DML;
Session altered.

SQL&gt; INSERT INTO TEMP_TBL2 VALUES (1, 1);
1 row inserted.

SQL&gt; INSERT /*+ parallel (3) */ INTO TEMP_TBL2 SELECT /*+ parallel (3) */ * FROM
     TEMP_TBL;
TBR-12067: Unable to modify an object with PDML after modifying it</pre>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e32329"/>8.6.2. 제약 사항</h3></div></div></div>
      

      <p>병렬 DML은 다음 같은 경우에서는 수행되지 않는다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>삽입, 갱신, 삭제를 하려는 테이블에 트리거가 있는 경우</p>
        </li><li>
          <p>returning_clause가 있는 경우</p>
        </li><li>
          <p>대상 테이블에 대용량 객체형 컬럼이 있는 경우</p>
        </li><li>
          <p>대상 테이블의 인덱스가 online-rebuild를 수행 중인 경우</p>
        </li><li>
          <p>standby replication을 사용 중인 경우</p>
        </li><li>
          <p>self-referential integrity, delete cascade, deferred integrity
          등이 있는 경우</p>
        </li><li>
          <p>분산 트랜잭션을 사용하는 경우</p>
        </li><li>
          <p>DDL, TCS, SCS를 사용하는 경우</p>
        </li></ul></div>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch_ddl.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch_transaction_and_session_management.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제7장 데이터 정의어 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제9장 트랜잭션 및 세션 관리 언어</td></tr></table></div><div xmlns="" align="center"/></body></html>