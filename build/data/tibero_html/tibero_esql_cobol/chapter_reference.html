<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제5장 tbESQL/COBOL 문장</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero tbESQL/COBOL 안내서"/><link rel="up" href="index.html" title="Tibero tbESQL/COBOL 안내서"/><link rel="prev" href="chapter_array_variable.html" title="제4장 배열 변수"/><link rel="next" href="chapter_precompiler_option.html" title="제6장 tbESQL/COBOL 프리컴파일러 옵션"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제5장 <span xmlns="http://www.w3.org/1999/xhtml">tbESQL</span>/COBOL 문장</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chapter_array_variable.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="chapter_precompiler_option.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="chapter_reference"/>제5장 <span>tbESQL</span>/COBOL 문장</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="chapter_reference.html#d5e2274">5.1. 개요</a></span></dt><dt><span class="section"><a href="chapter_reference.html#d5e2303">5.2. <span>tbESQL</span>/COBOL 문장 문법</a></span></dt><dt><span class="section"><a href="chapter_reference.html#d5e2374">5.3. <span>tbESQL</span>/COBOL 문장 공통 문법</a></span></dt><dd><dl><dt><span class="section"><a href="chapter_reference.html#sect_at_clause">5.3.1. AT 절</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_for_clause">5.3.2. FOR 절</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_descriptor_name">5.3.3. DESCRIPTOR 이름</a></span></dt></dl></dd><dt><span class="section"><a href="chapter_reference.html#d5e2562">5.4. <span>tbESQL</span>/COBOL 문장 목록</a></span></dt><dd><dl><dt><span class="section"><a href="chapter_reference.html#sect_ALLOCDESC">5.4.1. ALLOCATE DESCRIPTOR</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_CLOSE">5.4.2. CLOSE</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_COMMIT">5.4.3. COMMIT</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_CONNECT">5.4.4. CONNECT</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_DEALLOC_DESC">5.4.5. DEALLOCATE DESCRIPTOR</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_DECL_CSR">5.4.6. DECLARE CURSOR</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_DECL_DB">5.4.7. DECLARE DATABASE</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_DELETE">5.4.8. DELETE</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_DESCRIBE">5.4.9. DESCRIBE</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_DESCRIBE_DESC">5.4.10. DESCRIBE DESCRIPTOR</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_EXECUTE">5.4.11. EXECUTE</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_EXECUTE_DESC">5.4.12. EXECUTE DESCRIPTOR</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_EXEC_IMME">5.4.13. EXECUTE IMMEDIATE</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_FETCH">5.4.14. FETCH</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_FETCH_DESC">5.4.15. FETCH DESCRIPTOR</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_GET_DESC">5.4.16. GET DESCRIPTOR</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_INSERT">5.4.17. INSERT</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_OPEN">5.4.18. OPEN</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_PREPARE">5.4.19. PREPARE</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_ROLLBACK">5.4.20. ROLLBACK</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_SAVEPOINT">5.4.21. SAVEPOINT</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_SELECT">5.4.22. SELECT</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_SET_DESC">5.4.23. SET DESCRIPTOR</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_UPDATE">5.4.24. UPDATE</a></span></dt><dt><span class="section"><a href="chapter_reference.html#sect_WHENEVER">5.4.25. WHENEVER</a></span></dt></dl></dd></dl></div>
  

  <p>본 장에서는 <span>tbESQL</span>/COBOL 프로그램에서 데이터베이스 처리를 위해 사용하는 <span>tbESQL</span>/COBOL 문장을 설명한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e2274"/>5.1. 개요</h2></div></div></div>
    

    <p><span>tbESQL</span>/COBOL 프로그램은 COBOL 언어의 소스 코드와 <span>tbESQL</span>/COBOL 문장이 혼합되어 있다. <span><strong class="guibutton"><span>tbESQL</span>/COBOL 문장</strong></span>(<span>tbESQL</span>/COBOL Statement)은 <span>tbESQL</span>/COBOL 프로그램 내에서 SQL 질의, 로우의 삽입과 갱신, 제거 등과
    같은 데이터베이스와 관련된 처리를 하는 문장을 말한다.<a id="d5e2283" class="indexterm"/></p>

    <div class="literallayout"><p/></div>

    <p><span>tbESQL</span>/COBOL 문장은 크게 다음과 같이 두 가지로 구성된다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p><span><strong class="guibutton">실행 문장</strong></span>(Executable Statements)<a id="d5e2293" class="indexterm"/></p>

        <p>실행 문장은 말 그대로 데이터베이스에 어떠한 동작을 실행하기 위한 문장이다.</p>
      </li><li>
        <p><span><strong class="guibutton">지시어</strong></span>(Directive)<a id="d5e2299" class="indexterm"/></p>

        <p>지시어는 <span>tbESQL</span>/COBOL 프로그램의 실행을 설정하기 위한 것으로 데이터베이스에
        대한 실행은 이루어지지 않는다.</p>
      </li></ul></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e2303"/>5.2. <span>tbESQL</span>/COBOL 문장 문법</h2></div></div></div>
    

    <p>다음은 <span>tbESQL</span>/COBOL 문장의 문법을 나타내는 그림이다.</p>

    <div class="figure"><a id="figure_tbesqlref"/><p class="title"><b>[그림 5.1] <span>tbESQL</span>/COBOL 문장 문법</b></p><div class="figure-contents">
      

      <div xmlns="" class="mediaobject"><img src="resources/esql_stmt.png" alt="tbESQL/COBOL 문장 문법"/></div>
    </div></div><br class="figure-break"/>

    <p><a href="chapter_reference.html#figure_tbesqlref" title="[그림 5.1] tbESQL/COBOL 문장 문법">[그림 5.1]</a>을 기준으로 <span>tbESQL</span>/COBOL 문장의 문법을 해석하는 방법은 다음과 같다.</p>

    <div class="informaltable">
      <table border="1"><colgroup><col width="90" align="left"/><col/></colgroup><thead><tr><th align="left">항목</th><th>설명</th></tr></thead><tbody><tr><td align="left"><span xmlns="" class="inlinemediaobject"><img src="resources/icon_esql_stmt.png"/></span></td><td><span>tbESQL</span>/COBOL 문장의 문법을 대표하는 이름은 왼쪽 위에
            나타낸다. (예: esql_stmt)</td></tr><tr><td align="left"><span xmlns="" class="inlinemediaobject"><img src="resources/icon_ellipse.png" align="center"/></span></td><td>타원 안의 포함되는 문자는 키워드(Keyword)이며, 반드시 <span>tbESQL</span>/COBOL 문장 내에 포함되어 있어야 한다. (예:
            EXEC SQL, STMT)</td></tr><tr><td align="left"><span xmlns="" class="inlinemediaobject"><img src="resources/square.png"/></span></td><td>사각형 안의 문자는 <span>tbESQL</span>/COBOL 문장에 포함된 문법의 구성요소이며, 구성요소에
            맞는 적절한 문자열로 바꾸어야 한다. (예: option, param, choice1, choice2)</td></tr><tr><td align="left"><span xmlns="" class="inlinemediaobject"><img src="resources/icon_circle.png" align="center"/></span></td><td>원 안의 문자는 <span>tbESQL</span>/COBOL 문장의 기호이며, 반드시 <span>tbESQL</span>/COBOL 문장 내에 포함되어 있어야 한다. (예:
            소괄호(( )), 콤마(,))</td></tr><tr><td align="left"><span xmlns="" class="inlinemediaobject"><img src="resources/arrow.png"/></span></td><td><p><span>tbESQL</span>/COBOL 문장을 완성하는 순서는 화살표를 따라가면
            된다.</p><p>여러 갈래로 갈라지면서 순방향으로 이동하는 화살표는 두 가지 형태로
            띈다.</p><p><a href="chapter_reference.html#figure_tbesqlref" title="[그림 5.1] tbESQL/COBOL 문장 문법">[그림 5.1]</a>에서 option은
            포함되거나 포함되지 않은 경우이며, choice1, choice2는 여러 가지 중에 하나만이 <span>tbESQL</span>/COBOL 문장에 포함되어야 하는
            경우이다.</p><p>또는 역방향으로 이동하는 화살표는 포함되지 않거나 한번 이상 포함되는 경우이다.
            <a href="chapter_reference.html#figure_tbesqlref" title="[그림 5.1] tbESQL/COBOL 문장 문법">[그림 5.1]</a>에서 콤마(,)에 해당되며, param은 반드시 한번
            이상 포함되어야 한다.</p></td></tr></tbody></table>
    </div>

    <p>다음의 <span>tbESQL</span>/COBOL 문장은 <a href="chapter_reference.html#figure_tbesqlref" title="[그림 5.1] tbESQL/COBOL 문장 문법">[그림 5.1]</a>에 따라 모두 유효한 예이다.</p>

    <pre class="programlisting">EXEC SQL STMT (param) choice1 END-EXEC.
EXEC SQL STMT option (param, param) choice1 END-EXEC.
EXEC SQL STMT (param, param) choice2 END-EXEC.</pre>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e2374"/>5.3. <span>tbESQL</span>/COBOL 문장 공통 문법</h2></div></div></div>
    

    <p>본 절에서는 <span>tbESQL</span>/COBOL 문장에서 공통적으로 자주 사용되는 부분을
    설명한다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_at_clause"/>5.3.1. AT 절<a id="d5e2381" class="indexterm"/><a id="d5e2385" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">AT 절</strong></span>은 이름이 있는 데이터베이스 연결을 사용해 <span>tbESQL</span>/COBOL 문장을 수행할 때 사용한다.</p>

      <div class="literallayout"><p/></div>

      <p>AT의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/at_clause.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">database_name</td><td><p>사용할 데이터베이스의 이름을 명시한다. 여러 개의 데이터베이스 접속을 구분하여
                  관리하고 싶을 때 database_name을 사용한다.</p><p>데이터베이스의 이름은
                  DECLARE DATABASE를 사용해 미리 선언되어 있어야 한다. 만약 선언되어 있지 않은 이름을 사용할
                  경우 에러가 발생한다.</p></td></tr><tr><td align="left">:host_variable</td><td><p>사용할 데이터베이스의 이름이 저장된 호스트 변수를 명시한다.
                  </p><p>데이터베이스의 이름은 미리 선언되어 있어야 한다.</p></td></tr></tbody></table>
          </div>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_for_clause"/>5.3.2. FOR 절<a id="d5e2423" class="indexterm"/><a id="d5e2427" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">FOR 절</strong></span>은 <span>tbESQL</span>/COBOL 문장을 반복해서 수행할 필요가 있을 때
      사용한다.</p>

      <div class="literallayout"><p/></div>

      <p>FOR 절의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/for_clause.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="170" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">integer</td><td>반복 횟수를 명시한다.</td></tr><tr><td align="left">:host_variable</td><td><p>반복 횟수가 저장된 호스트 변수를 명시한다.</p><p>호스트 변수는
                  int 등의 숫자를 저장할 수 있는 타입이면 된다.</p></td></tr></tbody></table>
          </div>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_descriptor_name"/>5.3.3. DESCRIPTOR 이름<a id="d5e2463" class="indexterm"/><a id="d5e2467" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">DESCRIPTOR 이름</strong></span>은 Dynamic SQL을 사용할 때 필요한
      DESCRIPTOR를 가리키는 이름이다.</p>

      <p>DESCRIPTOR 이름은 프리컴파일러 옵션 즉 <a href="chapter_precompiler_option.html#sect_MODE" title="6.3.15. MODE">MODE</a>,
      <a href="chapter_precompiler_option.html#sect_DYNAMIC" title="6.3.8. DYNAMIC">DYNAMIC</a>의 값에 따라 다음과 같이 사용될 수
      있다.</p>

      <div class="informaltable">
        <table border="1"><colgroup><col width="100" align="left"/><col/></colgroup><thead><tr><th align="left">옵션 값</th><th>설명</th></tr></thead><tbody><tr><td align="left">ANSI</td><td>ansi_descriptor_name이 사용된다.</td></tr><tr><td align="left">ANSI 외</td><td>normal_descriptor_name이 사용된다.</td></tr></tbody></table>
      </div>

      <div class="literallayout"><p/></div>

      <p>DESCRIPTOR 이름의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/descriptor_name.png"/></div>
          </div>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/normal_descriptor_name.png"/></div>
          </div>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/ansi_descriptor_name.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>descriptor_name</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">normal_descriptor_name</td><td>MODE가 <span>TIBERO</span>(ORACLE)일 때
                      사용한다.</td></tr><tr><td align="left">ansi_descriptor_name</td><td>MODE가 ANSI(ISO)일 때 사용한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>normal_descriptor_name</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">identifier</td><td>서술자의 이름을 정의한 식별자이다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>ansi_descriptor_name</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">:host_variable</td><td><p>서술자의 이름이 저장된 호스트 변수를 명시한다.</p><p>호스트
                      변수는 CHAR* 또는 CHAR ARRAY 타입 등의 문자열을 저장할 수 있는
                      타입이다.</p></td></tr><tr><td align="left">string literal</td><td>서술자의 이름을 작은따옴표(' ')로 감싸서 사용한다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li></ul></div>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e2562"/>5.4. <span>tbESQL</span>/COBOL 문장 목록</h2></div></div></div>
    

    <p>본 절에서는 <span>Tibero</span>에서 제공하는 <span>tbESQL</span>/COBOL 문장을 알파벳 순으로 설명한다. 단, 각 <span>tbESQL</span>/COBOL 문장의 구성요소를 설명할 때 키워드는 특별한 경우가 아니면
    설명하지 않는다.</p>

    <p>다음은 <span>tbESQL</span>/COBOL 문장을 요약한 목록이다.<a id="d5e2571" class="indexterm"/></p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>실행문장</p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left"><span>tbESQL</span>/COBOL문장</th><th>설명</th></tr></thead><tbody><tr><td align="left"><a href="chapter_reference.html#sect_ALLOCDESC" title="5.4.1. ALLOCATE DESCRIPTOR">ALLOCATE
                DESCRIPTOR</a></td><td>서술자에 메모리를 할당한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_CLOSE" title="5.4.2. CLOSE">CLOSE</a></td><td>커서를 닫고 더 이상 사용하지 않는다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_COMMIT" title="5.4.3. COMMIT">COMMIT</a></td><td>트랜잭션을 커밋한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_CONNECT" title="5.4.4. CONNECT">CONNECT</a></td><td><span>Tibero</span>의 데이터베이스에 접속한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_DEALLOC_DESC" title="5.4.5. DEALLOCATE DESCRIPTOR">DEALLOCATE
                DESCRIPTOR</a></td><td>서술자에 할당된 메모리를 해제한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_DELETE" title="5.4.8. DELETE">DELETE</a></td><td>로우를 삭제한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_EXECUTE" title="5.4.11. EXECUTE">EXECUTE</a></td><td>준비된 Dynamic SQL 문장을 실행한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_EXECUTE_DESC" title="5.4.12. EXECUTE DESCRIPTOR">EXECUTE
                DESCRIPTOR</a></td><td>준비된 Dynamic SQL 문장을 실행한다. (ANSI)</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_EXEC_IMME" title="5.4.13. EXECUTE IMMEDIATE">EXECUTE
                IMMEDIATE</a></td><td>Dynamic SQL 문장을 바로 실행한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_FETCH" title="5.4.14. FETCH">FETCH</a></td><td>커서를 이용하여 다음 로우를 읽는다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_FETCH_DESC" title="5.4.15. FETCH DESCRIPTOR">FETCH
                DESCRIPTOR</a></td><td>커서를 이용하여 다음 로우를 읽는다. (ANSI)</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_GET_DESC" title="5.4.16. GET DESCRIPTOR">GET
                DESCRIPTOR</a></td><td>지정한 서술자에서 원하는 정보를 가져온다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_INSERT" title="5.4.17. INSERT">INSERT</a></td><td>로우를 삽입한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_OPEN" title="5.4.18. OPEN">OPEN</a></td><td>커서를 열고 연관된 SQL 문장을 실행한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_PREPARE" title="5.4.19. PREPARE">PREPARE</a></td><td>Dynamic SQL 문장을 준비한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_ROLLBACK" title="5.4.20. ROLLBACK">ROLLBACK</a></td><td>트랜잭션에 롤백을 수행한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_SAVEPOINT" title="5.4.21. SAVEPOINT">SAVEPOINT</a></td><td>저장점(Savepoint)을 설정한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_SELECT" title="5.4.22. SELECT">SELECT</a></td><td>SQL 질의를 수행한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_UPDATE" title="5.4.24. UPDATE">UPDATE</a></td><td>로우를 갱신한다.</td></tr></tbody></table>
        </div>
      </li><li>
        <p>지시어</p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left"><span>tbESQL</span>/COBOL 문장</th><th>설명</th></tr></thead><tbody><tr><td align="left"><a href="chapter_reference.html#sect_DECL_CSR" title="5.4.6. DECLARE CURSOR">DECLARE
                CURSOR</a></td><td>SQL 문장과 연관된 커서를 선언한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_DECL_DB" title="5.4.7. DECLARE DATABASE">DECLARE
                DATABASE</a></td><td>새로운 데이터베이스 접속을 선언한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_DESCRIBE" title="5.4.9. DESCRIBE">DESCRIBE</a></td><td>서술자를 초기화한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_DESCRIBE_DESC" title="5.4.10. DESCRIBE DESCRIPTOR">DESCRIBE
                DESCRIPTOR</a></td><td>서술자에 호스트 변수의 정보를 저장한다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_SET_DESC" title="5.4.23. SET DESCRIPTOR">SET
                DESCRIPTOR</a></td><td>지정한 서술자에 사용자가 입력해야 할 정보를 쓴다.</td></tr><tr><td align="left"><a href="chapter_reference.html#sect_WHENEVER" title="5.4.25. WHENEVER">WHENEVER</a></td><td>에러가 발생했을 때 해당 에러에 대한 처리 방법을 지정한다.</td></tr></tbody></table>
        </div>
      </li></ul></div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_ALLOCDESC"/>5.4.1. ALLOCATE DESCRIPTOR<a id="d5e2700" class="indexterm"/><a id="d5e2704" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">ALLOCATE DESCRIPTOR</strong></span>는 서술자에 메모리를 할당할 때 사용하는
      문장이다. 단, 이 문장은 ANSI 타입의 Dynamic SQL 문장에만 사용할 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>ALLOCATE DESCRIPTOR의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/allocate_descriptor_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>allocate_descriptor_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">for_clause</td><td>반복 횟수를 지정한다. 자세한 내용은 <a href="chapter_reference.html#sect_for_clause" title="5.3.2. FOR 절">“5.3.2. FOR 절”</a>을 참고한다.</td></tr><tr><td align="left">descriptor</td><td>서술자의 이름이 저장된 호스트 변수나 문자열을 명시한다.</td></tr><tr><td align="left">WITH MAX integer</td><td>사용할 호스트 변수의 최대 개수를 지정한다. (기본값: 100)</td></tr></tbody></table>
              </div>
            </li><li>
              <p>descriptor</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">:host_variable</td><td><p>서술자의 이름이 저장된 호스트 변수를 명시한다.</p><p>호스트
                      변수는 CHAR* 또는 CHAR ARRAY 타입 등의 문자열을 저장할 수 있는
                      타입이다.</p></td></tr><tr><td align="left">string literal</td><td>서술자의 이름이 저장된 문자열을 명시한다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 ALLOCATE DESCRIPTOR를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL ALLOCATE DESSCRIPTOR 'IN-DESC' END-EXEC.

EXEC SQL ALLOCATE DESSCRIPTOR 'OUT-DESC' END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_CLOSE"/>5.4.2. CLOSE<a id="d5e2766" class="indexterm"/><a id="d5e2770" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">CLOSE</strong></span>는 커서를 닫을 때 사용하는 문장이다. 이 문장은 현재 열려 있는
      커서에만 사용할 수 있다. 커서를 닫으면 커서를 생성할 때 할당되었던 모든 시스템 리소스가 반환된다.</p>

      <div class="literallayout"><p/></div>

      <p>CLOSE의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/close_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/cursor_name.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>close_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">cursor_name</td><td>닫으려는 커서의 이름을 명시한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>cursor_name</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">identifier</td><td>커서의 이름을 정의한 식별자이다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 CLOSE를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC CLOSE EMP-CURSOR END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_COMMIT"/>5.4.3. COMMIT<a id="d5e2825" class="indexterm"/><a id="d5e2829" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">COMMIT</strong></span>은 현재 진행 중인 트랜잭션을 커밋하고 트랜잭션에 의해 갱신된 모든
      내용을 데이터베이스에 반영할 때 사용하는 문장이다.</p>

      <div class="literallayout"><p/></div>

      <p>COMMIT의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/commit_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">at_clause</td><td><p>커밋을 실행할 데이터베이스를 명시한다.</p><p>데이터베이스의 이름을
                  직접 명시할 수도 있고, 데이터베이스의 이름이 저장된 호스트 변수를 명시할 수도 있다. 자세한 내용은
                  <a href="chapter_reference.html#sect_at_clause" title="5.3.1. AT 절">“5.3.1. AT 절”</a>을 참고한다.</p></td></tr><tr><td align="left">WORK</td><td>기존 ESQL 프로그램과의 호환성을 위한 키워드이며 특별한 의미는 없다.</td></tr><tr><td align="left">RELEASE</td><td>모든 리소스를 반환하고 데이터베이스 접속을 종료한다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <p>다음은 COMMIT을 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL COMMIT END-EXEC.

EXEC SQL COMMIT WORK RELEASE END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_CONNECT"/>5.4.4. CONNECT<a id="d5e2872" class="indexterm"/><a id="d5e2876" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">CONNECT</strong></span>는 데이터베이스에 접속할 때 사용하는 문장이다. 이 문장을 사용할
      때는 사용자 이름과 패스워드를 반드시 명시해야 한다. 데이터베이스 관리자(DBA: Database Administrator, 이하
      DBA)로 접속할 수도 있다.</p>

      <div class="literallayout"><p/></div>

      <p>CONNECT의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/connect_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/user_and_passwd.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/user_passwd.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/user_id.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/passwd.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/using_clause.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>connect_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">user_and_passwd</td><td>사용자 이름과 패스워드를 명시한다.</td></tr><tr><td align="left">at_clause</td><td><p>접속할 데이터베이스를 명시한다.</p><p>데이터베이스의 이름을
                      직접 명시할 수도 있고, 데이터베이스의 이름이 저장된 호스트 변수를 명시할 수도 있다. 자세한 내용은
                      <a href="chapter_reference.html#sect_at_clause" title="5.3.1. AT 절">“5.3.1. AT 절”</a>을 참고한다.</p></td></tr><tr><td align="left">using_clause</td><td>데이터베이스의 별칭을 명시한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>user_and_passwd</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">user_password</td><td><p>사용자 이름과 패스워드를 명시한다.</p><p>사용자 이름과
                      패스워드의 중간에 슬래시(/)를 포함해 하나의 문자열로 표현한다. (예: '<span>tibero</span>/<span>tibero</span>')</p></td></tr><tr><td align="left">user_id</td><td>사용자 이름을 명시한다. 호스트 변수이며, 문자열이 직접 올 수 없다.</td></tr><tr><td align="left">passwd</td><td>패스워드를 명시한다. 호스트 변수이며, 문자열이 직접 올 수 없다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>user_passwd</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">:host_variable</td><td>사용자 이름과 패스워드를 저장하고 있는 호스트 변수이다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>user_id</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">:host_variable</td><td>사용자의 계정을 저장하고 있는 호스트 변수이다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>passwd</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">:host_variable</td><td>패스워드를 저장하고 있는 호스트 변수이다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>using_clause</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">db_alias</td><td>데이터베이스의 별칭을 명시한다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 CONNECT를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL CONNECT :USER IDENTIFIED BY :PASSWORD END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_DEALLOC_DESC"/>5.4.5. DEALLOCATE DESCRIPTOR<a id="d5e3022" class="indexterm"/><a id="d5e3026" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">DEALLOCATE DESCRIPTOR</strong></span>는 ALLOCATE DESCRIPTOR를
      사용해 할당된 서술자의 메모리를 해제할 때 사용하는 문장이다. 단, 이 문장은 ANSI 타입의 Dynamic SQL 문장에만
      사용할 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>DEALLOCATE DESCRIPTOR의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/deallocate_descriptor_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                  명시한다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는 타입으로
                  이미 선언되어 있어야 한다.</p><p>서술자는 ALLOCATE DESCRIPTOR를 통해 이미
                  할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을 참고한다.</p></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <p>다음은 DEALLOCATE DESCRIPTOR를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL DEALLOCATE DESSCRIPTOR 'IN-DESC' END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_DECL_CSR"/>5.4.6. DECLARE CURSOR<a id="d5e3064" class="indexterm"/><a id="d5e3068" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">DECLARE CURSOR</strong></span>는 커서를 선언할 때 사용하는 문장이다. 이 문장을
      사용해 스크롤 가능 커서(Scrollable Cursor)<a id="d5e3072" class="indexterm"/>를 선언할 수도 있다. 커서를 선언할 때는 커서의 이름을 반드시 명시하여야 하며, SELECT 문장과
      연관시켜야 한다.</p>

      <p>Dynamic SQL 문장에 대한 커서인 경우에는 문장 이름(Statement Name)과 연관시킨다. 이때 문장
      이름은 PREPARE를 통해 준비되어 있어야 한다.</p>

      <div class="literallayout"><p/></div>

      <p>DECLARE CURSOR의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/declare_cursor_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/cursor_specification.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>declare_cursor_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">at_clause</td><td><p>문장을 실행할 데이터베이스를 명시한다.</p><p>데이터베이스의
                      이름을 직접 명시할 수도 있고, 데이터베이스의 이름이 저장된 호스트 변수를 명시할 수도 있다. 자세한
                      내용은 <a href="chapter_reference.html#sect_at_clause" title="5.3.1. AT 절">“5.3.1. AT 절”</a>을
                      참고한다.</p></td></tr><tr><td align="left">cursor_name</td><td>커서의 이름을 명시한다.</td></tr><tr><td align="left">SCROLL</td><td>스크롤 가능 커서로 선언한다.</td></tr><tr><td align="left">cursor_specification</td><td>커서로 수행할 문장을 명시한다.</td></tr><tr><td align="left">statement_name</td><td>준비된 문장의 이름을 명시한다. 사용될 문장은 PREPARE를 통해 준비되어 있어야
                      한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>cursor_specification</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">query_expression</td><td>SELECT 문장을 명시한다. INTO 절을 포함할 수 없다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 DECLARE CURSOR를 사용한 예이다.</p>

          <pre class="programlisting">EXEC SQL DECLARE EMP-CURSOR1 CURSOR FOR
     SELECT EMPNO, ENAME, SALARY FROM EMP
END-EXEC.

EXEC SQL DECLARE EMP-CURSOR2 SCROLL CURSOR FOR
     SELECT EMPNO, ENAME, SALARY FROM EMP
END-EXEC.

EXEC SQL DECLARE DYN-CUR CURSOR FOR DYN-STMT
END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_DECL_DB"/>5.4.7. DECLARE DATABASE<a id="d5e3141" class="indexterm"/><a id="d5e3145" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">DECLARE DATABASE</strong></span>는 데이터베이스를 선언할 때 사용하는
      문장이다.</p>

      <p>여러 개의 데이터베이스 접속을 사용할 때 각각의 접속은 데이터베이스의 이름으로 관리된다. DECLARE
      DATABASE로 선언한 데이터베이스의 이름을 CONNECT 문장이나 COMMIT 문장의 RELEASE를 통해 각각을 구분하여
      관리할 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>DECLARE DATABASE의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/declare_database_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">database_name</td><td>선언할 데이터베이스 이름을 명시한다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <p>다음은 DECLARE DATABASE를 사용한 예이다.</p>

          <pre class="programlisting">EXEC SQL DECLARE D1 DATABASE END-EXEC.

EXEC SQL CONNECT :USERPASS AT D1 END-EXEC.</pre>
        </li></ul></div>

      <p/>

      <p/>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_DELETE"/>5.4.8. DELETE<a id="d5e3182" class="indexterm"/><a id="d5e3186" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">DELETE</strong></span>는 테이블 또는 뷰에서 로우를 삭제할 때 사용하는
      문장이다.</p>

      <div class="literallayout"><p/></div>

      <p>DELETE의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <p>DELETE의 문법에 대한 자세한 내용은 "<span>Tibero</span> SQL 참조 안내서"를 참고한다.</p>
        </li><li>
          <p>특권</p>

          <p>DELETE를 사용하려면, 대상이 되는 테이블 또는 뷰에 대한 DELETE 객체 특권을 갖고 있거나 DELETE
          ANY TABLE 시스템 특권을 갖고 있어야 한다.</p>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">FOR</td><td><p>입력 배열 변수와 함께 사용될 경우 FOR 절을 이용하여 DELETE를 실행할
                    입력 배열 변수의 크기를 정할 수 있다.</p><p>FOR 절이 포함되어 있지 않거나 실행할
                    배열의 크기가 입력 배열 변수의 크기보다 크면, 배열 전체에 대하여 DELETE를
                    실행한다.</p></td></tr><tr><td align="left">CURRENT OF</td><td>DELETE를 커서와 함께 사용할 수도 있다. 현재 커서가 가리키는 로우를 삭제하려면
                    WHERE 절에 CURRENT OF와 커서 이름을 포함시킨다. 이때 커서는 닫혀 있지 않아야
                    한다.</td></tr></tbody></table>
            </div>
        </li><li>
          <p>예제</p>

          <p>다음은 DELETE를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL DELETE FROM EMP END-EXEC.

EXEC SQL DELETE FROM EMP 
     WHERE EMPNO = :EMPNO
END-EXEC.
       
EXEC SQL FOR :CNT DELETE FROM EMP
     WHERE EMPNO = :EMPNO
END-EXEC.
       
EXEC SQL DELETE FROM EMP
     WHERE CURRENT OF EMP-CURSOR
END-EXEC.</pre>

          <p>위의 예에서 알 수 있듯이 DELETE 문장은 EXEC SQL로 시작하고 END-EXEC.로 끝난다는 것을
          제외하면, 일반적인 SQL 문장의 문법과 크게 다르지 않다.</p>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_DESCRIBE"/>5.4.9. DESCRIBE<a id="d5e3226" class="indexterm"/><a id="d5e3230" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">DESCRIBE</strong></span>는 호스트 변수의 서술자를 초기화할 때 사용하는 문장이다. 이
      문장에는 Dynamic SQL 문장이 사용되는데, 사용될 문장은 미리 PREPARE를 통해 준비해야 한다.</p>

      <div class="literallayout"><p/></div>

      <p>DESCRIBE의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/describe_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">BIND VARIABLES FOR</td><td>입력으로 사용되는 호스트 변수의 서술자를 초기화하고, 바인드 변수를 바인딩하기 위해 사용한다.
                  이 부분을 명시하지 않으면 SELECT LIST FOR가 디폴트이다.</td></tr><tr><td align="left">SELECT LIST FOR</td><td>SELECT 문장의 SELECT 리스트의 정보를 위한 서술자를 초기화한다. 명시하지 않을 경우
                  디폴트이다.</td></tr><tr><td align="left">statement_name</td><td>사용될 문장의 이름을 명시한다. 사용될 문장의 이름은 이미 PREPARE를 통해 준비되어 있어야
                  한다.</td></tr><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                  적는다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는 타입으로 이미
                  선언되어 있어야 한다.</p><p>서술자는 ALLOCATE DESCRIPTOR를 통해 이미
                  할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을 참고한다.</p></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <p>다음은 DESCRIBE를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL 
     PREPARE PSTMT FROM :QUERY-STR
END-EXEC.

EXEC SQL DECLARE EMP-CUR FOR
     SELECT EMPNO, ENAME, SAL, COMM FROM EMP
     WHERE DEPTNO = :DEPT-NO
END-EXEC.

EXEC SQL DESCRIBE BIND VARIABLES FOR PSTMT
     INTO BIND-DESC
END-EXEC.

EXEC SQL OPEN EMP-CUR USING BIND-DESC END-EXEC.
       
EXEC SQL DESCRIBE SELECT LIST FOR PSTMT
     INTO SELECT-DESC
END-EXEC.
       
EXEC SQL FETCH EMP-CUR
     INTO SELECT-DESC
END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_DESCRIBE_DESC"/>5.4.10. DESCRIBE DESCRIPTOR<a id="d5e3277" class="indexterm"/><a id="d5e3281" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">DESCRIBE DESCRIPTOR</strong></span>는 서술자에 호스트 변수의 정보를 저장할 때
      사용하는 문장이다. 단, 이 문장은 ANSI 타입의 Dynamic SQL 문장에만 사용할 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>DESCRIBE DESCRIPTOR의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/ansi_describe_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">INPUT</td><td><p>서술자가 입력과 출력 중에 어느 곳에 사용될지 지정한다. 생략이 가능하며 기본값은
                  INPUT이다.</p><p>사용자가 바인드 변수에 값을 직접 입력하여, <span>tbESQL</span>/COBOL 라이브러리에서 사용될 수 있도록
                  한다.</p></td></tr><tr><td align="left">OUTPUT</td><td><p>서술자가 입력과 출력 중에 어느 곳에 사용될지 지정한다. 생략이 가능하며 기본값은
                  INPUT이다.</p><p>사용자가 바인드 변수의 멤버를 통해, <span>tbESQL</span>/COBOL 라이브러리가 동작하면서 저장된 결과
                  값의 메타데이터(metadata)를 확인하고, 적합한 대응을 할 수 있도록
                  해준다.</p></td></tr><tr><td align="left">statement_name</td><td>사용될 문장의 이름을 명시한다. 사용될 문장의 이름은 이미 PREPARE를 통해 준비되어 있어야
                  한다.</td></tr><tr><td align="left">SQL</td><td>기존 ESQL 프로그램과의 호환성을 위한 키워드이며 특별한 의미는 없다.</td></tr><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                  적는다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는 타입으로 이미
                  선언되어 있어야 한다.</p><p>서술자는 ALLOCATE DESCRIPTOR를 통해 이미
                  할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을 참고한다.</p></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <p>다음은 DESCRIBE DESCRIPTOR를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL DESCRIBE INPUT S USING DESCRIPTOR 'IN-DESC' END-EXEC.

EXEC SQL DESCRIBE OUTPUT S USING DESCRIPTOR 'OUT-DESC' END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_EXECUTE"/>5.4.11. EXECUTE<a id="d5e3337" class="indexterm"/><a id="d5e3341" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">EXECUTE</strong></span>는 Dynamic SQL 문장을 실행할 때 사용하는
      문장이다.</p>

      <div class="literallayout"><p/></div>

      <p>EXECUTE의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/execute_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/using_param_clause.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>execute_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="180"/><col/></colgroup><thead><tr><th>구성요소</th><th>설명</th></tr></thead><tbody><tr><td>statement_name</td><td>실행할 문장의 이름을 명시한다. 실행할 문장의 이름은 PREPARE 문장을 통해 이미
                      준비되어 있어야 한다.</td></tr><tr><td>USING using_param_clause</td><td>USING 절을 이용하여 입력 변수를 지정한다. 또는 입력 배열 변수를 사용할 수도
                      있다.</td></tr><tr><td>psm_statement</td><td>실행할 anonymous psm block 문장의 내용을 서술한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>using_param_clause</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="180"/><col/></colgroup><thead><tr><th>구성요소</th><th>설명</th></tr></thead><tbody><tr><td>identifier</td><td>입력 변수를 정의한 식별자이다.</td></tr><tr><td>:host_variable</td><td>입력 변수를 명시한다. 입력 변수의 개수는 하나 이상이고, 준비된 문장 내에 포함된 입력
                      변수의 개수와 같아야 한다.</td></tr><tr><td>indicator</td><td>지시자 변수를 명시할 때 사용한다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 EXECUTE를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL EXECUTE SQL-STMT END-EXEC.

EXEC SQL EXECUTE SQL-STMT USING :EMPNO, :DEPTNO END-EXEC.

EXEC SQL FOR :CNT EXECUTE SQL-STMT
     USING :EMPNO INDICATOR :EMPNO-IND
END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_EXECUTE_DESC"/>5.4.12. EXECUTE DESCRIPTOR<a id="d5e3408" class="indexterm"/><a id="d5e3412" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">EXECUTE DESCRIPTOR</strong></span>는 Dynamic SQL 문장을 실행할 때
      사용하는 문장이다. 단, 이 문장은 ANSI 타입의 Dynamic SQL 문장에만 사용할 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>EXECUTE DESCRIPTOR의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/ansi_execute_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/ansi_using_and_into_clause.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p><div class="itemizedlist"><ul type="circle" compact="compact"><li>
                <p>ansi_excute_statement</p>

                <div class="informaltable">
                  <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">statement_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                        명시한다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는
                        타입으로 서술자 이름을 문자열로 가지고 있어야 한다.</p></td></tr></tbody></table>
                </div>
              </li><li>
                <p>ansi_using_and_into_clause</p>

                <div class="informaltable">
                  <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">USING</td><td>입력 호스트 변수의 정보를 가지고 있는 지시자를 사용해야 할 경우
                        명시한다.</td></tr><tr><td align="left">INTO</td><td>문장 수행 결과가 출력 값을 가지고 있을 경우 사용할 지시자를
                        명시한다.</td></tr><tr><td align="left">SQL</td><td>기존 ESQL 프로그램과의 호환성을 위한 키워드이며 특별한 의미는
                        없다.</td></tr><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                        적는다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는
                        타입으로 이미 선언되어 있어야 한다.</p><p>서술자는 ALLOCATE
                        DESCRIPTOR를 통해 이미 할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을
                        참고한다.</p></td></tr></tbody></table>
                </div>
              </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 EXECUTE DESCRIPTOR를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL EXECUTE S USING DESCRIPTOR 'input_desc'
         INTO DESCRIPTOR 'output_desc'
END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_EXEC_IMME"/>5.4.13. EXECUTE IMMEDIATE<a id="d5e3482" class="indexterm"/><a id="d5e3486" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">EXECUTE IMMEDIATE</strong></span>는 Dynamic SQL 문장을 준비하지 않고
      바로 실행할 때 사용하는 문장이다. 이 문장을 통해 실행할 SQL 문장은 입력 변수가 포함되지 않아야 한다.</p>

      <div class="literallayout"><p/></div>

      <p>EXECUTE IMMEDIATE의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/execute_immediate_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">:host_variable</td><td>실행할 Dynamic SQL 문장을 호스트 변수를 사용해 명시한다.</td></tr><tr><td align="left">string literal</td><td>실행할 문장을 문자열 리터럴을 사용해 명시한다.</td></tr><tr><td align="left">'literal'</td><td>실행할 문장을 문자열을 사용해 명시한다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <p>다음은 EXECUTE IMMEDIATE를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL EXECUTE IMMEDIATE :SQL-STMT 
END-EXEC.

EXEC SQL EXECUTE IMMEDIATE 
     Z'SELECT EMPNO, ENAME, SALARY FROM EMP'
END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_FETCH"/>5.4.14. FETCH<a id="d5e3526" class="indexterm"/><a id="d5e3530" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">FETCH</strong></span>는 커서가 현재 가리키고 있는 로우의 데이터를 읽어 올 때 사용하는
      문장이다.</p>

      <p>이 문장을 사용할 때 출력 변수로 배열 변수를 사용할 수 있다. 배열 변수를 사용할 경우 여러 개의 로우 데이터를
      동시에 읽어 올 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>FETCH의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/fetch_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/fetch_type_clause.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/fetch_target.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>fetch_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">for_clause</td><td><p>입력 배열 변수를 사용할 때 for_clause를 사용해 동시에 읽을 로우의
                      개수를 지정할 수 있다.</p><p>for_clause가 포함되어 있지 않거나,
                      for_clause에 지정된 로우의 개수가 입력 배열 변수의 크기보다 크면, 배열 변수의 크기만큼
                      로우를 읽는다. 자세한 내용은 <a href="chapter_reference.html#sect_for_clause" title="5.3.2. FOR 절">“5.3.2. FOR 절”</a>을
                      참고한다.</p></td></tr><tr><td align="left">fetch_type_clause</td><td>스크롤 커서일 경우 스크롤 타입을 명시한다.</td></tr><tr><td align="left">cursor_name</td><td>커서의 이름을 명시한다. 사용될 커서는 열려있어야 한다.</td></tr><tr><td align="left">fetch_target</td><td>결과 값을 저장할 호스트 변수를 명시한다.</td></tr><tr><td align="left">USING DESCRIPTOR</td><td>서술자의 이름을 명시할 경우 서술자의 이름 앞에 붙이는 키워드이다.</td></tr><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                      적는다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는
                      타입으로 이미 선언되어 있어야 한다.</p><p>서술자는 ALLOCATE
                      DESCRIPTOR를 통해 이미 할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을 참고한다.</p></td></tr></tbody></table>
              </div>
            </li><li>
              <p>fetch_type_clause</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">NEXT</td><td>현재 커서가 가리키고 있는 로우의 다음 로우에 액세스를 한다. PRIOR 옵션과
                      반대이다. (생략 가능)</td></tr><tr><td align="left">PRIOR</td><td>현재 커서가 가리키고 있는 로우의 이전 로우에 액세스를 한다. NEXT 옵션과
                      반대이다.</td></tr><tr><td align="left">FIRST</td><td>맨 처음에 위치한 로우에 액세스를 한다. LAST 옵션과 반대이다.</td></tr><tr><td align="left">LAST</td><td>맨 마지막에 위치한 로우에 액세스를 한다. FIRST 옵션과 반대이다.</td></tr><tr><td align="left">CURRENT</td><td>현재 로우에 액세스를 한다.</td></tr><tr><td align="left">ABSOLUTE position_clause</td><td>전체 로우 중에서 position_clause번째 로우에 액세스를 한다.</td></tr><tr><td align="left">RELATIVE position_clause</td><td>현재 커서가 가리키고 있는 로우의 다음 position_clause번째에 위치한 로우에
                      액세스를 한다. position_clause의 값이 음수라면 커서가 현재 위치에서 앞으로 이동한다.
                      예를 들어 현재 커서가 8번째 로우를 가리키고 있는데, 'FETCH RELATIVE -3'을
                      실행한다면 커서는 5번째 로우를 가리키게 된다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>fetch_target</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">identifier</td><td>출력 변수를 정의한 식별자이다.</td></tr><tr><td align="left">:host_variable</td><td>출력 변수를 명시한다. 출력 변수의 개수는 하나 이상이고, 준비된 문장의 결과로 출력될
                      SELECT 리스트의 컬럼 개수와 동일해야 한다.</td></tr><tr><td align="left">indicator</td><td>지시자 변수를 명시할 때 사용한다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 FETCH를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL FETCH EMP-CURSOR
     INTO :EMPNO, :ENAME
END-EXEC.

EXEC SQL FETCH EMP-CURSOR 
     INTO :EMPNO, :ENAME:ENAME-IND
END-EXEC.

EXEC SQL FOR :CNT FETCH EMP-CURSOR 
     INTO :EMPNO-ARRAY, :ENAME-ARRAY
END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_FETCH_DESC"/>5.4.15. FETCH DESCRIPTOR<a id="d5e3650" class="indexterm"/><a id="d5e3654" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">FETCH DESCRIPTOR</strong></span>는 커서가 현재 가리키고 있는 로우 데이터를 읽어
      올 때 사용하는 문장이다.</p>

      <p>FETCH와 거의 동일하게 동작한다. 단, 이 문장은 ANSI 타입의 Dynamic SQL 문장에만 사용할 수
      있다.</p>

      <div class="literallayout"><p/></div>

      <p>FETCH DESCRIPTOR의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/ansi_fetch_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">for_clause</td><td><p>입력 배열 변수를 사용할 때 for_clause를 사용해 동시에 읽을 로우의 개수를
                  지정할 수 있다.</p><p>for_clause가 포함되어 있지 않거나, for_clause에
                  지정된 로우의 개수가 입력 배열 변수의 크기보다 크면, 배열 변수의 크기만큼 로우를 읽는다. 자세한 내용은
                  <a href="chapter_reference.html#sect_for_clause" title="5.3.2. FOR 절">“5.3.2. FOR 절”</a>을 참고한다.</p></td></tr><tr><td align="left">fetch_type_clause</td><td>FETCH의 fetch_type_clause와 동일하다.</td></tr><tr><td align="left">cursor_name</td><td>커서의 이름을 명시한다. 사용될 커서는 열려 있는 커서이어야 한다.</td></tr><tr><td align="left">SQL</td><td>기존 ESQL 프로그램과의 호환성을 위한 키워드이며 특별한 의미는 없다.</td></tr><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                  적는다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는 타입으로 이미
                  선언되어 있어야 한다.</p><p>서술자는 ALLOCATE DESCRIPTOR를 통해 이미
                  할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을 참고한다.</p></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <p>다음은 FETCH DESCRIPTOR를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL FETCH C1 INTO DESCRIPTOR 'OUT-DESC' END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_GET_DESC"/>5.4.16. GET DESCRIPTOR<a id="d5e3708" class="indexterm"/><a id="d5e3712" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">GET DESCRIPTOR</strong></span>는 지정한 서술자에서 원하는 정보를 가져올 때
      사용하는 문장이다. 단, 이 문장은 ANSI 타입의 Dynamic SQL 문장에만 사용할 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>GET DESCRIPTOR의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/get_descriptor_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/value.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/get_item_clause.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/item_name.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>get_descriptor_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="200" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">for_clause</td><td><p>입력 배열 변수를 사용할 때 for_clause를 사용해 동시에 읽을 로우의
                      개수를 지정할 수 있다.</p><p>for_clause가 포함되어 있지 않거나,
                      for_clause에 지정된 로우의 개수가 입력 배열 변수의 크기보다 크면, 배열 변수의 크기만큼
                      로우를 읽는다. 자세한 내용은 <a href="chapter_reference.html#sect_for_clause" title="5.3.2. FOR 절">“5.3.2. FOR 절”</a>을
                      참고한다.</p></td></tr><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                      적는다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는
                      타입으로 이미 선언되어 있어야 한다.</p><p>서술자는 ALLOCATE
                      DESCRIPTOR를 통해 이미 할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을 참고한다.</p></td></tr><tr><td align="left">VALUE value</td><td>정보를 가져올 호스트 변수의 순서를 지정한다.</td></tr><tr><td align="left">get_item_clause</td><td>가져올 정보의 항목과 정보를 저장할 호스트 변수를 명시한다.</td></tr><tr><td align="left">count</td><td>사용된 호스트 변수의 개수를 알고자 할 경우 그 개수를 저장할 호스트 변수를
                      명시한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>value</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="200" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">:host_variable</td><td>값이 들어 있는 호스트 변수를 사용할 때 명시한다.</td></tr><tr><td align="left">integer</td><td>값을 직접 정수로 입력할 때 사용한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>get_item_clause</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="200" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">:host_variable</td><td>해당 항목을 가져올 호스트 변수를 명시한다.</td></tr><tr><td align="left">item_name</td><td>값을 가져올 구체적인 항목을 명시한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>item_name</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="200" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">TYPE</td><td>데이터의 타입을 가져오고자 할 때 사용한다.</td></tr><tr><td align="left">LENGTH</td><td>데이터의 최대 길이를 가져오고자 할 때 사용한다.</td></tr><tr><td align="left">INDICATOR</td><td>데이터 연관된 지시자 값을 가져오고자 할 때 사용한다.</td></tr><tr><td align="left">DATA</td><td>데이터 값을 가져오고자 할 때 사용한다.</td></tr><tr><td align="left">CHARACTER_SET_NAME</td><td>데이터가 저장된 컬럼의 문자 세트를 가져오고자 할 때 사용한다.</td></tr><tr><td align="left">OCTET_LENGTH</td><td>데이터 길이를 Byte 단위로 환산해 가져오고자 할 때 사용한다.</td></tr><tr><td align="left">RETURNED_LENGTH</td><td>FETCH를 할 때 실제로 받아올 데이터 길이를 가져오고자 할 때
                      사용한다.</td></tr><tr><td align="left">RETURNED_OCTET_LENGTH</td><td>FETCH를 할 때 실제로 받아올 데이터 길이를 Byte 단위로 환산해 가져오고자 할 때
                      사용한다.</td></tr><tr><td align="left">PRECISION</td><td>받아올 데이터의 정밀도를 가져오고자 할 때 사용한다.</td></tr><tr><td align="left">SCALE</td><td>받아올 데이터의 스케일을 가져오고자 할 때 사용한다.</td></tr><tr><td align="left">NULLABLE</td><td><p>해당 컬럼의 데이터가 NULL이 될 수 있는지 여부를 알고자 할 때
                      사용한다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                            <p>값이 1이면, 해당 컬럼은 NULL값을 가질 수 있다.</p>
                          </li><li style="list-style-type: circle">
                            <p>값이 0이면, 해당 컬럼은 NULL값을 가질 수 없는 키이거나 NOT-NULL
                            제약조건을 가지고 있는 컬럼이다.</p>
                          </li></ul></div></td></tr><tr><td align="left">NAME</td><td>해당 컬럼의 이름을 가져오고자 할 때 사용한다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 GET DESCRIPTOR를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL GET DESCRIPTOR 'OUT-DESC' :INPUT-CNT = COUNT END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_INSERT"/>5.4.17. INSERT<a id="d5e3867" class="indexterm"/><a id="d5e3871" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">INSERT</strong></span>는 테이블 또는 뷰에 로우를 삽입할 때 사용하는 문장이다. 전체
      컬럼 또는 일부 컬럼에 데이터를 삽입할 수 있다. INSERT를 사용할 때 입력 변수로 배열 변수를 사용할 수도 있으며, 지시자
      변수를 함께 사용할 수 있다.</p>

      <p>또한 입력할 데이터의 값을 사용자가 직접 지정할 수도 있고, 부질의를 통하여 지정할 수도 있다. 부질의를 이용하는 경우
      부질의의 결과 로우 모두가 테이블이나 뷰에 삽입된다.</p>

      <div class="literallayout"><p/></div>

      <p>INSERT의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <p>INSERT의 문법에 대한 자세한 내용은 "<span>Tibero</span> SQL 참조 안내서"를 참고한다.</p>
        </li><li>
          <p>특권</p>

          <p>INSERT를 사용하려면, INSERT의 대상 테이블 또는 뷰에 대하여 INSERT 객체 특권을 갖거나
          INSERT ANY TABLE 시스템 특권을 갖고 있어야 한다.</p>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
              <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">FOR</td><td><p>입력 배열 변수와 함께 사용될 경우 FOR 절을 이용하여 삽입할 데이터의 개수를
                    지정할 수 있다.</p><p>FOR 절이 포함되어 있지 않거나 FOR 절에서 지정한 크기가
                    배열 입력 변수의 크기보다 크면, 전체 배열 변수에 저장된 데이터가 테이블에
                    삽입된다.</p></td></tr></tbody></table>
            </div>
        </li><li>
          <p>예제</p>

          <p>다음은 INSERT를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL INSERT INTO EMP
         VALUES (34, ‘James', 45000)
END-EXEC.

EXEC SQL INSERT INTO EMP (EMPNO, ENAME)
         VALUES (:EMPNO, :ENAME)
END-EXEC.

EXEC SQL FOR :CNT 
     INSERT INTO EMP (EMPNO, ENAME)
     VALUES (:EMPNO-ARRAY,:ENAME-ARRAY :ENAME-IND-ARRAY)
END-EXEC.

EXEC SQL INSERT INTO HIGH_EMP
     SELECT * FROM EMP WHERE SALARY &gt; 50000
END-EXEC.</pre>

          <p>위의 예에서 알 수 있듯이 INSERT 문장은 EXEC SQL로 시작하고 END-EXEC.로 끝난다는 것을
          제외하면, 일반적인 SQL 문장의 문법과 크게 다르지 않다.</p>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_OPEN"/>5.4.18. OPEN<a id="d5e3909" class="indexterm"/><a id="d5e3913" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">OPEN</strong></span>은 커서를 열 때 사용하는 문장이다. 이 문장을 사용해 열려고 하는
      커서는 이미 선언되어 있어야 하며, SELECT 문장과 연관되어 있어야 한다. 커서의 선언은 DECLARE CURSOR를 통하여
      실행된다.</p>

      <p>커서를 여는 것과 동시에 연관된 SELECT 문장이 실행되며, 커서는 질의 문장이 반환한 결과의 제일 처음에 위치한
      로우를 가리킨다. 커서는 SELECT 문장과 연관되기도 하지만, Dynamic SQL 문장과 연관되기도 한다.</p>

      <div class="literallayout"><p/></div>

      <p>OPEN의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/open_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/normal_using_clause.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/ansi_using_and_into_clause.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>open_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">for_clause</td><td>실행 반복 횟수를 지정한다. 자세한 내용은 <a href="chapter_reference.html#sect_for_clause" title="5.3.2. FOR 절">“5.3.2. FOR 절”</a>을 참고한다.</td></tr><tr><td align="left">cursor_name</td><td>열려고 하는 커서의 이름을 명시한다.</td></tr><tr><td align="left">normal_using_clause</td><td>일반적으로 사용하는 OPEN 문장의 형태이다.</td></tr><tr><td align="left">ansi_using_and_into_clause</td><td>이미 정의된 서술자를 이용한다. ANSI 타입의 Dynamic SQL 문장에만
                      사용된다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>normal_using_clause</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">USING</td><td><p>커서가 Dynamic SQL 문장과 연관된 경우 USING 절을 이용하여
                      SELECT 문장의 입력 변수에 할당할 값을 지정할 수 있다.</p><p>입력 변수로 배열
                      변수를 사용할 수도 있으며, 서술자 변수를 함께 사용할 수도 있다.</p></td></tr><tr><td align="left">using_param_clause</td><td>입력 호스트 변수의 정보가 필요할 경우에 사용한다.</td></tr><tr><td align="left">USING DESCRIPTOR</td><td>입력 호스트 변수의 정보를 가져왔던 서술자를 사용할 경우 명시한다.</td></tr><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                      적는다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는
                      타입으로 이미 선언되어 있어야 한다.</p><p>서술자는 ALLOCATE
                      DESCRIPTOR를 통해 이미 할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을 참고한다.</p></td></tr></tbody></table>
              </div>
            </li><li>
              <p>ansi_using_and_into_clause</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">USING</td><td>입력 호스트 변수의 정보가 들어 있는 서술자 변수가 필요할 경우에
                      사용한다.</td></tr><tr><td align="left">INTO</td><td>출력 호스트 변수의 정보가 들어 있는 서술자 변수가 필요할 경우에
                      사용한다.</td></tr><tr><td align="left">SQL</td><td>기존 ESQL 프로그램과의 호환성을 위한 키워드이며 특별한 의미는 없다.</td></tr><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                      적는다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는
                      타입으로 이미 선언되어 있어야 한다.</p><p>서술자는 ALLOCATE
                      DESCRIPTOR를 통해 이미 할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을 참고한다.</p></td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>다음은 OPEN을 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL OPEN EMP-CURSOR END-EXEC.

EXEC SQL OPEN EMP-CURSOR USING :EMPNO END-EXEC.

EXEC SQL FOR :CNT
     OPEN EMP-CURSOR USING :EMPNO INDICATOR :EMPNO-IND
END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_PREPARE"/>5.4.19. PREPARE<a id="d5e4024" class="indexterm"/><a id="d5e4028" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">PREPARE</strong></span>는 Dynamic SQL 문장을 준비할 때 사용하는 문장이다.
      준비된 SQL 문장은 문장의 이름을 통해 서로 식별되며, 이후에 DECLARE CURSOR 또는 EXECUTE에서
      참조된다.</p>

      <p>SQL 문장을 준비한다는 것은 단지 문장을 파싱(Parsing)한다는 의미일 뿐이며, 문장이 실행된다는 의미는 아니다.
      문장이 실제로 실행되는 것은 EXECUTE 문장을 통해서이다. SQL 문장에는 하나 이상의 입력 변수가 포함될 수 있는데, 입력
      변수가 포함될 때 입력 변수의 이름은 별다른 의미를 갖지 않으며, <span>tbESQL</span> 프로그램에 미리 선언되어 있을 필요도 없다.</p>

      <div class="literallayout"><p/></div>

      <p>PREPARE의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/prepare_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">statement_name</td><td>준비를 실행할 SQL 문장의 이름을 명시한다.</td></tr><tr><td align="left">FROM</td><td><p>FROM 절 뒤에는 준비할 Dynamic SQL 문장이 온다. SQL 문장 자체가 올
                  수도 있으며, SQL 문장의 문자열을 저장한 호스트 변수가 올 수도 있다.</p><p>SELECT
                  문장이라면 문장 자체가 올 수 있다.</p></td></tr><tr><td align="left">:host_variable</td><td>Dynamic SQL 문장을 저장한 호스트 변수를 명시한다.</td></tr><tr><td align="left">string literal</td><td>Dynamic SQL 문장을 나타내는 문자열을 명시한다.</td></tr><tr><td align="left">select_statement</td><td>SELECT 문장 자체를 명시한다.</td></tr><tr><td align="left">execute_dml_statement</td><td>실행할 INSERT, UPDATE, DELETE 문장 자체를 명시한다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <p>다음은 PREPARE를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL PREPARE EMP-STMT FROM :SQL-STMT END-EXEC.

EXEC SQL PREPARE EMP-STMT
      FROM Z'UPDATE EMP SET SALARY = SALARY * 1.05'
END-EXEC.

EXEC SQL PREPARE EMP-STMT FROM
     SELECT EMPNO, ENAME, SALARY FROM EMP WHERE DEPTNO = :DEPTNO
END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_ROLLBACK"/>5.4.20. ROLLBACK<a id="d5e4081" class="indexterm"/><a id="d5e4085" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">ROLLBACK</strong></span>은 현재 진행 중인 트랜잭션을 롤백하고 갱신된 모든 내용을
      취소할 때 사용하는 문장이다.</p>

      <p>롤백을 실행하는 것과 동시에 데이터베이스와의 접속을 끊을 수도 있으며, 미리 설정된 저장점까지 부분 롤백(Partial
      Rollback)을 수행할 수도 있다.</p>

      <div class="literallayout"><p/></div>

      <p>ROLLBACK의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/rollback_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/savepoint_name.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>rollback_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">at_clause</td><td><p>문장을 실행할 데이터베이스를 명시한다.</p><p>데이터베이스의
                      이름을 직접 명시할 수도 있고, 데이터베이스의 이름이 저장된 호스트 변수를 명시할 수도 있다. 자세한
                      내용은 <a href="chapter_reference.html#sect_at_clause" title="5.3.1. AT 절">“5.3.1. AT 절”</a>을
                      참고한다.</p></td></tr><tr><td align="left">WORK</td><td>기존 ESQL 프로그램과의 호환성을 위한 키워드이며 특별한 의미는 없다.</td></tr><tr><td align="left">RELEASE</td><td>모든 리소스를 반환하고 데이터베이스와의 접속을 종료한다.</td></tr><tr><td align="left">TO</td><td>특정 저장점까지 부분 롤백을 수행하고자 할 때 명시한다.</td></tr><tr><td align="left">SAVEPOINT</td><td>단지 문법 호환을 위해 지원하는 부분이다. 이 부분의 명시여부는 문장 실행에 어떤 영향도
                      없다.</td></tr><tr><td align="left">savepoint_name</td><td>부분 롤백을 수행할 저장점의 이름을 명시한다. 저장점은 롤백을 실행하기 전에 프로그램
                      내에 이미 설정되어 있어야 한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>savepoint_name</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">identifier</td><td>저장점의 이름을 정의한 식별자이다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 ROLLBACK을 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL ROLLBACK END-EXEC.

EXEC SQL ROLLBACK TO SAVEPOINT SP1 END-EXEC.

EXEC SQL ROLLBACK WORK RELEASE END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_SAVEPOINT"/>5.4.21. SAVEPOINT<a id="d5e4159" class="indexterm"/><a id="d5e4163" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">SAVEPOINT</strong></span>는 저장점을 설정할 때 사용하는 문장이다. 설정된 저장점은
      특정 지점까지 부분 롤백을 하고자 할 때 사용된다.</p>

      <div class="literallayout"><p/></div>

      <p>SAVEPOINT의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/savepoint_statement.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">savepoint_name</td><td>설정할 저장점에 부여할 이름을 명시한다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <p>다음은 SAVEPOINT를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL SAVEPOINT SP1 END-EXEC.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_SELECT"/>5.4.22. SELECT<a id="d5e4197" class="indexterm"/><a id="d5e4201" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">SELECT</strong></span>는 테이블 또는 뷰에 대해 질의를 수행하고, 질의를 수행한 결과
      로우의 각 데이터를 출력 변수에 저장할 때 사용하는 문장이다.</p>

      <div class="literallayout"><p/></div>

      <p>SELECT의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <p>SELECT의 문법에 대한 자세한 내용은 "<span>Tibero</span> SQL 참조 안내서"를 참고한다.</p>
        </li><li>
          <p>특권</p>

          <p>SELECT 문장을 사용해 질의를 수행하기 위해서는, 대상 테이블에 대한 SELECT 객체 특권이 있거나
          SELECT ANY TABLE 시스템 권한을 갖고 있어야 한다.</p>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
              <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">INTO</td><td><p>질의 결과의 컬럼의 개수는 INTO 절에 포함된 출력 변수의 개수와 같아야
                    한다.</p><p>INTO 절에는 지시자 변수와 함께 배열 출력 변수를 사용할 수 있다. 출력
                    변수는 모두 스칼라 변수이거나 또는 모두 배열 변수이어야 하며, 이 두 가지가 서로 섞여 있을 수
                    없다.</p></td></tr><tr><td align="left">WHERE</td><td>WHERE 절에는 입력 변수를 포함할 수 있다. 이때 지시자 변수와 함께 사용될 수 있다.
                    SELECT 문장 내에서는 배열 입력 변수를 사용할 수 없다.</td></tr><tr><td align="left">HAVING</td><td>HAVING 절에는 입력 변수를 포함할 수 있다. 지시자 변수 및 배열 입력 변수와 관련된
                    내용은 WHERE 절과 동일하다.</td></tr></tbody></table>
            </div>
        </li><li>
          <p>예제</p>

          <p>다음은 SELECT를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL SELECT EMPNO, ENAME, SALARY
     INTO :EMPNO, :ENAME, :SALARY FROM EMP
END-EXEC.

EXEC SQL SELECT EMPNO, ENAME, DNAME
     INTO :EMPNO-ARRAY,
          :ENAME-ARRAY :ENAME-ARRAY-IND,
          :DNAME-ARRAY
      FROM EMP E, DEPT D
      WHERE E.DEPTNO = D.DEPTNO AND E.DEPTNO = :DEPTNO
END-EXEC.</pre>

          <p>위의 예에서 알 수 있듯이 SELECT 문장은 INTO 절을 제외하면, 일반적인 SQL 문장의 문법과 크게
          다르지 않다.</p>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_SET_DESC"/>5.4.23. SET DESCRIPTOR<a id="d5e4244" class="indexterm"/><a id="d5e4248" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">SET DESCRIPTOR</strong></span>는 사용자가 입력해야 할 정보를 지정한 서술자에
      기록하는 문장이다. 사용자는 이 문장을 통해 데이터 값이나 데이터 값의 길이 등을 지정할 수 있다. 단, 이 문장은 ANSI
      타입의 Dynamic SQL 문장에만 사용할 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>SET DESCRIPTOR의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/set_descriptor_statement.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/set_item_clause.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>set_descriptor_statement</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">for_clause</td><td>반복 횟수를 지정한다. 자세한 내용은 <a href="chapter_reference.html#sect_for_clause" title="5.3.2. FOR 절">“5.3.2. FOR 절”</a>을 참고한다.</td></tr><tr><td align="left">descriptor_name</td><td><p>서술자의 이름이 저장된 호스트 변수 또는 문자열을
                      적는다.</p><p>호스트 변수는 PIC X(n) 타입 등 문자열을 저장할 수 있는
                      타입으로 이미 선언되어 있어야 한다.</p><p>서술자는 ALLOCATE
                      DESCRIPTOR를 통해 이미 할당되어 있어야 한다. 자세한 내용은 <a href="chapter_reference.html#sect_descriptor_name" title="5.3.3. DESCRIPTOR 이름">“5.3.3. DESCRIPTOR 이름”</a>을 참고한다.</p></td></tr><tr><td align="left">VALUE value</td><td>몇 번째 출력 호스트 변수인지 명시한다.</td></tr><tr><td align="left">set_item_clause</td><td>출력 호스트 변수의 정보를 입력하기 위해 서술한다.</td></tr><tr><td align="left">COUNT</td><td>출력 호스트 변수의 개수를 받아오기 위해 서술한다.</td></tr><tr><td align="left">count</td><td>출력 호스트 변수의 개수를 받아올 호스트 변수를 명시한다.</td></tr></tbody></table>
              </div>
            </li></ul></div>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>set_item_clause</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">REF</td><td><p>INDICATOR, DATA, RETURNED_LENGTH 항목을 지정할 때만
                      사용할 수 있는 키워드로 속도와 편리성을 위해 사용한다.</p><p>호스트 변수의 값이
                      아닌 호스트 변수 자체를 지정하며, GET DESCRIPTOR 문장을 따로 실행하지 않아도
                      FETCH한 후 지정된 항목의 값이 지정된 호스트 변수에 들어간다.</p></td></tr><tr><td align="left">item_name</td><td>GET DESCRIPTOR와 동일하다.</td></tr><tr><td align="left">host_var</td><td>출력 호스트 변수의 각 정보를 받아올 호스트 변수를 지정한다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 SET DESCRIPTOR를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL SET DESCRIPTOR 'OUTPUT-DESCRIPTOR' VALUE :OCCURS
     TYPE = :TYPE, LENGTH = :LEN END-EXEC</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_UPDATE"/>5.4.24. UPDATE<a id="d5e4332" class="indexterm"/><a id="d5e4336" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">UPDATE</strong></span>는 테이블 또는 뷰의 컬럼 값을 갱신할 때 사용하는 문장이다. 일부
      컬럼 또는 전체 컬럼에 대해 갱신을 수행할 수 있다. 이 문장을 사용할 때 입력 변수로 배열 변수를 사용할 수도 있으며, 지시자
      변수를 함께 사용할 수 있다.</p>

      <div class="literallayout"><p/></div>

      <p>UPDATE의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <p>UPDATE의 문법에 대한 자세한 내용은 "<span>Tibero</span> SQL 참조 안내서"를 참고한다.</p>
        </li><li>
          <p>특권</p>

          <p>UPDATE를 사용해 갱신을 수행하려면, 대상 테이블 또는 뷰에 대한 UPDATE 객체 특권을 갖거나
          UPDATE ANY TABLE 시스템 특권을 가지고 있어야 한다.</p>
        </li><li>
          <p>구성요소</p>

          <div class="informaltable">
              <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">SET</td><td>SET 절에 입력 배열 변수가 포함되어 있다면, WHERE 절에도 반드시 같은 크기의 입력
                    배열 변수가 포함되어야 한다.</td></tr><tr><td align="left">WHERE</td><td><p>WHERE 절에 입력 배열 변수가 포함되어 있다면, SET 절에도 반드시 같은
                    크기의 입력 배열 변수가 포함되어야 한다.</p><p>UPDATE 문장을 커서와 함께 사용할
                    수도 있다. 현재 커서가 가리키는 로우의 컬럼 값을 갱신하려면 WHERE 절에 CURRENT OF와 커서
                    이름을 포함시킨다. 커서를 사용하려면 커서는 이미 열려 있는 상태이어야 한다.</p></td></tr><tr><td align="left">FOR</td><td><p>입력 배열 변수를 사용할 때 FOR 절을 이용하여 삽입할 데이터의 개수를 지정할
                    수 있다.</p><p>FOR 절이 포함되어 있지 않거나 FOR 절에서 지정한 개수가 입력 배열
                    변수의 크기보다 크다면, 전체 배열 변수에 저장된 데이터에 대하여 갱신을
                    수행한다.</p></td></tr></tbody></table>
            </div>
        </li><li>
          <p>예제</p>

          <p>다음은 UPDATE를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL UPDATE EMP SET SALARY = SALARY * 1.05 END-EXEC.

EXEC SQL UPDATE EMP SET SALARY = SALARY * :RATIO
         WHERE DEPTNO = :DEPTNO
END-EXEC.

EXEC SQL FOR :CNT
     UPDATE EMP SET SALARY = SALARY * :RATIO-ARRAY
     WHERE DEPTNO = :DEPTNO-ARRAY
END-EXEC.

EXEC SQL UPDATE EMP SET SALARY = SALARY * 1.05
     WHERE CURRENT OF EMP-CURSOR
END-EXEC.</pre>

          <p>위의 예에서 알 수 있듯이 UPDATE 문장은 EXEC SQL로 시작하고 END-EXEC.로 끝난다는 것을
          제외하면, 일반적인 SQL 문장의 문법과 크게 다르지 않다.</p>
        </li></ul></div>

      <p/>

      <p/>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="sect_WHENEVER"/>5.4.25. WHENEVER<a id="d5e4383" class="indexterm"/><a id="d5e4387" class="indexterm"/></h3></div></div></div>
      

      <p><span><strong class="guibutton">WHENEVER</strong></span>는 <span>tbESQL</span>/COBOL 프로그램을 실행하는 도중, 예외 상황이 발생했을 경우에
      대비하여 수행할 작업을 선언할 때 사용하는 문장이다. 발생 가능한 예외 상황에는 액세스할 로우가 없는 경우와 에러 또는 경고가
      발생한 경우가 있다.</p>

      <p>WHENEVER 문장의 효과 범위는 WHENEVER 문장이 명시된 위치부터 다음 WHENEVER 문장이 나타날
      때까지이다. 하지만 문장이 한 번만 명시되었다면 효과 범위는 WHENEVER 문장이 명시된 위치부터 프로그램의
      마지막까지이다.</p>

      <div class="literallayout"><p/></div>

      <p>WHENEVER의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>문법</p>

          <div class="informalfigure">
            <div xmlns="" class="mediaobject"><img src="resources/whenever_statement_cobol.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/condition.png"/></div>

            <div xmlns="" class="mediaobject"><img src="resources/condition_action_cobol.png"/></div>
          </div>
        </li><li>
          <p>구성요소</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>whenever_statement_cobol</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">condition</td><td>에러나 경고 또는 결과 로우가 없는 등의 예외 상황을 명시한다.</td></tr><tr><td align="left">condition_action_cobol</td><td>예외 상황이 발생했을 경우 그에 따른 대처 방법을 명시한다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>condition</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">SQLERROR</td><td>에러가 발생한 경우이다.</td></tr><tr><td align="left">SQLWARNING</td><td>경고가 발생한 경우이다.</td></tr><tr><td align="left"><p>NOT
                      FOUND</p><p>또는</p><p>NOTFOUND</p></td><td>질의 결과 로우가 없거나 커서를 사용해 읽을 로우가 더 이상 없는
                      경우이다.</td></tr></tbody></table>
              </div>
            </li><li>
              <p>condition_action_cobol</p>

              <div class="informaltable">
                <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">구성요소</th><th>설명</th></tr></thead><tbody><tr><td align="left">CONTINUE</td><td>다음 라인부터 프로그램을 계속 진행한다.</td></tr><tr><td align="left">DO CONTINUE</td><td>루프 내에서 CONTINUE를 실행한다.</td></tr><tr><td align="left">DO BREAK</td><td>루프 내에서 BREAK를 실행한다.</td></tr><tr><td align="left">DO do_stmt</td><td>COBOL 프로그래밍 언어로 작성한 에러 처리 문장을 수행한다.</td></tr><tr><td align="left">STOP</td><td>현재 트랜잭션을 롤백하고 프로그램을 정지한다.</td></tr><tr><td align="left">GOTO label</td><td>해당 label이 있는 곳으로 이동하여 프로그램을 진행한다.</td></tr></tbody></table>
              </div>
            </li></ul></div>
        </li><li>
          <p>예제</p>

          <p>다음은 WHENEVER를 사용하는 예이다.</p>

          <pre class="programlisting">EXEC SQL WHENEVER NOT FOUND GOTO FETCH-END END-EXEC.

EXEC SQL WHENEVER SQLERROR DO PERFORM SQLERROR END-EXEC.

EXEC SQL WHENEVER SQLWARNING CONTINUE END-EXEC.</pre>
        </li></ul></div>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chapter_array_variable.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="chapter_precompiler_option.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제4장 배열 변수 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제6장 <span>tbESQL</span>/COBOL 프리컴파일러 옵션</td></tr></table></div><div xmlns="" align="center"/></body></html>