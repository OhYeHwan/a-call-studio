<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제1장 tbESQL/COBOL 소개</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero tbESQL/COBOL 안내서"/><link rel="up" href="index.html" title="Tibero tbESQL/COBOL 안내서"/><link rel="prev" href="about.html" title="안내서에 대하여"/><link rel="next" href="ch02.html" title="제2장 데이터 타입"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제1장 <span xmlns="http://www.w3.org/1999/xhtml">tbESQL</span>/COBOL 소개</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="about.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="ch02.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="chapter_introduce"/>제1장 <span>tbESQL</span>/COBOL 소개</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="chapter_introduce.html#d5e397">1.1. 개요</a></span></dt><dt><span class="section"><a href="chapter_introduce.html#sect_component">1.2. 구성요소</a></span></dt><dd><dl><dt><span class="section"><a href="chapter_introduce.html#d5e424">1.2.1. <span>tbESQL</span>/COBOL 문장</a></span></dt><dt><span class="section"><a href="chapter_introduce.html#d5e460">1.2.2. 프로그램 변수</a></span></dt><dt><span class="section"><a href="chapter_introduce.html#d5e546">1.2.3. 구조체 및 배열 변수</a></span></dt><dt><span class="section"><a href="chapter_introduce.html#d5e573">1.2.4. 커서</a></span></dt><dt><span class="section"><a href="chapter_introduce.html#d5e595">1.2.5. 프리컴파일러</a></span></dt></dl></dd></dl></div>
  

  <p>본 장에서는 <span>tbESQL</span>/COBOL의 기본 개념과 <span>tbESQL</span>/COBOL 프로그래밍을 시작하기 전에 알아야 할 구성요소를
  설명한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e397"/>1.1. 개요</h2></div></div></div>
    

    <p><span><strong class="guibutton"><span>tbESQL</span></strong></span>은 ESQL(Embedded SQL: 내장 SQL)의
    사용을 위해 <span>Tibero</span>가 제공하는 인터페이스이다. 일반적으로 프로그래밍 언어는 매우
    복잡하고 세밀한 작업을 빠르게 수행할 수 있으며, SQL 문장은 간단한 문법만으로 데이터베이스에 직접적인 작업을 수행할 수
    있다.<a id="d5e403" class="indexterm"/><a id="d5e405" class="indexterm"/><a id="d5e407" class="indexterm"/></p>

    <p><span><strong class="guibutton">ESQL</strong></span>은 이러한 프로그래밍 언어의 연산 능력과 SQL의
    데이터베이스(Database)를 조작하는 능력을 결합하기 위한 방법이며, ANSI 및 ISO 표준으로 정의되어 있다.</p>

    <p><span>Tibero</span>에서는 애플리케이션 개발에 사용되는 COBOL과 C에 대한
    <span>tbESQL</span> 인터페이스를 제공한다. COBOL 프로그래밍 언어를 위한 ESQL
    인터페이스를 <span><strong class="guibutton"><span>tbESQL</span>/COBOL</strong></span>이라고 부르며, C 프로그래밍 언어에 대한
    인터페이스를 <span>tbESQL</span>/C라고 부른다.</p>

    <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
      <p><span>tbESQL</span>/C에 대한 내용은 "<span>Tibero</span> <span>tbESQL</span>/C 안내서"를 참고한다.</p>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="sect_component"/>1.2. 구성요소</h2></div></div></div>
    

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e424"/>1.2.1. <span>tbESQL</span>/COBOL 문장</h3></div></div></div>
      

      <p><span>tbESQL</span>/COBOL 프로그램에는 COBOL 프로그래밍 언어의 소스 코드와
      <span>tbESQL</span>/COBOL 문장이 혼합되어 있다. <span>tbESQL</span>/COBOL 프로그램 내에서 SQL 문장의 질의(Query) 등
      데이터베이스 처리와 관련된 문장을 <span>tbESQL</span>/COBOL 문장(<span>tbESQL</span>/COBOL Statement)이라고 한다.<a id="d5e433" class="indexterm"/></p>

      <p><span>tbESQL</span>/COBOL 문장은 일반 SQL 문장과 비슷하지만 다음과 같은 점에서
      차이가 난다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>항상 <span><strong class="guibutton">EXEC SQL</strong></span>로 시작하고 <span><strong class="guibutton">END
          EXEC.</strong></span>로 종료한다.</p>
        </li><li>
          <p>필요한 경우에 입력 변수와 출력 변수를 포함한다.</p>
        </li><li>
          <p>일반 SQL 문장에는 없는 새로운 절을 포함할 수 있다. 예를 들어 SELECT 문장은 INTO 절을 포함할 수
          있다.</p>
        </li></ul></div>

      <p>다음은 <span>tbESQL</span>/COBOL 프로그램에서 UPDATE 문장을 작성한
      예이다.</p>

      <div class="example"><a id="ex_tbesqlc_up"/><p class="title"><b>[예 1.1] <span>tbESQL</span>/COBOL에서의 UPDATE 문장</b></p><div class="example-contents">
        

        

        <pre class="programlisting">EXEC SQL UPDATE EMP SET SALARY = SALARY * 1.05
         WHERE EMPNO = 5
END-EXEC.</pre>

        <p>위의 예에서는 <span>tbESQL</span>/COBOL 문장임을 나타내는 <span><strong class="guibutton">EXEC
        SQL</strong></span>로 시작되고 <span><strong class="guibutton">END-EXEC.</strong></span>로 끝난다는 점에서 일반
        SQL 문장과 차이가 난다는 것을 알 수 있다.</p>
      </div></div><br class="example-break"/>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
        <p>자세한 내용은 <a href="chapter_reference.html" title="제5장 tbESQL/COBOL 문장">“제5장 <span>tbESQL</span>/COBOL 문장”</a>을 참고한다.</p>
      </div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e460"/>1.2.2. 프로그램 변수</h3></div></div></div>
      

      <p><span>tbESQL</span>/COBOL 프로그램에서 가장 중요한 작업 중에 하나는 프로그램과
      데이터베이스 간에 데이터를 전달하는 것이다. 이러한 작업은 주로 프로그램 변수를 이용하여 수행한다. 즉, 프로그램 변수를 이용하여
      질의를 하거나 변수의 값을 데이터베이스에 저장할 수 있고, 데이터베이스의 컬럼 값을 프로그램 변수에 저장할 수도 있다. 이러한
      작업을 하기 위해서는 <span>Tibero</span>의 데이터 타입과 <span>tbESQL</span>/COBOL 프로그램의 데이터 타입 간의 연관성이 필요하다. 예를 들어
      다음의 <span>Tibero</span>의 데이터 타입과 <span>tbESQL</span>/COBOL 프로그램의 데이터 타입은 서로 대응된다.</p>

      <div class="informaltable">
        <table border="1"><colgroup><col/><col/></colgroup><thead><tr><th><span>Tibero</span>의 데이터 타입</th><th><span>tbESQL</span>/COBOL 프로그램의 데이터 타입</th></tr></thead><tbody><tr><td>NUMBER(p, s)</td><td>PIC S9(n)</td></tr></tbody></table>
      </div>

      <p>NUMBER 타입에서 p는 정밀도(Precision), s는 스케일(Scale)을 의미한다. <a id="d5e481" class="indexterm"/><a id="d5e483" class="indexterm"/><a id="d5e485" class="indexterm"/><a id="d5e487" class="indexterm"/></p>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
        <p><span>Tibero</span>의 데이터 타입과 <span>tbESQL</span>/COBOL 프로그램의 데이터 타입 간의 대응에 대해서는 <a href="ch02.html#sect_datatype_corre" title="2.3.1. 데이터 타입 대응">“2.3.1. 데이터 타입 대응”</a>을 참고한다.</p>
      </div>

      <div class="literallayout"><p/></div>

      <h4><a id="d5e495"/>프로그램 변수의 선언</h4>

      <p><span>tbESQL</span>/COBOL 프로그램에서의 변수는 COBOL 프로그램의 변수와 거의
      동일하게 선언되고 사용된다. 데이터베이스 작업과 관련되지 않는 변수는 COBOL 프로그램에서 사용되는 것과 같이 제약 없이 사용할
      수 있다.</p>

      <p/>

      <p>다음은 <span>tbESQL</span>/COBOL에서 프로그램 변수를 선언한 예이다.</p>

      <div class="example"><a id="ex_tbesqlcvar"/><p class="title"><b>[예 1.2] <span>tbESQL</span>/COBOL에서의 프로그램 변수의 선언</b></p><div class="example-contents">
        

        

        <pre class="programlisting">01 OPERATION PIC X(20) VARYING OCCURS 5 TIMES.
01 TELLER.
   03 EMPNO  PIC S9(7).
   03 ENAME  PIC X(10).
   03 SALARY PIC S9(5).
01 CNT PIC S9(9).</pre>
      </div></div><br class="example-break"/>

      <p>위의 예에서 VARYING 키워드로 선언한 VARCHAR 타입은 <span>tbESQL</span>/COBOL 프로그램 내에서만 사용할 수 있는 타입이며, 프리컴파일
      과정을 거쳐 COBOL 프로그래밍 언어의 데이터 타입으로 변환된다.</p>

      <div class="literallayout"><p/></div>

      <h4><a id="d5e508"/>입/출력 변수</h4>

      <p>데이터베이스 작업과 관련된 변수는 다음과 같이 두 가지로 구분된다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>입력 변수</p>

          <p><span>tbESQL</span>/COBOL 문장을 통해 컬럼의 값을 삽입, 갱신, 삭제할 때
          데이터의 값을 설정하기 위한 변수이다.<a id="d5e515" class="indexterm"/></p>

          <p>입력 변수는 다음과 같은 특징이 있다.</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>입력 변수를 사용할 때는 반드시 변수 앞에 <span><strong class="guibutton">콜론(:)</strong></span>을 붙여야
              한다.</p>
            </li><li>
              <p>입력 변수는 SELECT, INSERT, UPDATE, DELETE 문장과 WHERE 절과 SET 절
              등의 컬럼 값의 위치에 사용될 수 있다.</p>
            </li><li>
              <p>입력 변수는 테이블 이름이나 컬럼 이름의 위치에는 사용 될 수 없다.</p>
            </li></ul></div>
        </li><li>
          <p>출력 변수</p>

          <p><span>tbESQL</span>/COBOL 문장의 질의 수행 결과로 반환된 값을 저장하기 위한
          변수이다.<a id="d5e530" class="indexterm"/></p>

          <p>출력 변수는 다음과 같은 특징이 있다.</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>입력 변수와 마찬가지로 변수 앞에 반드시 <span><strong class="guibutton">콜론(:)</strong></span>을 붙여야
              한다.</p>
            </li><li>
              <p>출력 변수는 SELECT 문장의 INTO 절에 사용될 수 있다.</p>
            </li><li>
              <p>INTO 절에는 출력 변수와 함께 INDICATOR 키워드와 지시자 변수가 올 수 있다.</p>
            </li></ul></div>
        </li></ul></div>

      <p>다음은 WHERE 절에 사용된 입력 변수 EMPNO와 INTO 절에 사용된 출력 변수 ENAME, SALARY,
      ADDR를 사용한 예이다.</p>

      <div class="example"><a id="ex_io_var"/><p class="title"><b>[예 1.3] 입/출력 변수의 사용</b></p><div class="example-contents">
        

        

        <pre class="programlisting">EXEC SQL SELECT ENAME, SALARY, ADDR 
         INTO :ENAME, :SALARY, :ADDR
         FROM EMP
         WHERE EMPNO = :EMPNO
END-EXEC.</pre>
      </div></div><br class="example-break"/>

      <p>위의 문장을 실행하기 전에 EMPNO 값을 설정하는 코드가 와야 하며, 또한 문장이 실행된 후에는 반환된 ENAME,
      SALARY, ADDR 컬럼 값에 대한 적절한 작업이 진행되어야 한다.</p>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e546"/>1.2.3. 구조체 및 배열 변수</h3></div></div></div>
      

      <p>구조체와 배열 변수는 동시에 여러 개의 입/출력 변수를 처리하는 자료 구조이다.</p>

      <div class="literallayout"><p/></div>

      <h4><a id="d5e550"/>구조체<a id="d5e551" class="indexterm"/></h4>

      <p><span>tbESQL</span>/COBOL 프로그램에서는 보통 동시에 여러 개의 입력 변수나 출력
      변수가 사용된다. <a href="chapter_introduce.html#ex_io_var" title="[예 1.3] 입/출력 변수의 사용">[예 1.3]</a>의 경우에도 SELECT 문장의 INTO 절에서 세 개의 출력
      변수(ENAME, SALARY, ADDR)가 사용되었다. 또한 INSERT 문장을 사용할 경우에는 여러 개의 입력 변수가 사용될
      수 있다.</p>

      <p>이렇게 여러 개의 입력 변수나 출력 변수가 사용될 경우 <span>tbESQL</span>/COBOL 프로그램에서도 COBOL 프로그래밍 언어에서처럼 여러 개의
      변수를 묶어 하나의 구조체로 사용할 수 있다.</p>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
        <p>입/출력 구조체 변수에 대한 자세한 내용은 <a href="ch02.html#sect_struct" title="2.3.6. 구조체">“2.3.6. 구조체”</a>를
        참고한다.</p>
      </div>

      <div class="literallayout"><p/></div>

      <h4><a id="d5e562"/>배열 변수<a id="d5e563" class="indexterm"/></h4>

      <p>SELECT 문장을 실행한 결과의 로우 개수는 대개의 경우 하나 이상이며, INSERT 문장을 실행할 때에도 보통 하나
      이상의 로우를 삽입하게 된다. 이때 각각의 로우에 대해 개별적으로 SQL 문장을 여러 번 실행하지 않고, 출력 변수나 입력 변수를
      배열로 선언하여 SQL 문장을 한 번만 실행할 수도 있다.</p>

      <p>출력 변수나 입력 변수를 배열로 선언한 경우 각각을 출력 배열 변수, 입력 배열 변수라고 부른다. 또한 이 두 가지
      변수를 한꺼번에 지칭할 때는 입/출력 배열 변수라고 한다.</p>

      <p>출력 배열 변수를 이용하여 SELECT 문장을 실행하는 경우 각 결과 로우는 결과 로우의 개수와 동일한 크기를 갖는
      출력 배열 변수에 저장된다.</p>

      <p><span>tbESQL</span>/COBOL 프로그램에서는 하나 이상의 결과 로우가 반환되는
      SELECT 문장에 출력 배열 변수나 커서를 사용하지 않으면 에러를 반환한다. 구조체도 배열 변수로 선언하여 사용할 수 있으며,
      이를 구조체 배열 변수라고 부른다.</p>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
        <p>입/출력 배열 변수와 구조체 배열 변수에 대한 자세한 내용은 <a href="chapter_array_variable.html" title="제4장 배열 변수">“제4장 배열 변수”</a>를 참고한다.</p>
      </div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e573"/>1.2.4. 커서</h3></div></div></div>
      

      <p><span><strong class="guibutton">커서</strong></span><a id="d5e577" class="indexterm"/>는 SELECT 문장을 실행한 결과로 반환된 다수의 로우 각각에 차례대로 액세스하는 데이터
      구조이다.</p>

      <p>SELECT 문장을 실행한 결과로 반환되는 로우의 개수는 기본 키에 대한 질의가 아니라면 대부분 하나 이상이다. 또한
      반환되는 로우의 개수를 미리 알 수 없는 경우가 많기 때문에 SELECT 문장의 INTO 절에 변수를 하나만 명시해서는 모든
      로우의 데이터를 저장할 수 없다.</p>

      <p>이러한 경우에 프로그램을 보다 간편하고 편리하게 작성하기 위해 앞 절에서 설명한 배열 변수를 사용할 수도 있지만 커서를
      사용할 수도 있다.</p>

      <div class="literallayout"><p/></div>

      <p>커서를 사용하는 방법 및 순서는 다음과 같다.</p>

      <div class="orderedlist"><ol type="1" compact="compact"><li>
          <p>DECLARE CURSOR를 이용하여 커서를 선언한다.</p>
        </li><li>
          <p>OPEN을 실행하여 커서를 연다. 커서를 열면, 연관된 SQL 문장이 실행되고 질의의 결과가
          반환된다.</p>
        </li><li>
          <p>FETCH를 실행한다. FETCH를 실행할 때마다 하나 또는 그 이상의 결과 로우를 얻을 수 있다. 커서는 항상
          현재 처리 중인 로우를 가리킨다.</p>
        </li><li>
          <p>모든 결과 로우에 대한 FETCH를 실행한 후에는 CLOSE를 실행하여 커서를 닫는다.</p>
        </li></ol></div>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
        <p>자세한 내용은 <a href="ch03.html#sect_cursor" title="3.4. 커서">“3.4. 커서”</a>를 참고한다.</p>
      </div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e595"/>1.2.5. 프리컴파일러</h3></div></div></div>
      

      <p><span>tbESQL</span>/COBOL 프로그램 내에는 COBOL 프로그래밍 언어와 <span>tbESQL</span>/COBOL 문장이 함께 포함되어 있다. <span>tbESQL</span>/COBOL 문장은 COBOL 프로그래밍 언어의 문법을 따르지 않기
      때문에, <span>tbESQL</span>/COBOL 프로그램을 컴파일하기 전에 적절한 처리를 해야
      한다.</p>

      <p>이러한 컴파일 이전의 처리 과정을 <span><strong class="guibutton">프리컴파일</strong></span>(Precompile)이라고 하며,
      그때 사용하는 유틸리티를 <span><strong class="guibutton">프리컴파일러</strong></span>(Precompiler)라고 부른다.
      <a id="d5e605" class="indexterm"/><a id="d5e607" class="indexterm"/><a id="d5e609" class="indexterm"/><a id="d5e611" class="indexterm"/></p>

      <p>프리컴파일러는 <span>tbESQL</span>/COBOL 프로그램에 포함된 <span>tbESQL</span>/COBOL 문장을 <span>tbESQL</span>/COBOL 라이브러리 함수로 호출할 수 있는 COBOL 프로그래밍
      언어의 소스 코드로 변환해준다.</p>

      <p>이러한 과정을 위해서 <span>tbESQL</span>/COBOL에서는 다음과 같은 함수를 정의하고 있다.</p>

      <pre class="programlisting">esql_do( )</pre>

      <p>이 함수의 파라미터로는 SQL 문장과 입/출력 변수의 정보가 포함된다.</p>

      <div class="literallayout"><p/></div>

      <p>다음은 <span>tbESQL</span>/COBOL 프로그램의 컴파일 과정을 나타내는 그림이다.</p>

      <div class="figure"><a id="figure_tbcesql_program_compile"/><p class="title"><b>[그림 1.1] <span>tbESQL</span>/COBOL 프로그램 컴파일 과정</b></p><div class="figure-contents">
        

        <div xmlns="" class="mediaobject" align="left"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="600"><tr><td align="left"><img src="resources/img_esql_01.png" align="top" width="600" alt="tbESQL/COBOL 프로그램 컴파일 과정"/></td></tr></table></div>
      </div></div><br class="figure-break"/>

      <p><span>tbESQL</span>/COBOL 프로그램의 컴파일 과정은 크게 두 가지 과정으로 나눌 수
      있다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프리컴파일(Precompile)</p>

          <p><span>tbESQL</span>/COBOL 프로그램을 작성하여 프리컴파일 과정을 거치고 나면
          COBOL 프로그래밍 언어로만 구성된 소스 코드가 생성된다. 생성된 소스 코드는
          <span><strong class="guibutton">.cob</strong></span> 확장자를 가진 파일의 형태로 저장된다.</p>
        </li><li>
          <p>컴파일(Compile)</p>

          <p>프리컴파일 과정을 거친 프로그램은 다시 컴파일 과정을 거치게 되고 최종적으로 실행 파일이 생성된다.</p>
        </li></ul></div>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="about.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch02.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">안내서에 대하여 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제2장 데이터 타입</td></tr></table></div><div xmlns="" align="center"/></body></html>