<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Appendix A. tbJDBC 예제</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero 애플리케이션 개발자 안내서"/><link rel="up" href="index.html" title="Tibero 애플리케이션 개발자 안내서"/><link rel="prev" href="chapter_collection_type.html" title="제7장 컬렉션 타입의 사용"/><link rel="next" href="appendix_b.html" title="Appendix B. Tibero와 Tuxedo 연동 예제"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">Appendix A. <span xmlns="http://www.w3.org/1999/xhtml">tbJDBC</span> 예제</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chapter_collection_type.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="appendix_b.html">다음</a></td></tr></table><hr/></div><div class="appendix" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="appendix_a"/>Appendix A. <span>tbJDBC</span> 예제</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="appendix_a.html#d5e3032">A.1. JdbcTest.class</a></span></dt></dl></div>
  

  <p>본 장에서는 <span>tbJDBC</span>를 이용하여 작성한 기본 프로그램의 전체 소스 코드를 설명한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e3032"/>A.1. JdbcTest.class</h2></div></div></div>
    

    <p>다음은 <span>tbJDBC</span>를 이용하여 <span><strong class="guibutton">JdbcTest 클래스
    파일</strong></span>을 작성한 프로그램 소스 코드이다.</p>

    <pre class="programlisting">import java.sql.CallableStatement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.Types;<span><strong class="guibutton">

public class JdbcTest</strong></span>
{
    Connection conn;

    <span><strong class="guibutton">public static void main(String[] args) throws Exception</strong></span>
    {
        JdbcTest test = new JdbcTest();

        test.connect();                  
        test.executeStatement();             
        test.executePreparedStatement();     
        test.executeCallableStatement();     
        test.disconnect();                   
    }
  
    private void <span><strong class="guibutton">connect()</strong></span> throws ClassNotFoundException
    {
        Class.forName("com.<span>tmax.tibero</span>.jdbc.TbDriver");

        try {
            conn = DriverManager.getConnection(
                    "jdbc:<span>tibero</span>:thin:@localhost:8629:<span>tibero</span>", "<span>tibero</span>", "<span>tmax</span>");
        } catch (SQLException e) {
            System.out.println("connection failure!");
            System.exit(-1);
        }
        System.out.println("Connection success!");
    }

    private void <span><strong class="guibutton">executeStatement()</strong></span> throws SQLException
    {
        String dropTable   = "drop table emp";
        String createTable = "create table emp (id   number, "+
                             " name varchar(20), salary number)";
        String InsertTable = "insert into emp values(1000, 'Park', 5000)";

        Statement stmt = conn.createStatement();

        try {
            stmt.executeUpdate(dropTable);
         } catch(SQLException e) {
           // if there is not the table
         }

         stmt.executeUpdate(createTable);    
         stmt.executeUpdate(InsertTable);

         stmt.close();
    }

    private void <span><strong class="guibutton">executePreparedStatement()</strong></span> throws SQLException
    {
        PreparedStatement pstmt = conn
        .prepareStatement("select name from emp where id = ?");

        pstmt.setString(1, "1000");

        ResultSet rs = pstmt.executeQuery();

        while (rs.next()) {
            System.out.println(rs.getString(1));
        }
        pstmt.close();
    }

    private void <span><strong class="guibutton">executeCallableStatement()</strong></span> throws SQLException
    {
        String callSQL = " CREATE PROCEDURE testProc "+
                         " (ID_VAL IN NUMBER, SAL_VAL IN OUT NUMBER) as " + 
                         " BEGIN" +
                         "   update emp" +
                         "      set salary = SAL_VAL" +
                         "    where id = ID_VAL;" + 
                         "   select salary into SAL_VAL" +
                         "     from emp" +
                         "    where id = ID_VAl;" +
                         " END;";

        String dropProc = "DROP PROCEDURE testProc";

        Statement stmt = conn.createStatement();

        try {
            stmt.executeUpdate(dropProc);
        } catch(SQLException e) {
            // if there is not the procedure
        }
        
        stmt.executeUpdate(callSQL);

        CallableStatement cstmt = conn.prepareCall("{call testProc(?, ?)}");
        cstmt.setInt(1, 1000);
        cstmt.setInt(2, 7000);
        cstmt.registerOutParameter(2, Types.INTEGER);
        cstmt.executeUpdate();

        int salary = cstmt.getInt(2);
        System.out.println(salary);

        stmt.close();
        cstmt.close();
    }

    private void <span><strong class="guibutton">disconnect()</strong></span> throws SQLException
    {
        if (conn != null)    
            conn.close();
    }
}</pre>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chapter_collection_type.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="appendix_b.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제7장 컬렉션 타입의 사용 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> Appendix B. <span>Tibero</span>와 Tuxedo 연동 예제</td></tr></table></div><div xmlns="" align="center"/></body></html>