<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제3장 공간 인덱스</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero Spatial 참조 안내서"/><link rel="up" href="index.html" title="Tibero Spatial 참조 안내서"/><link rel="prev" href="chapter_02.html" title="제2장 Spatial 구조"/><link rel="next" href="chapter_04.html" title="제4장 Spatial 함수"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제3장 공간 인덱스</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chapter_02.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="chapter_04.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="chapter_03"/>제3장 공간 인덱스<a id="d5e706" class="indexterm"/></h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="chapter_03.html#d5e710">3.1. 공간 인덱스 생성</a></span></dt><dd><dl><dt><span class="section"><a href="chapter_03.html#d5e750">3.1.1. 공간 인덱스 제약 사항</a></span></dt></dl></dd><dt><span class="section"><a href="chapter_03.html#d5e807">3.2. 공간 인덱스 제거</a></span></dt></dl></div>
  

  <p><span>Tibero</span> Spatial에서는 공간 질의 성능 향상을 위해 RTREE 방식으로 구현된
  공간 인덱스를 제공한다. 좌표계에 따라 평면 좌표계, 회전타원체 좌표계에 대한 인덱스를 제공한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e710"/>3.1. 공간 인덱스 생성</h2></div></div></div>
    

    <p>공간 인덱스 생성 방법과 제약에 대해서 설명한다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>사용법</p>

        <p/>

        <pre class="programlisting">CREATE INDEX <span class="emphasis"><em>index_name</em></span> on [<span class="emphasis"><em>schema_name</em></span>.]
             <span class="emphasis"><em>table_name</em></span> ON <span class="emphasis"><em>col_name</em></span> RTREE</pre>

        <div class="informaltable">
          <table border="1"><colgroup><col width="120" align="left"/><col/></colgroup><thead><tr><th align="left">항목</th><th>설명</th></tr></thead><tbody><tr><td align="left">index_name</td><td>생성할 공간인덱스의 이름이다.</td></tr><tr><td align="left">schema_name</td><td>인덱스를 생성할 대상 테이블의 소유자이다.</td></tr><tr><td align="left">table_name</td><td>인덱스를 생성할 대상 테이블을 설정한다.</td></tr><tr><td align="left">col_name</td><td>인덱스를 생성할 대상을 설정한다. 컬럼은 GEOMETRY TYPE이어야 한다.</td></tr><tr><td align="left">RTREE</td><td>RTREE 인덱스로 생성함을 의미하는 예약어를 설정한다.</td></tr></tbody></table>
        </div>
      </li><li>
        <p>예제</p>

        <pre class="programlisting">SQL&gt;CREATE TABLE GIS (ID INTEGER PRIMARY KEY, GEOM GEOMETRY);
Table 'GIS' created.
SQL&gt;CREATE INDEX RT_IDX_GIS ON GIS(GEOM) RTREE;
Index 'RT_IDX_GIS' created.

INSERT INTO GIS VALUES (101, ST_GEOMFROMTEXT('POINT(1 1)'));
INSERT INTO GIS VALUES (102, ST_GEOMFROMTEXT('MULTIPOINT(1 1, 2 2)'));
INSERT INTO GIS VALUES (103, ST_GEOMFROMTEXT('LINESTRING(1 1, 2 2)'));
INSERT INTO GIS VALUES (104, ST_GEOMFROMTEXT('MULTILINESTRING((1 1, 2 2), 
(3 3, 4 5))'));
INSERT INTO GIS VALUES (105, ST_GEOMFROMTEXT('POLYGON((1 1, 2 1, 2 2, 1 2,
1 1))'));
INSERT INTO GIS VALUES (106, ST_GEOMFROMTEXT('POLYGON((0 0, 0 12, 12 12, 12 0,0 0), 
(6 10, 6 11, 9 11, 9 10,6 10), (6 3, 6 6, 9 6, 9 3,6 3))'));
INSERT INTO GIS VALUES (107, ST_GEOMFROMTEXT('MULTIPOLYGON(((1 1, 2 1, 2 2, 1 2, 1 1)), 
((3 3, 3 5, 5 5, 5 3, 3 3)))'));
INSERT INTO GIS VALUES (108, ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(1 1), 
LINESTRING(2 2, 3 3))'));
INSERT INTO GIS VALUES (109, ST_BOUNDARY(ST_GEOMFROMTEXT('POINT(10 10)')));
INSERT INTO GIS VALUES (110, ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(1 1), 
LINESTRING(2 2, 3 3))')); 
COMMIT;      </pre>
      </li></ul></div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e750"/>3.1.1. 공간 인덱스 제약 사항</h3></div></div></div>
      

      <p>공간 인덱스는 다음과 같은 경우에 제약을 가진다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>여러 컬럼에 대해 하나의 인덱스를 걸 수 없다.</p>
        </li><li>
          <p>공간 인덱스는 파티션될 수 없다.</p>
        </li><li>
          <p>공간 인덱스는 GEOMETRY TYPE이 아닌 컬럼에 대하여 생성할 수 없다.</p>
        </li><li>
          <p>SQL의 WHERE 절에 다음의 함수를 구현하였을 때만 공간 인덱스의 사용이 가능하다.</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>ST_CONTAINS</p>
            </li><li>
              <p>ST_COVEREDBY</p>
            </li><li>
              <p>ST_COVERS</p>
            </li><li>
              <p>ST_CROSSES</p>
            </li><li>
              <p>ST_DWITHIN</p>
            </li><li>
              <p>ST_EQUALS</p>
            </li><li>
              <p>ST_INTERSECTS</p>
            </li><li>
              <p>ST_OVERLAPS</p>
            </li><li>
              <p>ST_TOUCHES</p>
            </li><li>
              <p>ST_WITHIN</p>
            </li></ul></div>
        </li><li>
          <p>회전타원체 좌표계의 공간 인덱스는 해당 테이블의 GEOMETRY 컬럼에 제약 조건을 추가하여 생성
          가능하다.</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>사용법</p>

              <p/>

              <pre class="programlisting">ALTER TABLE table_name ADD CONSTRAINTS
                constraint_name CHECK(ST_SRID(col_name)=srid);</pre>
            </li><li>
              <p>예제</p>

              <pre class="programlisting">SQL&gt;DROP INDEX RT_IDX_GIS;
Index 'RT_IDX_GIS' dropped.
SQL&gt;UPDATE GIS SET GEOM=ST_SETSRID(GEOM,4326);
10 rows updated.
SQL&gt;ALTER TABLE GIS ADD CONSTRAINTS SRID4326 CHECK(ST_SRID(GEOM)=4326);
Table 'GIS' altered.
SQL&gt;CREATE INDEX RT_IDX_4326 ON GIS(GEOM) RTREE;
Index 'RT_IDX_4326' created.
COMMIT;      </pre>
            </li></ul></div>
        </li><li>
          <p>기존의 GEOMETRY 컬럼의 좌표계를 변경하여 공간 인덱스를 생성해야할 경우, 기존의 제약조건이 있다면 이를
          삭제하고 GEOMETRY들의 SRID를 변경한 후, 해당 SRID에 대한 제약조건을 추가하여 공간 인덱스를
          생성한다.</p>

          <div class="itemizedlist"><ul type="circle" compact="compact"><li>
              <p>사용법</p>

              <p/>

              <pre class="programlisting">ALTER TABE table_name DROP CONSTRAINTS constraint_name;
              </pre>
            </li><li>
              <p>예제</p>

              <pre class="programlisting">SQL&gt;DROP INDEX RT_IDX_4326;
Index 'RT_IDX_4326' dropped.
SQL&gt;ALTER TABE GIS DROP CONSTRAINTS SRID4326;
Table 'GIS' altered.
SQL&gt;UPDATE GIS SET GEOM=ST_SETSRID(GEOM,0);
10 rows updated.
SQL&gt;ALTER TABLE GIS ADD CONSTRAINTS SRID4326 CHECK(ST_SRID(GEOM)=0);
Table 'GIS' altered.
SQL&gt;CREATE INDEX RT_IDX_GIS ON GIS(GEOM) RTREE;
Index 'RT_IDX_GIS' created.
COMMIT;      </pre>
            </li></ul></div>
        </li></ul></div>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e807"/>3.2. 공간 인덱스 제거</h2></div></div></div>
    

    <p>공간 인덱스의 제거는 다른 인덱스와 동일하다.</p>

    <p/>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>사용법</p>

        <pre class="programlisting">DROP INDEX <span class="emphasis"><em>index_name</em></span></pre>

        <div class="informaltable">
          <table border="1"><colgroup><col width="120" align="left"/><col/></colgroup><thead><tr><th align="left">항목</th><th>설명</th></tr></thead><tbody><tr><td align="left">index_name</td><td>삭제할 공간 인덱스의 이름이다.</td></tr></tbody></table>
        </div>
      </li></ul></div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chapter_02.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="chapter_04.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제2장 Spatial 구조 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제4장 Spatial 함수</td></tr></table></div><div xmlns="" align="center"/></body></html>