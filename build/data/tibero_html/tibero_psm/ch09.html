<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제9장 파이프라인드 테이블 함수</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero tbPSM 안내서"/><link rel="up" href="index.html" title="Tibero tbPSM 안내서"/><link rel="prev" href="chapter_error.html" title="제8장 에러 처리"/><link rel="next" href="ch10.html" title="제10장 오브젝트 타입"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제9장 파이프라인드 테이블 함수</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chapter_error.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="ch10.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="d5e4502"/>제9장 파이프라인드 테이블 함수</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="ch09.html#d5e4505">9.1. 개요</a></span></dt><dt><span class="section"><a href="ch09.html#d5e4526">9.2. 함수</a></span></dt></dl></div>
  

  <p>본 장에서는 파이프라인드 방식으로 데이터를 처리할 수 있는 파이프라인드 테이블 함수를 설명한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e4505"/>9.1. 개요</h2></div></div></div>
    

    <p><span><strong class="guibutton">파이프라인드 테이블 함수</strong></span>(Pipelined Table Functions)는
    <span>tbPSM</span>의 서브 프로그램을 관계형 테이블과 같이 로우의 형태로 결과를 반환하는
    함수이다. 이 함수는 SQL 문장의 FROM 절에 사용할 수 있으며, IN 모드로 파라미터를 지정하고 결과 집합으로 반환하도록 구성할
    수 있다.<a id="d5e4510" class="indexterm"/></p>

    <p>파이프라인드 테이블 함수를 사용하면 다음과 같은 장점이 있다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>응답 시간(Response Time)</p>

        <p>결과 집합이 모두 생성될 때까지 기다리지 않고 완료된 부분 결과 집합을 순차적으로 처리할 수 있으므로, 연산의 응답
        시간이 빠르다.</p>
      </li><li>
        <p>스트리밍(Streaming)</p>

        <p>하나의 연산을 종료하지 않고 일련의 연산을 순차적으로 반복하여 처리할 수 있다.</p>
      </li><li>
        <p>파이프라이닝(Pipelining)</p>

        <p>여러 가지 연산을 연속해서 수행할 수 있다.</p>
      </li><li>
        <p>유연성(Flexibility)</p>

        <p>SQL 문장으로 표현하기 어려운 과정을 필터를 적용한 것처럼 유연하게 처리할 수 있다.</p>
      </li></ul></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e4526"/>9.2. 함수</h2></div></div></div>
    

    <p>파이프라인드 테이블로 만들 수 있는 것은 단독 함수(Standalone Function)뿐이다. 따라서 로컬
    함수(Local Function), 패키지의 멤버 함수 등은 파이프라인드 테이블 함수로 만들 수 없다.</p>

    <p>파이프라인드 테이블 함수의 세부 내용은 다음과 같다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>프로토타입</p>

        <pre class="programlisting">CREATE TABLE tblname(m1 NUMBER, m2 NUMBER)
/

CREATE OR REPLACE PACKAGE pkg IS
TYPE tbl_rec IS TABLE OF tblname%ROWTYPE;
END;
/

CREATE OR REPLACE FUNCTION PTF(limit IN NUMBER)
RETURN pkg.tbl_rec PIPELINED
AS
  x tblname%ROWTYPE;
BEGIN
  FOR i IN 1 .. limit LOOP
  x.m1 := i;
  x.m2 := i+1;
  PIPE ROW(X);
  END LOOP;
END;
/
select * from TABLE(ptf(1000)) where m1 = 500
/</pre>

        <p/>
      </li><li>
        <p>파라미터</p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">IN</td><td>IN 모드만 사용할 수 있다. 따라서 OUT, INOUT 모드는 사용할 수 없다.</td></tr></tbody></table>
        </div>
      </li><li>
        <p>반환값</p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">반환값</th><th>설명</th></tr></thead><tbody><tr><td align="left">배열 또는 테이블</td><td><p>배열이나 테이블로 반환해야 하며, 인덱스 테이블로는 반환할 수
                없다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                      <p>컬렉션의 원소는 데이터베이스 타입이거나, 데이터베이스 타입으로 구성된 레코드 타입이어야
                      한다.</p>
                    </li><li style="list-style-type: circle">
                      <p>일반 함수와는 다르게 RETURN 문을 사용할 수 없다. 하지만 <span>tbPSM</span> 프로그램의 흐름을 위해 값이 없는
                      RETURN 문은 사용할 수 있다.</p>
                    </li></ul></div></td></tr></tbody></table>
        </div>
      </li><li>
        <p>예제</p>

        <p>파이프라인드 테이블 함수는 <span><strong class="guibutton">PIPELINED</strong></span>라는 키워드를 이용하여 지정할
        수 있다. 예를 들면 다음과 같다.</p>

        <pre class="programlisting">CREATE PACKAGE PKG IS 
  TYPE rec IS RECORD(m1 NUMBER, m2 VARCHAR2(100));
  TYPE tbl_rec IS TABLE OF rec;
END;
/
CREATE FUNCTION pipelined_table_func
RETURN PKG.TBL_REC PIPELINED
AS
x PKG.REC;
BEGIN 
  FOR i IN 1 .. 1000 LOOP
    x.m1 := i;
    x.m2 := 'abc';

    PIPE ROW(x);
  END LOOP;
END;
/

select * from TABLE(pipelined_table_func()) where m1 = 500
/</pre>
      </li></ul></div>

    <p/>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chapter_error.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch10.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제8장 에러 처리 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제10장 오브젝트 타입</td></tr></table></div><div xmlns="" align="center"/></body></html>