<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제7장 Row Set</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero JDBC 개발자 안내서"/><link rel="up" href="index.html" title="Tibero JDBC 개발자 안내서"/><link rel="prev" href="ch06.html" title="제6장 결과 집합 확장기능"/><link rel="next" href="ch08.html" title="제8장 LOB 데이터 처리"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제7장 Row Set</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch06.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="ch08.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="d5e2631"/>제7장 Row Set</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="ch07.html#d5e2635">7.1. 개요</a></span></dt><dt><span class="section"><a href="ch07.html#d5e2658">7.2. Row Set Listener</a></span></dt><dt><span class="section"><a href="ch07.html#d5e2699">7.3. Cached Row Set</a></span></dt><dd><dl><dt><span class="section"><a href="ch07.html#d5e2706">7.3.1. RowSet 객체 생성</a></span></dt><dt><span class="section"><a href="ch07.html#d5e2745">7.3.2. 열 데이터 탐색</a></span></dt><dt><span class="section"><a href="ch07.html#d5e2755">7.3.3. 제약 사항</a></span></dt></dl></dd></dl></div>
  

  <p>본 장에서는 <span>tbJDBC</span>에서 제공하는 Row Set 기능을 설명한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e2635"/>7.1. 개요</h2></div></div></div>
    

    <p>Row Set<a id="d5e2638" class="indexterm"/>이란 문자 그대로 로우 데이터의 집합을 포함하는 객체이다. javax.sql.RowSet 인터페이스 메소드를
    통해 접근할 수 있다.</p>

    <p>일반적으로 Row Set은 다음과 같이 세 가지로 나뉜다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p>Cached Row Set<a id="d5e2644" class="indexterm"/><span>(tbJDBC</span>에서는 현재 이 Row Set만 제공한다.)</p>
      </li><li>
        <p>JDBC Row Set<a id="d5e2650" class="indexterm"/></p>
      </li><li>
        <p>Web Row Set<a id="d5e2655" class="indexterm"/></p>
      </li></ul></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e2658"/>7.2. Row Set Listener<a id="d5e2660" class="indexterm"/></h2></div></div></div>
    

    <p>Row Set에서는 여러 개의 리스너를 등록하여 사용할 수 있다. 등록할 때는 addRowSetListener() 메소드를
    사용하고, 제거할 때는 removeRowSetListener() 메소드를 사용하면 된다. 이때 사용되는 리스너는 반드시
    javax.sql.RowSetListener 인터페이스를 통해서 구현되어야 한다.</p>

    <p>RowSetListener 인터페이스에서 제공하는 이벤트는 다음과 같이 3가지이다.</p>

    <div class="informaltable">
      <table border="1"><colgroup><col width="130" align="left"/><col/></colgroup><thead><tr><th align="left">이벤트</th><th>설명</th></tr></thead><tbody><tr><td align="left">cursorMoved<a id="d5e2674" class="indexterm"/></td><td>next()나 previous() 등의 메소드를 통해 열의 이동이 있을 때 마다 발생한다.</td></tr><tr><td align="left">rowChanged<a id="d5e2680" class="indexterm"/></td><td>새로운 열이 추가되거나 기존의 열이 수정되거나 삭제될 때 발생한다.</td></tr><tr><td align="left">rowSetChanged<a id="d5e2686" class="indexterm"/></td><td>전체 Row Set이 생성되거나 변경될 때 발생한다.</td></tr></tbody></table>
    </div>

    <div class="literallayout"><p/></div>

    <p>RowSetListener 인터페이스의 이벤트를 사용하는 방법은 다음의 예와 같다.</p>

    <div class="orderedlist"><ol type="1"><li>
        <p>리스너 클래스를 생성한다.</p>

        <pre class="programlisting">public class MyListener implements RowSetListener
{
    public void cursorMoved(RowSetEvent event) {
        // do work
    }
    public void rowChanged(RowSetEvent event) {
        // do work
    }
    public void rowSetChanged(RowSetEvent event) {
        // do work
    }
}</pre>
      </li><li>
        <p>리스너를 RowSet 객체에 등록한다.</p>

        <pre class="programlisting">MyListener mListener = new MyListener();
rowset.addRowSetListener(mListener);</pre>
      </li></ol></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e2699"/>7.3. Cached Row Set<a id="d5e2701" class="indexterm"/></h2></div></div></div>
    

    <p>Cached Row Set은 모든 열을 캐시에 저장하고, 데이터베이스와의 연결을 유지하지 않도록 구현된 Row Set의 한
    형태이다. <span>tbJDBC</span>에서는 <span>Tb</span>CachedRowSet 클래스로 제공된다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2706"/>7.3.1. RowSet 객체 생성</h3></div></div></div>
      

      <p>RowSet 객체는 execute() 메소드를 통해 사용할 수 있는 준비를 마치며, 그 이후에는
      java.sql.ResultSet 객체를 사용하는 방법과 동일하게 사용할 수 있다.</p>

      <p>본 절에서는 RowSet 객체를 생성하는 과정을 두 가지로 나누어 설명한다.</p>

      <div class="literallayout"><p/></div>

      <h4><a id="d5e2711"/>질의문을 이용한 RowSet 객체 생성</h4>

      <p>다음의 예는 질의문을 이용하여 RowSet 객체를 생성하는 과정이다.<a id="d5e2713" class="indexterm"/></p>

      <div class="orderedlist"><ol type="1"><li>
          <p><span>Tb</span>CachedRowSet 객체를 생성한다.</p>

          <pre class="programlisting"><span>Tb</span>CachedRowSet rowset = new <span>Tb</span>CachedRowSet();</pre>
        </li><li>
          <p>URL, 사용자 이름, 패스워드, 질의문을 설정한 후에 execute() 메소드를 수행하여 RowSet 객체를
          생성한다.</p>

          <pre class="programlisting">rowset.setUrl("jdbc:<span>tibero</span>:thin:@localhost:8629:dbsvr");
rowset.setUsername("<span>tibero</span>");
rowset.setPassword("<span>tmax</span>");
rowset.setCommand("SELECT * FROM emp");
rowset.execute();</pre>
        </li></ol></div>

      <div class="literallayout"><p/></div>

      

      <h4><a id="d5e2730"/>결과 집합을 이용한 RowSet 객체 생성</h4>

      <p>다음의 예는 기존에 존재하는 결과 집합을 이용하여 RowSet 객체를 생성하는 과정이다.<a id="d5e2732" class="indexterm"/></p>

      <div class="orderedlist"><ol type="1"><li>
          <p><span>Tb</span>CachedRowSet 객체를 생성한다.</p>

          <pre class="programlisting"><span>Tb</span>CachedRowSet rowset = new <span>Tb</span>CachedRowSet();</pre>
        </li><li>
          <p>결과 집합 객체(rset)를 이용하여 populate() 메소드를 수행하여 RowSet 객체를
          생성한다.</p>

          <pre class="programlisting">ResultSet rset = pstmt.executeQuery();
rowset.populate(rset);</pre>
        </li></ol></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2745"/>7.3.2. 열 데이터 탐색</h3></div></div></div>
      

      <p>RowSet 객체를 이용하여 정방향이나 역방향으로 이동하면서 열의 데이터를 탐색할 수 있다.</p>

      <p>예를 들면 다음과 같다.</p>

      <pre class="programlisting">rowset.beforeFirst();
while (rowset.next()) {
    System.out.println(rowset.getString(1));
}

rowset.afterLast();
while (rowset.previous()) {
    System.out.println(rowset.getString(1));
}</pre>

      <div class="literallayout"><p/></div>

      <p>또한 열의 데이터를 삽입, 삭제, 수정할 수도 있다. 단, acceptChanges() 메소드를 수행해야 커밋이
      실행된다.</p>

      <p>예를 들면 다음과 같다.</p>

      <pre class="programlisting">rowset.absolute(5);
rowset.moveToInsertRow();
rowset.updateString(1, "<span>tibero</span>");
rowset.insertRow();
rowset.acceptChanges();</pre>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2755"/>7.3.3. 제약 사항</h3></div></div></div>
      

      <p>Updatable 결과 집합에 적용되는 제약 사항과 동일하게 적용된다.</p>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch06.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch08.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제6장 결과 집합 확장기능 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제8장 LOB 데이터 처리</td></tr></table></div><div xmlns="" align="center"/></body></html>