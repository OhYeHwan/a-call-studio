<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제32장 DBMS_RLS</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero tbPSM 참조 안내서"/><link rel="up" href="index.html" title="Tibero tbPSM 참조 안내서"/><link rel="prev" href="chap_dbms_result_cache.html" title="제31장 DBMS_RESULT_CACHE"/><link rel="next" href="chap_dbms_rowid.html" title="제33장 DBMS_ROWID"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제32장 DBMS_RLS</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chap_dbms_result_cache.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="chap_dbms_rowid.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="chap_dbms_rls"/>제32장 DBMS_RLS</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="chap_dbms_rls.html#d5e12162">32.1. 개요</a></span></dt><dt><span class="section"><a href="chap_dbms_rls.html#d5e12176">32.2. 프러시저와 함수</a></span></dt><dd><dl><dt><span class="section"><a href="chap_dbms_rls.html#DBMS_RLS_ADD_POLICY">32.2.1. ADD_POLICY</a></span></dt><dt><span class="section"><a href="chap_dbms_rls.html#DBMS_RLS_DROP_POLICY">32.2.2. DROP_POLICY</a></span></dt><dt><span class="section"><a href="chap_dbms_rls.html#DBMS_RLS_ENABLE_POLICY">32.2.3. ENABLE_POLICY</a></span></dt><dt><span class="section"><a href="chap_dbms_rls.html#DBMS_RLS_REFRESH_POLICY">32.2.4. REFRESH_POLICY</a></span></dt></dl></dd></dl></div>
  

  <p>본 장에서는 DBMS_RLS 패키지의 기본 개념과 패키지 내의 프러시저와 함수를 사용하는 방법을 설명한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e12162"/>32.1. 개요</h2></div></div></div>
    

    <p><span><strong class="guibutton">DBMS_RLS</strong></span><a id="d5e12166" class="indexterm"/> 패키지는 <span>Tibero</span>의 가상 개인 데이터베이스 기능을 구성하고 관리하는 데 사용할 수 있는
    프러시저와 함수를 제공한다.</p>

    <p>가상 개인 데이터베이스에서는 테이블, 뷰, 동의어에 대해 동적으로 조건문을 생성하여 해당 스키마 객체에서 반환하는 로우에
    대한 접근을 선택적으로 제한한다. 동적 조건문은 문자열을 반환하는 PSM 함수를 통해 만들 수 있으며, 이 함수를 추가되는 보안
    정책과 연결시켜 줌으로써 정책이 구현된다. 다음의 예를 보자.</p>

    <pre class="programlisting">DBMS_RLS.ADD_POLICY ('scott', 'emp', 'pol1', 'secadm', 'emp_sec', 'select');</pre>

    <p>pol1이라는 정책을 통해서 scott 스키마의 emp 테이블을 select 할 때마다 <span>Tibero</span> 는 secadm의 emp_sec 함수를 호출하여 조건문을 동적으로 만들게
    되고, 그 조건문을 where 절로 추가하여 실제 select를 수행한다.</p>

    <p>동적 조건문을 생성하기 위해 현재의 상황(혹은 조건)을 조사할 필요가 생기는데, 이때 보통 애플리케이션 문맥 기능을
    이용한다. 해당 내용은 DBMS_SESSION 패키지 및 SYS_CONTEXT 내장 함수를 참조한다.</p>

    <p/>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e12176"/>32.2. 프러시저와 함수</h2></div></div></div>
    

    <p>본 절에서는 DBMS_RLS 패키지에서 제공하는 프러시저와 함수를 알파벳 순으로 설명한다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_RLS_ADD_POLICY"/>32.2.1. ADD_POLICY<a id="d5e12181" class="indexterm"/></h3></div></div></div>
      

      <p>해당 테이블, 뷰, 동의어에 대해 가상 개인 데이터베이스 보안 정책을 추가한다. 이 프러시저는 호출됨과 동시에 현재
      트랜잭션을 커밋시킨다.</p>

      <p>정책 함수는 다음의 함수 프로토타입에 맞추어 작성해야만 한다.</p>

      <pre class="programlisting">FUNCTION policy_function (object_schema IN VARCHAR2, object_name VARCHAR2) 
    RETURN VARCHAR2;</pre>

      <p>object_schema, object_name 에는 해당 정책을 적용한 테이블, 뷰, 동의어의 스키마 이름과 객체의
      이름이 전달된다.</p>

      <p/>

      <div class="literallayout"><p/></div>

      <p>ADD_POLICY 프러시저<a id="d5e12191" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">DBMS_RLS.ADD_POLICY 
(
    object_schema         IN VARCHAR2 DEFAULT NULL,
    object_name           IN VARCHAR2,
    policy_name           IN VARCHAR2,
    function_schema       IN VARCHAR2 DEFAULT NULL,
    policy_function       IN VARCHAR2,
    statement_types       IN VARCHAR2 DEFAULT NULL,
    update_check          IN BOOLEAN DEFAULT FALSE,
    enable                IN BOOLEAN DEFAULT TRUE,
    static_policy         IN BOOLEAN DEFAULT FALSE,
    policy_type           IN BINARY_INTEGER DEFAULT NULL,
    sec_relevant_cols     IN VARCHAR2 DEFAULT NULL,
    set_relevant_cols_opt IN BINARY_INTEGER DEFAULT NULL
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">object_schema</td><td>테이블, 뷰, 동의어를 가지고 있는 스키마이다. 명시하지 않으면 현재 사용자의
                  스키마이다.</td></tr><tr><td align="left">object_name</td><td>테이블, 뷰, 동의어의 이름이다.</td></tr><tr><td align="left">policy_name</td><td>새로 추가하고자 하는 정책의 이름이다. 해당 스키마 객체에 대해 유일해야 한다.</td></tr><tr><td align="left">function_schema</td><td>조건문 생성 함수의 스키마이다. 명시하지 않으면 현재 사용자의 스키마이다.</td></tr><tr><td align="left">policy_function</td><td>조건문 생성 함수의 이름이다. 패키지 내에 존재한다면 패키지 이름과 함께
                  명시한다.</td></tr><tr><td align="left">statement_types</td><td><p>정책을 적용할 SQL 문의 유형이다.</p><p>SELECT,
                  INSERT, UPDATE, DELETE의 조합을 명시할 수 있다. 기본값은 이 4개를 모두 명시한
                  것이다.</p></td></tr><tr><td align="left">update_check</td><td><p>INSERT, UPDATE일 경우에 적용된다. </p><p>TRUE일 경우
                  새로 insert되거나 update된 값이 정책의 조건문을 만족하는지 검사한다. (기본값:
                  FALSE)</p></td></tr><tr><td align="left">enable</td><td>정책을 추가함과 동시에 활성화시킬지 명시한다. (기본값: TRUE)</td></tr><tr><td align="left">static_policy</td><td><p>정책 유형을 설정한다. policy_type이 지정되지 않을 경우에만 유효하다.
                  </p><div class="itemizedlist"><ul type="circle" compact="compact"><li>
                        <p>TRUE : STATIC(기본값)</p>
                      </li><li>
                        <p>FALSE : DYNAMIC</p>
                      </li></ul></div></td></tr><tr><td align="left">policy_type</td><td><p>정책 유형을 설정한다. (기본값: NULL)</p><p>가능한 정책 유형
                  다음과 같다. </p><div class="itemizedlist"><ul type="circle" compact="compact"><li>
                        <p>STATIC : 반환되는 조건문이 운영 중의 상황과는 무관할 때 사용한다. 정책 함수는
                        최초 한번만 수행되며 그 결과는 공유 메모리에 저장된다.</p>
                      </li><li>
                        <p>SHARED_STATIC : STATIC과 동일하나 대상 스키마 객체와 무관하게 이전에
                        해당 정책 함수를 수행한 적이 있으면 그 결과를 재사용한다.</p>
                      </li><li>
                        <p>CONTEXT_SENSITIVE : SQL 문 수행할 때 애플리케이션 문맥이 바뀌었을
                        경우 정책 함수를 다시 수행한다. 저장된 조건문은 세션의 종료와 함께 삭제된다.</p>
                      </li><li>
                        <p>SHARED_CONTEXT_SENSITIVE : CONTEXT_SENSITIVE와
                        동일하나 대상 스키마 객체와 무관하게 이전에 해당 정책 함수를 수행한 적이 있으면 그 결과를
                        재사용한다.</p>
                      </li><li>
                        <p>DYNAMIC : 디폴트 정책 유형이다. 정책 함수를 항상 수행한다.</p>
                      </li></ul></div></td></tr><tr><td align="left">sec_relevant_cols</td><td><p>컬럼 레벨 VPD 기능을 활성화한다. </p><p>조건문 함수의 결과에
                  따라 값을 NULL로 가릴 컬럼들의 이름을 명시한다. 이름은 쉼표 혹은 공백 문자로 구분할 수 있다. 이
                  인자는 테이블 혹은 뷰에 대해 명시가 가능하며, 동의어에 대해서는 명시가 불가능하다.
                  </p><p>(기본값: NULL, 컬럼 레벨 VPD 기능을 사용하지
                  않음)</p></td></tr><tr><td align="left">sec_relevant_cols_opt</td><td><p>가능한 값은 NULL(디폴트) 혹은 dbms_rls.ALL_ROWS 둘 중 하나이다.
                  </p><p>set_relevant_cols 인자를 통해 컬럼 레벨 VPD 기능을 활성화시켰을
                  경우에 이 인자의 값은 dbms_rls.ALL_ROWS 이어야 하며, 그렇지 않을 경우에는 NULL이어야
                  한다.</p></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제</p>

          <pre class="programlisting">BEGIN
    DBMS_RLS.ADD_POLICY (
        object_schema=&gt;'scott',
        object_name=&gt;'emp',
        policy_name=&gt;'pol1',
        function_schema=&gt;'secadm',
        policy_function=&gt;'emp_sec',
        statement_types=&gt;'insert,update',
        policy_type=&gt;DBMS_RLS.CONTEXT_SENSITIVE);
END;
/</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_RLS_DROP_POLICY"/>32.2.2. DROP_POLICY<a id="d5e12277" class="indexterm"/></h3></div></div></div>
      

      <p>해당 테이블, 뷰, 동의어에 대해 걸려 있는 가상 개인 데이터베이스 보안 정책을 제거한다. 이 프러시저는 호출됨과
      동시에 현재 트랜잭션을 커밋시킨다.</p>

      <p/>

      <div class="literallayout"><p/></div>

      <p>DROP_POLICY 프러시저<a id="d5e12284" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">DBMS_RLS.DROP_POLICY 
(
    object_schema   IN VARCHAR2 DEFAULT NULL,
    object_name     IN VARCHAR2,
    policy_name     IN VARCHAR2
);
</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">object_schema</td><td>테이블, 뷰, 동의어를 가지고 있는 스키마이다. 명시하지 않으면 현재 사용자의
                  스키마이다.</td></tr><tr><td align="left">object_name</td><td>테이블, 뷰, 동의어의 이름이다.</td></tr><tr><td align="left">policy_name</td><td>제거하고자 하는 정책의 이름이다.</td></tr></tbody></table>
          </div>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_RLS_ENABLE_POLICY"/>32.2.3. ENABLE_POLICY<a id="d5e12311" class="indexterm"/></h3></div></div></div>
      

      <p>해당 테이블, 뷰, 동의어에 대해 걸려 있는 가상 개인 데이터베이스 보안 정책을 활성화 혹은 비활성화한다. 이
      프러시저는 호출됨과 동시에 현재 트랜잭션을 커밋시킨다.</p>

      <p/>

      <div class="literallayout"><p/></div>

      <p>ENABLE_POLICY 프러시저<a id="d5e12318" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">DBMS_RLS.ENABLE_POLICY 
(
    object_schema   IN VARCHAR2 DEFAULT NULL,
    object_name     IN VARCHAR2,
    policy_name     IN VARCHAR2,
    enable          IN BOOLEAN DEFAULT TRUE
); </pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">object_schema</td><td>테이블, 뷰, 동의어를 가지고 있는 스키마이다. 명시하지 않으면 현재 사용자의
                  스키마이다.</td></tr><tr><td align="left">object_name</td><td>테이블, 뷰, 동의어의 이름이다.</td></tr><tr><td align="left">policy_name</td><td>활성화 혹은 비활성할 정책의 이름이다.</td></tr><tr><td align="left">enable</td><td><div class="itemizedlist"><ul type="circle" compact="compact"><li>
                        <p>TRUE : 정책을 활성화한다.</p>
                      </li><li>
                        <p>FALSE : 정책을 비활성화한다.</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_RLS_REFRESH_POLICY"/>32.2.4. REFRESH_POLICY<a id="d5e12353" class="indexterm"/></h3></div></div></div>
      

      <p>이 프러시저를 호출하면 해당 보안 정책으로 인해 영향을 받았던 실행 계획들과 메모리에 저장되어 있던 정책 함수의
      결과들을 모두 무효화시킨다. 결과적으로 SQL 문이 다시 수행될 때 문장은 다시 파싱되며, 정책 함수는 다시 수행된다. 비활성화된
      정책에 대해 이 프러시저를 호출하면 에러가 반환된다.</p>

      <p/>

      <div class="literallayout"><p/></div>

      <p>REFRESH_POLICY 프러시저<a id="d5e12360" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">DBMS_RLS.REFRESH_POLICY 
(
    object_schema   IN VARCHAR2 DEFAULT NULL,
    object_name     IN VARCHAR2,
    policy_name     IN VARCHAR2
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">object_schema</td><td>테이블, 뷰, 동의어를 가지고 있는 스키마이다. 명시하지 않으면 현재 사용자의
                  스키마이다.</td></tr><tr><td align="left">object_name</td><td>테이블, 뷰, 동의어의 이름이다.</td></tr><tr><td align="left">policy_name</td><td>Refresh하고자 하는 정책의 이름이다.</td></tr></tbody></table>
          </div>
        </li></ul></div>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chap_dbms_result_cache.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="chap_dbms_rowid.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제31장 DBMS_RESULT_CACHE </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제33장 DBMS_ROWID</td></tr></table></div><div xmlns="" align="center"/></body></html>