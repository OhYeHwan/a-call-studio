<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>제38장 DBMS_SPH</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero tbPSM 참조 안내서"/><link rel="up" href="index.html" title="Tibero tbPSM 참조 안내서"/><link rel="prev" href="chap_dbms_space_admin.html" title="제37장 DBMS_SPACE_ADMIN"/><link rel="next" href="chap_dbms_sql.html" title="제39장 DBMS_SQL"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">제38장 DBMS_SPH</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chap_dbms_space_admin.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="chap_dbms_sql.html">다음</a></td></tr></table><hr/></div><div class="chapter" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="chap_dbms_sph"/>제38장 DBMS_SPH</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="chap_dbms_sph.html#d5e14187">38.1. 개요</a></span></dt><dt><span class="section"><a href="chap_dbms_sph.html#d5e14196">38.2. 프러시저</a></span></dt><dd><dl><dt><span class="section"><a href="chap_dbms_sph.html#DBMS_SPH_REPORT_PLANS">38.2.1. REPORT_PLANS</a></span></dt><dt><span class="section"><a href="chap_dbms_sph.html#DBMS_SPH_REPORT_PLANS_BY_DATE">38.2.2. REPORT_PLANS_BY_DATE</a></span></dt><dt><span class="section"><a href="chap_dbms_sph.html#DBMS_SPH_REPORT_PLAN_HISTORY">38.2.3. REPORT_PLAN_HISTORY</a></span></dt><dt><span class="section"><a href="chap_dbms_sph.html#DBMS_SPH_REPORT_PLAN_HISTORY_BY_DATE">38.2.4. REPORT_PLAN_HISTORY_BY_DATE</a></span></dt><dt><span class="section"><a href="chap_dbms_sph.html#DBMS_SPH_TRUNCATE_PLAN_HISTORY">38.2.5. TRUNCATE_PLAN_HISTORY</a></span></dt><dt><span class="section"><a href="chap_dbms_sph.html#DBMS_SPH_TRUNCATE_PLAN_HISTORY_BY_DATE">38.2.6. TRUNCATE_PLAN_HISTORY_BY_DATE</a></span></dt><dt><span class="section"><a href="chap_dbms_sph.html#DBMS_SPH_UPDATE_PLAN_HISTORY">38.2.7. UPDATE_PLAN_HISTORY</a></span></dt></dl></dd></dl></div>
  

  <p>본 장에서는 DBMS_SPH 패키지의 기본 개념과 패키지 내의 프러시저를 사용하는 방법을 설명한다.</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e14187"/>38.1. 개요</h2></div></div></div>
    

    <p><span><strong class="guibutton">DBMS_SPH</strong></span><a id="d5e14191" class="indexterm"/> 패키지는 SQL Plan History(이하 SPH) 기능을 사용하는데 필요로 하는 기능을 제공하기 위한
    패키지이다. SPH는 서버가 실행한 SQL의 이력을 저장 및 관리해주는 기능이다.</p>

    <p><span>Tibero</span>는 SQL로부터 실행계획을 만들어 실행한다. 이 실행계획은
    V$SQL_PLAN 등의 dynamic view를 통해 조회할 수 있다. 그러나 실행계획이 오래동안 사용되지 않거나 서버가 재부팅되면
    그 실행계획은 메모리에서 삭제된다. 이 때문에 오랜 시간에 걸친 실행계획의 변화를 감지하고 추적하기가 어렵다.</p>

    <p>SPH는 실행계획을 별도의 테이블에 저장함으로써 시간에 따른 실행계획 변화를 사용자가 쉽게 관리할 수 있게 도와준다. 단,
    이 패키지는 SYS 사용자만 사용 가능하다.</p>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e14196"/>38.2. 프러시저</h2></div></div></div>
    

    <p>본 절에서는 DBMS_SPH 패키지에서 제공하는 프러시저를 설명한다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_SPH_REPORT_PLANS"/>38.2.1. REPORT_PLANS<a id="d5e14201" class="indexterm"/></h3></div></div></div>
      

      <p>지정된 SQL의 실행계획 변화 이력을 출력한다. REPORT_PLANS_BY_DATE와 동작이 같으나 인자의 타입만
      다르다. 결과는 화면에 출력할 수 있고 파일로 저장할 수도 있다. 화면에 출력을 원할 때(인자 TO_FILE이 FALSE일 때)는
      serveroutput을 켜고 실행해야 한다.</p>

      <p>다음은 결과가 파일로 저장되는 경로이다.</p>

      <pre class="programlisting">$<span>TB_HOME</span>/instance/$<span>TB_SID</span>/sph_report.{<span class="emphasis"><em>mthr_pid</em></span>}.{<span class="emphasis"><em>current_time</em></span>}</pre>

      <div class="literallayout"><p/></div>

      <p>REPORT_PLANS 프러시저<a id="d5e14213" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">PROCEDURE REPORT_PLANS 
(
    SQL_HASH_VALUE  IN NUMBER,
    DURATION          IN PLS_INTEGER    DEFAULT 24*365*1000,
    TO_FILE           IN BOOLEAN        DEFAULT TRUE
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">SQL_HASH_VALUE</td><td>리포트할 SQL의 HASH VALUE이다.</td></tr><tr><td align="left">DURATION</td><td><p>SQL의 이력을 출력할 기간이다. 인자는 시작 시점을 의미하며 종료 시점은 항상
                  현재이다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>기준 : 실행계획의 마지막 실행시간</p>
                      </li><li style="list-style-type: circle">
                        <p>단위 : 시간(hour)</p>
                      </li><li style="list-style-type: circle">
                        <p>범위 : 0~24*365*1000</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : 24*365*1000시간(약 1000년)</p>
                      </li></ul></div></td></tr><tr><td align="left">TO_FILE</td><td><p>리포트 내용을 파일로 저장할지를 설정한다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>TRUE : 내용이 파일에 저장된다. (기본값)</p>
                      </li><li style="list-style-type: circle">
                        <p>FALSE : 내용이 화면에 출력된다.</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예외 상황</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="210" align="left"/><col/></colgroup><thead><tr><th align="left">예외 상황</th><th>설명</th></tr></thead><tbody><tr><td align="left">PARAMETER_OUT_OF_RANGE</td><td>파라미터가 지정된 범위를 벗어난 경우이다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제 </p><pre class="programlisting">SQL&gt; set serveroutput on

SQL&gt; select hash_value from v$sqlarea where sql_text like 'select hash_value%';

HASH_VALUE
----------
3870695416

1 row selected.

SQL&gt; exec dbms_sph.report_plans(3870695416, 24, FALSE); 
            <em class="lineannotation"><span class="lineannotation">-- 화면에 하루 동안의 실행계획을 모두 출력</span></em>

                         +-------------------------+
                         | SQL_PLAN_HISTORY REPORT |
                         +-------------------------+

FROM: 1997/05/29 17:29:41
TO:   1997/05/30 17:29:41

... 생략 ...</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_SPH_REPORT_PLANS_BY_DATE"/>38.2.2. REPORT_PLANS_BY_DATE<a id="d5e14274" class="indexterm"/></h3></div></div></div>
      

      <p>지정된 SQL의 실행계획 변화 이력을 출력한다. REPORT_PLANS와 동작이 같으나 인자의 타입만 다르다. 결과는
      화면에 출력할 수 있고 파일로 저장할 수도 있다. 화면에 출력을 원할 때(인자 TO_FILE이 FALSE일 때)는
      serveroutput을 켜고 실행해야 한다.</p>

      <p>다음은 결과가 파일로 저장되는 경로이다.</p>

      <pre class="programlisting">$<span>TB_HOME</span>/instance/$<span>TB_SID</span>/sph_report.{<span class="emphasis"><em>mthr_pid</em></span>}.{<span class="emphasis"><em>current_time</em></span>}</pre>

      <div class="literallayout"><p/></div>

      <p>REPORT_PLANS_BY_DATE 프러시저<a id="d5e14286" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">PROCEDURE REPORT_PLANS_BY_DATE 
(
    SQL_HASH_VALUE  IN NUMBER,
    START_DATE        IN DATE       DEFAULT SYSDATE - 365*1000,
    TO_FILE           IN BOOLEAN    DEFAULT TRUE
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">SQL_HASH_VALUE</td><td>리포트할 SQL의 HASH VALUE이다.</td></tr><tr><td align="left">START_DATE</td><td><p>SQL의 이력을 출력할 기간의 시작 시점이다. 종료 시점은 항상
                  현재이다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>기준 : 실행계획의 마지막 실행 시간</p>
                      </li><li style="list-style-type: circle">
                        <p>단위 : 일(day)</p>
                      </li><li style="list-style-type: circle">
                        <p>범위 : SYSDATE - 365*1000 ~ SYSDATE</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : SYSDATE - 365*1000(SYSDATE로부터 약
                        1000년)</p>
                      </li></ul></div></td></tr><tr><td align="left">TO_FILE</td><td><p>리포트 내용을 파일로 저장할지를 설정한다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>TRUE : 내용이 파일에 저장된다. (기본값)</p>
                      </li><li style="list-style-type: circle">
                        <p>FALSE : 내용이 화면에 출력된다.</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예외 상황</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="210" align="left"/><col/></colgroup><thead><tr><th align="left">예외 상황</th><th>설명</th></tr></thead><tbody><tr><td align="left">PARAMETER_OUT_OF_RANGE</td><td>파라미터가 지정된 범위를 벗어난 경우이다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제 </p><pre class="programlisting">SQL&gt; set serveroutput on

SQL&gt; select hash_value from v$sqlarea where sql_text like 'select hash_value%';

HASH_VALUE
----------
3870695416

1 row selected.

SQL&gt; exec dbms_sph.report_plans_by_date(3870695416, sysdate - 1, FALSE); 
            <em class="lineannotation"><span class="lineannotation">-- 화면에 하루 동안의 실행계획을 모두 출력</span></em>

                         +-------------------------+
                         | SQL_PLAN_HISTORY REPORT |
                         +-------------------------+

FROM: 1997/05/29 17:49:11
TO:   1997/05/30 17:49:11

... 생략 ...</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_SPH_REPORT_PLAN_HISTORY"/>38.2.3. REPORT_PLAN_HISTORY<a id="d5e14347" class="indexterm"/></h3></div></div></div>
      

      <p>조건을 만족하는 모든 SQL의 실행계획 변화 이력을 출력한다. REPORT_PLAN_HISTORY_BY_DATE와
      동작이 같으나 인자의 타입만 다르다. 결과는 화면에 출력할 수 있고 파일로 저장할 수도 있다. 화면에 출력을 원할 때(인자
      TO_FILE이 FALSE일 때)는 serveroutput을 켜고 실행해야 한다.</p>

      <p>다음은 결과가 파일로 저장되는 경로이다.</p>

      <pre class="programlisting">$<span>TB_HOME</span>/instance/$<span>TB_SID</span>/sph_report.{<span class="emphasis"><em>mthr_pid</em></span>}.{<span class="emphasis"><em>current_time</em></span>}</pre>

      <div class="literallayout"><p/></div>

      <p>REPORT_PLAN_HISTORY 프러시저<a id="d5e14359" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">PROCEDURE REPORT_PLAN_HISTORY 
(
    DURATION          IN PLS_INTEGER  DEFAULT 24*365*1000,
    MIN_PLAN_COUNT    IN PLS_INTEGER  DEFAULT 1,
    TO_FILE           IN BOOLEAN      DEFAULT TRUE
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">DURATION</td><td><p>SQL의 이력을 출력할 기간이다. 인자는 시작 시점을 의미하며 종료 시점은 항상
                  현재이다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>기준 : 실행계획의 마지막 실행 시간</p>
                      </li><li style="list-style-type: circle">
                        <p>단위 : 시간(hour)</p>
                      </li><li style="list-style-type: circle">
                        <p>범위 : 0~24*365*1000</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : 24*365*1000시간(약 1000년)</p>
                      </li></ul></div></td></tr><tr><td align="left">MIN_PLAN_COUNT</td><td><p>출력할 SQL의 최소 실행계획 수이다. 예를 들어 2로 지정하면 둘 이상의 실행계획을
                  가지는 SQL만 출력한다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>범위 : 1 ~ 1000000</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : 1</p>
                      </li></ul></div></td></tr><tr><td align="left">TO_FILE</td><td><p>리포트 내용을 파일로 저장할지를 설정한다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>TRUE : 내용이 파일에 저장된다. (기본값)</p>
                      </li><li style="list-style-type: circle">
                        <p>FALSE : 내용이 화면에 출력된다.</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예외 상황</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="210" align="left"/><col/></colgroup><thead><tr><th align="left">예외 상황</th><th>설명</th></tr></thead><tbody><tr><td align="left">PARAMETER_OUT_OF_RANGE</td><td>파라미터가 지정된 범위를 벗어난 경우이다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제 </p><pre class="programlisting">SQL&gt; set serveroutput on

SQL&gt; exec dbms_sph.report_plan_history(24, 1, FALSE);
                <em class="lineannotation"><span class="lineannotation">-- 화면에 하루 동안 실행된 모든 SQL의 실행계획을 모두 출력</span></em>

                         +-------------------------+
                         | SQL_PLAN_HISTORY REPORT |
                         +-------------------------+

FROM: 1997/05/29 17:49:11
TO:   1997/05/30 17:49:11

... 생략 ...</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_SPH_REPORT_PLAN_HISTORY_BY_DATE"/>38.2.4. REPORT_PLAN_HISTORY_BY_DATE<a id="d5e14426" class="indexterm"/></h3></div></div></div>
      

      <p>조건을 만족하는 모든 SQL의 실행계획 변화 이력을 출력한다. REPORT_PLAN_HISTORY와 동작이 같으나
      인자의 타입만 다르다. 결과는 화면에 출력할 수 있고 파일로 저장할 수도 있다. 화면에 출력을 원할 때(인자 TO_FILE이
      FALSE일 때)는 serveroutput을 켜고 실행해야 한다.</p>

      <p>다음은 결과가 파일로 저장되는 경로이다.</p>

      <pre class="programlisting">$<span>TB_HOME</span>/instance/$<span>TB_SID</span>/sph_report.{<span class="emphasis"><em>mthr_pid</em></span>}.{<span class="emphasis"><em>current_time</em></span>}</pre>

      <div class="literallayout"><p/></div>

      <p>REPORT_PLAN_HISTORY_BY_DATE 프러시저<a id="d5e14438" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">PROCEDURE REPORT_PLAN_HISTORY_BY_DATE 
(
    START_DATE        IN DATE         DEFAULT SYSDATE - 365*1000,
    MIN_PLAN_COUNT    IN PLS_INTEGER  DEFAULT 1,
    TO_FILE           IN BOOLEAN      DEFAULT TRUE
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">START_DATE</td><td><p>SQL의 이력을 출력할 기간의 시작 시점이다. 종료 시점은 항상
                  현재이다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>기준 : 실행계획의 마지막 실행 시간</p>
                      </li><li style="list-style-type: circle">
                        <p>단위 : 일(day)</p>
                      </li><li style="list-style-type: circle">
                        <p>범위 : SYSDATE - 365*1000 ~ SYSDATE</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : SYSDATE - 365*1000(SYSDATE로부터 약
                        1000년)</p>
                      </li></ul></div></td></tr><tr><td align="left">MIN_PLAN_COUNT</td><td><p>출력할 SQL의 최소 실행계획 수이다. 예를 들어 2로 지정하면 둘 이상의 실행계획을
                  가지는 SQL만 출력한다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>범위 : 1 ~ 1000000</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : 1</p>
                      </li></ul></div></td></tr><tr><td align="left">TO_FILE</td><td><p>리포트 내용을 파일로 저장할지를 설정한다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>TRUE : 내용이 파일에 저장된다. (기본값)</p>
                      </li><li style="list-style-type: circle">
                        <p>FALSE : 내용이 화면에 출력된다.</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예외 상황</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="210" align="left"/><col/></colgroup><thead><tr><th align="left">예외 상황</th><th>설명</th></tr></thead><tbody><tr><td align="left">PARAMETER_OUT_OF_RANGE</td><td>파라미터가 지정된 범위를 벗어난 경우이다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제 </p><pre class="programlisting">SQL&gt; set serveroutput on

SQL&gt; exec dbms_sph.report_plan_history_by_date(sysdate - 1, 1, FALSE); 
                 <em class="lineannotation"><span class="lineannotation">-- 화면에 하루 동안 실행된 모든 SQL의 실행계획을 모두 출력</span></em>

                         +-------------------------+
                         | SQL_PLAN_HISTORY REPORT |
                         +-------------------------+

FROM: 1997/05/29 17:49:11
TO:   1997/05/30 17:49:11

... 생략 ...</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_SPH_TRUNCATE_PLAN_HISTORY"/>38.2.5. TRUNCATE_PLAN_HISTORY<a id="d5e14505" class="indexterm"/></h3></div></div></div>
      

      <p>SPH에 저장된 실행계획 이력을 삭제한다. TRUNCATE_PLAN_HISTORY_BY_DATE와 동작은 같으며 인자만
      다르다.</p>

      <div class="literallayout"><p/></div>

      <p>TRUNCATE_PLAN_HISTORY 프러시저<a id="d5e14511" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">PROCEDURE TRUNCATE_PLAN_HISTORY 
(
    RETENTION_PERIOD  IN PLS_INTEGER  DEFAULT 24*365*1000
    MAX_COUNT         IN PLS_INTEGER  DEFAULT 1000000
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">RETENTION_PERIOD</td><td><p>SQL 이력을 삭제할 기간을 지정한다. 이 기간동안 실행되지 않은 실행계획은 모두
                  삭제된다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>단위 : 시간(hour)</p>
                      </li><li style="list-style-type: circle">
                        <p>범위 : 0 ~ 24*365*1000</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : 24*365*1000(약 1000년)</p>
                      </li></ul></div></td></tr><tr><td align="left">MAX_COUNT</td><td><p>실행계획을 삭제하지 않고 유지할 SQL의 수이다.</p><p>
                  RETENTION_PERIOD와 MAX_COUNT를 모두 지정하면 두 조건을 모두 만족시키는 SQL만이
                  유지된다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>범위 : 0 ~ 1000000</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : 1000000</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예외 상황</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="210" align="left"/><col/></colgroup><thead><tr><th align="left">예외 상황</th><th>설명</th></tr></thead><tbody><tr><td align="left">PARAMETER_OUT_OF_RANGE</td><td>파라미터가 지정된 범위를 벗어난 경우이다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제 </p><pre class="programlisting">SQL&gt; exec dbms_sph.truncate_plan_history(24); 
            <em class="lineannotation"><span class="lineannotation">-- 하루 동안 실행되지 않은 실행계획을 모두 삭제</span></em>

PSM completed.</pre>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_SPH_TRUNCATE_PLAN_HISTORY_BY_DATE"/>38.2.6. TRUNCATE_PLAN_HISTORY_BY_DATE<a id="d5e14568" class="indexterm"/></h3></div></div></div>
      

      <p>SPH에 저장된 실행계획 이력을 삭제한다. TRUNCATE_PLAN_HISTORY와 동작은 같으며 인자만
      다르다.</p>

      <div class="literallayout"><p/></div>

      <p>TRUNCATE_PLAN_HISTORY_BY_DATE 프러시저<a id="d5e14574" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">PROCEDURE TRUNCATE_PLAN_HISTORY_BY_DATE 
(
    START_DATE        IN DATE         DEFAULT SYSDATE - 365*1000
    MAX_COUNT         IN PLS_INTEGER  DEFAULT 1000000
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">START_DATE</td><td><p>SQL 이력을 삭제할 기준 시점이다. 이 시점 이전의 모든 실행계획 정보가
                  삭제된다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>단위 : 시간(hour)</p>
                      </li><li style="list-style-type: circle">
                        <p>범위 : SYSDATE - 365*1000 ~ SYSDATE</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : SYSDATE - 365*1000(SYSDATE로부터 약
                        1000년)</p>
                      </li></ul></div></td></tr><tr><td align="left">MAX_COUNT</td><td><p>실행계획을 삭제하지 않고 유지할 SQL의 수이다.
                  </p><p>START_DATE와 MAX_COUNT를 모두 지정하면 두 조건을 모두 만족시키는
                  SQL만이 유지된다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>범위 : 0 ~ 1000000</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : 1000000</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예외 상황</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="210" align="left"/><col/></colgroup><thead><tr><th align="left">예외 상황</th><th>설명</th></tr></thead><tbody><tr><td align="left">PARAMETER_OUT_OF_RANGE</td><td>파라미터가 지정된 범위를 벗어난 경우이다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제 </p><pre class="programlisting">SQL&gt; exec dbms_sph.truncate_plan_history_by_date(sysdate - 1); 
            <em class="lineannotation"><span class="lineannotation">-- 하루 동안 실행되지 않은 실행계획을 모두 삭제</span></em>

PSM completed.</pre>
        </li></ul></div>

      <p/>

      <p/>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="DBMS_SPH_UPDATE_PLAN_HISTORY"/>38.2.7. UPDATE_PLAN_HISTORY<a id="d5e14633" class="indexterm"/></h3></div></div></div>
      

      <p>라이브러리 cache의 실행계획을 SPH에 저장한다.</p>

      <div class="literallayout"><p/></div>

      <p>UPDATE_PLAN_HISTORY 프러시저<a id="d5e14639" class="indexterm"/>의 세부 내용은 다음과 같다.</p>

      <div class="itemizedlist"><ul type="disc" compact="compact"><li>
          <p>프로토타입</p>

          <pre class="programlisting">PROCEDURE UPDATE_PLAN_HISTORY 
(
    MIN_EXEC_COUNT    IN PLS_INTEGER  DEFAULT 1
);</pre>
        </li><li>
          <p>파라미터</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="150" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">MIN_EXEC_COUNT</td><td><p>업데이트 대상이 될 실행계획의 최소 실행 회수이다. 이 값 미만으로 실행된 실행계획은
                  SPH에 저장되지 않는다.</p><div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
                        <p>범위 : 1 ~ 1000000</p>
                      </li><li style="list-style-type: circle">
                        <p>기본값 : 1</p>
                      </li></ul></div></td></tr></tbody></table>
          </div>
        </li><li>
          <p>예외 상황</p>

          <div class="informaltable">
            <table border="1"><colgroup><col width="210" align="left"/><col/></colgroup><thead><tr><th align="left">예외 상황</th><th>설명</th></tr></thead><tbody><tr><td align="left">PARAMETER_OUT_OF_RANGE</td><td>파라미터가 지정된 범위를 벗어난 경우이다.</td></tr></tbody></table>
          </div>
        </li><li>
          <p>예제 </p><pre class="programlisting">SQL&gt; exec dbms_sph.update_plan_history(2); <em class="lineannotation"><span class="lineannotation">-- 두 번 이상 실행된 실행계획을 SPH에 저장</span></em>

PSM completed.</pre>
        </li></ul></div>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chap_dbms_space_admin.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="chap_dbms_sql.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제37장 DBMS_SPACE_ADMIN </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 제39장 DBMS_SQL</td></tr></table></div><div xmlns="" align="center"/></body></html>