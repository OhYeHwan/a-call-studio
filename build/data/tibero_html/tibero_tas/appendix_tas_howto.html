<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Appendix A. 구성 예제</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Tibero Active Storage 관리자 안내서"/><link rel="up" href="index.html" title="Tibero Active Storage 관리자 안내서"/><link rel="prev" href="chapter_cmd.html" title="제6장 커맨드라인 툴"/><link rel="next" href="idx.html" title="색인"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">Appendix A. 구성 예제</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chapter_cmd.html">이전</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="idx.html">다음</a></td></tr></table><hr/></div><div class="appendix" lang="ko"><div class="titlepage"><div><div><h2 class="title"><a id="appendix_tas_howto"/>Appendix A. 구성 예제</h2></div></div></div><div class="toc"><p><b>내용 목차</b></p><dl><dt><span class="section"><a href="appendix_tas_howto.html#d5e2839">A.1. 설치 준비</a></span></dt><dd><dl><dt><span class="section"><a href="appendix_tas_howto.html#d5e2842">A.1.1. 설치 환경</a></span></dt><dt><span class="section"><a href="appendix_tas_howto.html#d5e2893">A.1.2. 디스크 준비</a></span></dt><dt><span class="section"><a href="appendix_tas_howto.html#d5e2907">A.1.3. 커널 파라미터 설정</a></span></dt></dl></dd><dt><span class="section"><a href="appendix_tas_howto.html#d5e2918">A.2. <span>TAS</span> 인스턴스 설치</a></span></dt><dd><dl><dt><span class="section"><a href="appendix_tas_howto.html#d5e2923">A.2.1. 환경변수 설정</a></span></dt><dt><span class="section"><a href="appendix_tas_howto.html#d5e2951">A.2.2. 초기화 파라미터 설정</a></span></dt><dt><span class="section"><a href="appendix_tas_howto.html#d5e2995">A.2.3. 접속 정보 설정</a></span></dt><dt><span class="section"><a href="appendix_tas_howto.html#d5e3001">A.2.4. 디스크 스페이스 생성과 기동</a></span></dt></dl></dd><dt><span class="section"><a href="appendix_tas_howto.html#d5e3065">A.3. <span>Tibero</span> 인스턴스 설치</a></span></dt><dd><dl><dt><span class="section"><a href="appendix_tas_howto.html#d5e3071">A.3.1. 환경변수 설정</a></span></dt><dt><span class="section"><a href="appendix_tas_howto.html#d5e3100">A.3.2. 초기화 파라미터 설정</a></span></dt><dt><span class="section"><a href="appendix_tas_howto.html#d5e3138">A.3.3. 접속 정보 설정</a></span></dt><dt><span class="section"><a href="appendix_tas_howto.html#d5e3146">A.3.4. 데이터베이스 생성과 기동</a></span></dt></dl></dd><dt><span class="section"><a href="appendix_tas_howto.html#d5e3216">A.4. <span>TAS</span> 운영 권장사항</a></span></dt></dl></div>
  

  <p>본 장에서는 <span>TAS</span>를 이용해 <span>Tibero</span>를 구성하는 방법을 모범 예제(best practice)를 통해 설명한다.</p>

  <p>예제는 Linux x86_64를 기준으로 작성되었으며, <span>TAS</span>와
  <span>Tibero</span>에서 수행하는 SQL을 제외한 명령은 설치를 원하는 운영체제에 맞게 변경해서 수행해야 한다.</p><div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">참고</h3>
      <p>본 장에서 설명하는 예제는 모범 예제(best practice)일 뿐 최소 권장 사양이 아니다. 최소 권장 사양은
      "<span>Tibero</span> 설치 안내서"를 참고한다. 그리고 현재 Linux 운영체제의
      설치만 지원하고 있다.</p>
    </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e2839"/>A.1. 설치 준비</h2></div></div></div>
    

    <p>본 절에서는 데이터베이스 구성 전 준비할 사항들에 대해 설명한다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2842"/>A.1.1. 설치 환경</h3></div></div></div>
      

      <p>다음은 본 구성 예제에서 사용할 설치 환경을 나타낸 표이다.</p>

      <div class="informaltable">
        <table border="1"><colgroup><col width="220" align="left"/><col/></colgroup><thead><tr><th align="left">항목</th><th>값</th></tr></thead><tbody><tr><td align="left">노드 갯수</td><td>2</td></tr><tr><td align="left">노드 내부 IP</td><td>100.100.100.11, 100.100.100.12</td></tr><tr><td align="left"><span>TAS</span>용 PORT</td><td>9620</td></tr><tr><td align="left"><span>TAS</span>용 CM PORT</td><td>20005</td></tr><tr><td align="left"><span>TAS</span>용 LOCAL CLUSTER PORT</td><td>20000</td></tr><tr><td align="left">공유 디스크 갯수</td><td>4</td></tr><tr><td align="left">공유 디스크 크기</td><td>각 512GB</td></tr><tr><td align="left">공유 디스크 경로</td><td>/dev/sdc, /dev/sdd, /dev/sde, /dev/sdf</td></tr><tr><td align="left">설치 계정</td><td>dba</td></tr><tr><td align="left"><span>Tibero</span> 설치 경로</td><td>/home/dba/<span>tibero</span></td></tr></tbody></table>
      </div>

      <div class="itemizedlist"><ul type="circle" compact="compact"><li style="list-style-type: circle">
          <p>구성에 사용할 바이너리는 이미 해당 경로에 설치된 것으로 가정한다.</p>
        </li><li style="list-style-type: circle">
          <p>각 노드에서 보이는 공유 디스크의 경로는 같은 것으로 가정한다.</p>
        </li></ul></div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2893"/>A.1.2. 디스크 준비</h3></div></div></div>
      

      <p>다음은 설치 대상 공유 디스크를 준비하는 과정으로, 모든 노드에서 똑같이 수행한다.</p>

      <p>각 디스크의 권한 또는 소유권을 변경해 직접 사용해도 되지만 재부팅시 디스크 이름이 변경되는 문제가 발생할 수 있으므로
      이러한 문제를 예방하기 위해 udev를 사용하여 디바이스 노드를 구성하는 방법을 권고한다. 아래 예제에서는 udev를 사용하여
      구성한 디바이스 노드를 통해 <span>TAS</span>를 설치하는 방법으로 작성되어 있다.</p>

      <p>아래는 udev를 사용하여 구성된 디바이스 노드의 예제이다.</p>

      <pre class="programlisting">$ ls -al /dev/disk*
lrwxrwxrwx. 1 root root       3 Aug 13 19:50 /dev/disk0 -&gt; sdc
lrwxrwxrwx. 1 root root       3 Aug 13 19:50 /dev/disk1 -&gt; sdd
lrwxrwxrwx. 1 root root       3 Aug 13 19:50 /dev/disk2 -&gt; sde
lrwxrwxrwx. 1 root root       3 Aug 13 19:50 /dev/disk3 -&gt; sdf
$ ls -l /dev/sd*
brw-rw----. 1 root disk  8,   0 Jul 13 11:20 /dev/sda
brw-rw----. 1 root disk  8,  16 Jul 13 11:20 /dev/sdb
brw-------. 1 dba disk  8,  32 Jul 13 11:20 /dev/sdc
brw-------. 1 dba disk  8,  48 Jul 13 11:20 /dev/sdd
brw-------. 1 dba disk  8,  64 Jul 13 11:20 /dev/sde
brw-------. 1 dba disk  8,  80 Jul 13 11:20 /dev/sdf </pre>

      <p>위의 예제에서 /dev/disk*로 나타나는 링크들은 udev rules에 따라 생성된 symbolic
      link이다.</p>

      <p>다음은 디바이스 노드를 구성하기 위한 udev rules 파일의 예제이다.</p>

      <pre class="programlisting">$ cat /etc/udev/rules.d/as-disk.rules
KERNEL=="sd?", SUBSYSTEM=="block", PROGRAM=="/lib/udev/scsi_id -g -u -d %N",
RESULT=="35000c50087de8480", SYMLINK+="disk0", OWNER="dba", MODE="0600"
KERNEL=="sd?", SUBSYSTEM=="block", PROGRAM=="/lib/udev/scsi_id -g -u -d %N",
RESULT=="35000c50087de8481", SYMLINK+="disk1", OWNER="dba", MODE="0600"
KERNEL=="sd?", SUBSYSTEM=="block", PROGRAM=="/lib/udev/scsi_id -g -u -d %N",
RESULT=="35000c50087de8482", SYMLINK+="disk2", OWNER="dba", MODE="0600"
KERNEL=="sd?", SUBSYSTEM=="block", PROGRAM=="/lib/udev/scsi_id -g -u -d %N",
RESULT=="35000c50087de8483", SYMLINK+="disk3", OWNER="dba", MODE="0600"</pre>

      <p>udev rules 파일은 /etc/udev/rules.d 폴더(Ubuntu 14.04 기준, OS마다 경로가 다를 수
      있다) 안에 .rules라는 확장자로 저장되어야 한다.</p>

      <p>예제로 보여준 rule이 의미하는 바는 명시된 SCSI_ID(RESULT=="SCSI_ID")와 일치하는 디바이스를
      sd?로 표현되는 커널 이름(KERNEL=="sd?")을 가진 block 디바이스(SUBSYSTEM=="block") 노드 중에
      찾아서 소유자, 사용자 권한을 설정하고 주어진 symbolic link를 만들어 주라는 의미이다.</p>

      <p>디바이스의 SCSI_ID는 /lib/udev/scsi_id(Ubuntu 14.04기준, OS마다 경로가 다를 수
      있다)를 실행하면 확인할 수 있다. 이 프로그램은 관리자 권한으로 실행되어야 하며 아래는 scsi_id를 확인하는
      예제이다.</p>

      <pre class="programlisting">$ /lib/udev/scsi_id -g -u -d /dev/sdc
35000c50087de8480 </pre>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2907"/>A.1.3. 커널 파라미터 설정</h3></div></div></div>
      

      <p><span>TAS</span>를 이용해 <span>Tibero</span>를 구성하는 경우 "<span>Tibero</span> 설치 안내서"에 명시된 커널 파라미터 설정에 더하여 추가적인
      설정이 필요하다. 커널 파라미터 설정 파일 위치는 다음과 같다.(Linux 기준)</p>

      <pre class="programlisting">/etc/sysctl.conf</pre>

      <p>다음과 같이 커널 파라미터를 설정한다.</p>

      <pre class="programlisting">fs.aio-max-nr = 4194304</pre>

      <p>AIX 환경에서 커널 파라미터를 설정할 경우 다음 프러시저를 실행한다.</p>

      <pre class="programlisting"># ioo -p -o posix_aio_maxreqs=131072</pre>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e2918"/>A.2. <span>TAS</span> 인스턴스 설치</h2></div></div></div>
    

    <p>본 절에서는 두 개의 노드에 <span>TAS</span> 인스턴스를 구성하는 방법에 대해 설명한다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2923"/>A.2.1. 환경변수 설정</h3></div></div></div>
      

      <p>해당 운영체제의 사용자 계정별로 존재하는 환경설정 파일(.bashrc 등)에 환경 변수를 설정한다. 본 예제에서는
      다음과 같이 환경변수를 설정한다.</p>

      <p/>

      <p>모든 노드에서 <span>TAS</span> 인스턴스의 바이너리가 설정된 경로로 <span>TB_</span>HOME
      환경변수를 설정한다. 그리고 각 노드의 <span>TAS</span> 인스턴스를 구분하기 위해 <span>TB_</span>SID
      환경변수를 노드별로 다르게 설정한다.</p>

      <p>다음은 첫 번째 노드 예시이다. 첫 번째 노드의 <span>TAS</span>
      인스턴스를 위해 <span>TB_</span>SID 환경변수를 as0으로 설정한다. 첫 번째 노드의 클러스터 매니저를
      위해 CM_SID 환경변수를 cm0으로 설정한다.</p>

      <pre class="programlisting">export <span>TB_</span>HOME=/home/dba/<span>tibero</span>
export <span>TB_</span>SID=as0
export CM_SID=cm0
export LD_LIBRARY_PATH=$<span>TB_</span>HOME/lib:$<span>TB_</span>HOME/client/lib
export PATH=$PATH:$<span>TB_</span>HOME/bin:$<span>TB_</span>HOME/client/bin</pre>

      <p/>

      <p>두 번째 노드의 <span>TAS</span> 인스턴스를 위해 <span>TB_</span>SID
      환경변수를 as1로 설정한다. CM_SID 환경변수는 cm1로 설정한다.</p>

      <pre class="programlisting">[100.100.100.12]$ export <span>TB_</span>SID=as1
[<span>TB_</span>SID=as1@100.100.100.12]$ export CM_SID=cm1</pre>

      <p/>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2951"/>A.2.2. 초기화 파라미터 설정</h3></div></div></div>
      

      <p><span>TAS</span> 인스턴스의 초기화 파라미터는 기본적으로 <span>Tibero</span> Active Cluster(<span>TAC</span>)의
      초기화 파라미터와 같다.</p>

      <p><span>TAS</span> 인스턴스에서 추가로 설정해야 하는 초기화 파라미터는 다음과
      같다.</p>

      <div class="informaltable">
        <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">INSTANCE_TYPE<a id="d5e2969" class="indexterm"/></td><td>Active Storage 인스턴스임을 나타내기 위해 AS로 설정한다.</td></tr><tr><td align="left">AS_DISKSTRING<a id="d5e2974" class="indexterm"/></td><td>사용할 디스크를 찾기 위한 경로 패턴을 설정한다.</td></tr></tbody></table>
      </div>

      <p>다음은 첫 번째 노드의 초기화 파라미터이다.</p>

      <pre class="programlisting">[100.100.100.11]$ cat /home/dba/<span>tibero</span>/config/as0.<span>tip</span>
INSTANCE_TYPE=AS
AS_DISKSTRING="/dev/disk*"
AS_ALLOW_ONLY_RAW_DISKS=N

LISTENER_PORT=9620
TOTAL_SHM_SIZE=3G
MEMORY_TARGET=4G

CLUSTER_DATABASE=Y
LOCAL_CLUSTER_ADDR=100.100.100.11
LOCAL_CLUSTER_PORT=20000
CM_CLUSTER_MODE=ACTIVE_SHARED
CM_PORT=20005

THREAD=0

[100.100.100.11]$ cat /home/dba/<span>tibero</span>/config/cm0.<span>tip</span>
CM_NAME=cm0
CM_UI_PORT=20005
CM_RESOUCE_FILE=/home/dba/<span>tibero</span>/config/cm0_res.crf</pre>

      <p>다음은 두 번째 노드의 초기화 파라미터이다.</p>

      <pre class="programlisting">[100.100.100.12]$ cat /home/dba/<span>tibero</span>/config/as1.<span>tip</span>
INSTANCE_TYPE=AS
AS_DISKSTRING="/dev/disk*"
AS_ALLOW_ONLY_RAW_DISKS=N

LISTENER_PORT=9620
TOTAL_SHM_SIZE=3G
MEMORY_TARGET=4G

CLUSTER_DATABASE=Y
LOCAL_CLUSTER_ADDR=100.100.100.12
LOCAL_CLUSTER_PORT=20000
CM_CLUSTER_MODE=ACTIVE_SHARED
CM_PORT=20005

THREAD=1

[100.100.100.11]$ cat /home/dba/<span>tibero</span>/config/cm1.<span>tip</span>
CM_NAME=cm1
CM_UI_PORT=20005
CM_RESOUCE_FILE=/home/dba/<span>tibero</span>/config/cm1_res.crf</pre>

      <div class="caution" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">주의</h3>
          <p>1. 일반 파일을 디바이스처럼 사용하기 위해서는 AS_ALLOW_ONLY_RAW_DISKS를 N으로 설정해야
          한다.</p>

          <p>2. AS_DISKSTRING에 설정한 경로 패턴 포함되지 않은 디스크는 디스크 스페이스 구성에 사용할 수
          없다.</p>
        </div>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e2995"/>A.2.3. 접속 정보 설정</h3></div></div></div>
      

      <p>다음은 접속 정보 설정 파일을 설정한 예이다.</p>

      <pre class="programlisting">$ cat /home/dba/<span>tibero</span>/client/config/<span>tbdsn</span>.tbr
as0=(
    (INSTANCE=(HOST=100.100.100.11)
              (PORT=9620)
    )
)
as1=(
    (INSTANCE=(HOST=100.100.100.12)
              (PORT=9620)
    )
) </pre>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e3001"/>A.2.4. 디스크 스페이스 생성과 기동</h3></div></div></div>
      

      <p>다음은 디스크 스페이스 생성과 기동하는 과정에 대한 설명이다.</p>

      <p/>

      <div class="orderedlist"><ol type="1" compact="compact"><li>
          <p>디스크 스페이스를 생성하기 위해서 먼저 첫 번째 노드에서 <span>TAS</span>
          인스턴스를 NOMOUNT 모드로 기동한다. </p><pre class="programlisting">[<span>TB</span>_SID=as0@100.100.100.11]$ <span>tbboot</span> nomount</pre>
        </li><li>
          <p>기동된 인스턴스에 접속하여 디스크 스페이스를 생성한다.</p>

          <p>RAID와 같은 외부의 데이터 복제 기능을 사용해 데이터의 가용성을 높인 경우, 내부의 데이터 복제 기능을
          사용하지 않도록 하기 위해 EXTERNAL REDUNDANCY로 설정한다. </p><pre class="programlisting">[<span>TB</span>_SID=as0@100.100.100.11]$ <span>tbsql</span> sys/<span>tibero</span>@as0
SQL&gt; CREATE DISKSPACE ds0
     EXTERNAL REDUNDANCY
     DISK '/dev/disk0' NAME disk0 SIZE 512G,
          '/dev/disk1' NAME disk1 SIZE 512G,
          '/dev/disk2' NAME disk2 SIZE 512G,
          '/dev/disk3' NAME disk3 SIZE 512G;</pre>

          <p>디스크 스페이스 생성이 완료되면 자동으로 인스턴스가 중지되며, NORMAL 모드로 기동할 수 있는 상태가
          된다.</p>
        </li><li>
          <p>첫 번째 노드의 클러스터 매니저가 AS 바이너리를 실행하기 위해 필요한 as 리소스 환경설정용 파일을 미리
          생성한다. </p><pre class="programlisting">[CM_SID=cm0@100.100.100.11]$ cat $<span>TB</span>_HOME/as0.profile
export <span>TB</span>_SID=as0</pre>
        </li><li>
          <p><span>TAS</span> 인스턴스들의 클러스터링을 위해서 클러스터 매니저를 기동하고 리소스를
          추가해준다. as 리소스를 추가할 때에는 미리 생성한 환경설정용 파일의 경로를 envfile attribute에 지정해줘야
          한다. </p><pre class="programlisting">[CM_SID=cm0@100.100.100.11]$ <span>tb</span>cm -b
[CM_SID=cm0@100.100.100.11]$ cmrctl add network --name net0 --ipaddr
100.100.100.11 --portno 20010
[CM_SID=cm0@100.100.100.11]$ cmrctl add cluster --name cls0 --incnet net0
--cfile "+/dev/disk*"
[CM_SID=cm0@100.100.100.11]$ cmrctl start cluster --name cls0
[CM_SID=cm0@100.100.100.11]$ cmrctl add service --type as --name <span>tas</span> --cname cls0
[CM_SID=cm0@100.100.100.11]$ cmrctl add as --name as0 --svcname <span>tas</span> --envfile
"$<span>TB</span>_HOME/as0.profile" --dbhome "$<span>TB</span>_HOME"</pre>
        </li><li>
          <p>인스턴스를 NORMAL 모드로 기동한다. </p><pre class="programlisting">[<span>TB</span>_SID=as0@100.100.100.11]$ <span>tbboot</span>
# 또는 [CM_SID=cm0@100.100.100.11]$ cmrctl start as --name as0</pre>
        </li><li>
          <p/>

          <p>기동이 완료되면 인스턴스에 접속해 두 번째 노드의 <span>TAS</span>
          인스턴스를 위한 THREAD를 추가한다.</p>

          <pre class="programlisting">[<span>TB</span>_SID=as0@100.100.100.11]$ <span>tbsql</span> sys/<span>tibero</span>@as0
SQL&gt; ALTER DISKSPACE ds0 ADD THREAD 1;</pre>
        </li><li>
          <p>두 번째 노드의 클러스터 매니저가 AS 바이너리를 실행하기 위해 필요한 as 리소스 환경설정용 파일을 미리
          생성한다. </p><pre class="programlisting">[CM_SID=cm1@100.100.100.12]$ cat $<span>TB</span>_HOME/as1.profile
export <span>TB</span>_SID=as1</pre>
        </li><li>
          <p>두 번째 노드에서 클러스터 매니저를 기동하고 리소스를 추가해준다. </p><pre class="programlisting">[CM_SID=cm1@100.100.100.12]$ <span>tbcm</span> -b
[CM_SID=cm1@100.100.100.12]$ cmrctl add network --name net1 --ipaddr
100.100.100.12 --portno 20010
[CM_SID=cm1@100.100.100.12]$ cmrctl add cluster --name cls0 --incnet net1
--cfile "+/devs/disk*"
[CM_SID=cm1@100.100.100.12]$ cmrctl start cluster --name cls0
[CM_SID=cm1@100.100.100.12]$ cmrctl add as --name as1 --svcname <span>tas</span> --envfile
"$<span>TB</span>_HOME/as1.profile" --dbhome "$<span>TB</span>_HOME"</pre>
        </li><li>
          <p>두 번째 노드의 <span>TAS</span> 인스턴스를 기동한다. </p><pre class="programlisting">[<span>TB</span>_SID=as1@100.100.100.12]$ <span>tbboot</span>
# 또는 [CM_SID=cm1@100.100.100.12]$ cmrctl start as --name as1</pre>
        </li></ol></div>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e3065"/>A.3. <span>Tibero</span> 인스턴스 설치</h2></div></div></div>
    

    <p><span>Tibero</span> 인스턴스를 설치하고 기동하는 과정은 <span>TAS</span> 인스턴스를
    사용하지 않는 경우와 동일하며 생성할 파일의 경로를 지정하는 방법에만 차이가 있다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e3071"/>A.3.1. 환경변수 설정</h3></div></div></div>
      

      <p>해당 운영체제의 사용자 계정별로 존재하는 환경설정 파일(.bashrc 등)에 환경 변수를 설정한다. 본 예제에서는
      다음과 같이 환경변수를 설정한다.</p>

      <p>먼저 모든 노드에서 <span>Tibero</span> 인스턴스의 바이너리가 설정된 경로로 <span>TB_</span>HOME
      환경변수를 설정한다. 그리고 각 노드에서 <span>TB_</span>SID 환경변수를 설정한다. 첫 번째 노드의 DB 인스턴스를 위해
      <span>TB_</span>SID 환경변수를 <span>tac0</span>으로
      설정한다.</p>

      <pre class="programlisting">export <span>TB_</span>HOME=/home/dba/<span>tibero</span>
export <span>TB_</span>SID=<span>tac0</span>
export CM_SID=cm0
export LD_LIBRARY_PATH=$<span>TB_</span>HOME/lib:$<span>TB_</span>HOME/client/lib
export PATH=$PATH:$<span>TB_</span>HOME/bin:$<span>TB_</span>HOME/client/bin</pre>

      <div class="literallayout"><p/></div>

      <p>두 번째 노드의 DB 인스턴스를 위해 <span>TB_</span>SID 환경변수를 <span>tac1</span>로
      설정한다. CM_SID가 설정되어 있지 않다면 cm1으로 설정해준다.</p>

      <pre class="programlisting">[100.100.100.12]$ export <span>TB_</span>SID=<span>tac1</span>
[<span>TB_</span>SID=<span>tac1</span>@100.100.100.12]$ export CM_SID=cm1</pre>

      <p>하나의 서버에 여러 인스턴스를 띄우는 경우에는 SID가 달라야하지만 다른 서버에 각 인스턴스를 띄울때는 SID가 같아도
      무방하다.</p>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e3100"/>A.3.2. 초기화 파라미터 설정</h3></div></div></div>
      

      <p><span>TAS</span> 인스턴스를 사용하기 위해서는 다음의 두 가지 파라미터를
      설정한다.</p>

      <p/>

      <div class="informaltable">
        <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>설명</th></tr></thead><tbody><tr><td align="left">USE_ACTIVE_STORAGE<a id="d5e3115" class="indexterm"/></td><td><span>TAS</span> 인스턴스를 사용하기 위해 Y로 설정한다.</td></tr><tr><td align="left">AS_PORT<a id="d5e3121" class="indexterm"/></td><td><span>TAS</span> 인스턴스에 접속하기 위해 <span>TAS</span> 인스턴스의 LISTENER_PORT를
              설정한다.</td></tr></tbody></table>
      </div>

      <p>다음은 첫 번째 노드의 초기화 파라미터이다.</p>

      <pre class="programlisting">[100.100.100.11]$ cat /home/dba/<span>tibero</span>/config/<span>tac0</span>.<span>tip</span>
DB_NAME=<span>tibero</span>
LISTENER_PORT=8629
DB_BLOCK_SIZE=32K
MAX_SESSION_COUNT=300
TOTAL_SHM_SIZE=70G
DB_CACHE_SIZE=55G
MEMORY_TARGET=250G
CONTROL_FILES="+DS0/c1.ctl"

USE_ACTIVE_STORAGE=Y
AS_PORT=9620

CLUSTER_DATABASE=Y
LOCAL_CLUSTER_ADDR=100.100.100.11
LOCAL_CLUSTER_PORT=21000
CM_PORT=20005

THREAD=0
UNDO_TABLESPACE=UNDO00 </pre>

      <p>다음은 두 번째 노드의 초기화 파라미터이다.</p>

      <pre class="programlisting">[100.100.100.12]$ cat /home/dba/<span>tibero</span>/config/<span>tac1</span>.<span>tip</span>
DB_NAME=<span>tibero</span>
LISTENER_PORT=8629
DB_BLOCK_SIZE=32K
MAX_SESSION_COUNT=300
TOTAL_SHM_SIZE=70G
DB_CACHE_SIZE=55G
MEMORY_TARGET=250G
CONTROL_FILES="+DS0/c1.ctl"

USE_ACTIVE_STORAGE=Y
AS_PORT=9620

CLUSTER_DATABASE=Y
LOCAL_CLUSTER_ADDR=100.100.100.12
LOCAL_CLUSTER_PORT=21000
CM_PORT=20005

THREAD=1
UNDO_TABLESPACE=UNDO01 </pre>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e3138"/>A.3.3. 접속 정보 설정</h3></div></div></div>
      

      <p>다음은 접속 정보 설정 파일을 설정한 예이다.</p>

      <pre class="programlisting">$ cat /home/dba/<span>tibero</span>/client/config/<span>tbdsn</span>.tbr
<span>tac0</span>=(
    (INSTANCE=(HOST=100.100.100.11)
              (PORT=8629)
    )
)
<span>tac1</span>=(
    (INSTANCE=(HOST=100.100.100.12)
              (PORT=8629)
    )
) </pre>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="d5e3146"/>A.3.4. 데이터베이스 생성과 기동</h3></div></div></div>
      

      <p>다음은 데이터베이스 생성과 기동하는 과정에 대한 설명이다.</p>

      <div class="orderedlist"><ol type="1" compact="compact"><li>
          <p>클러스터 매니저가 <span>Tibero</span> 바이너리를 실행하기 위해 필요한 DB 리소스 환경설정용
          파일을 미리 생성한다. </p><pre class="programlisting">[CM_SID=cm0@100.100.100.11]$ cat $<span>TB</span>_HOME/<span>tac0</span>.profile
export <span>TB</span>_SID=<span>tac0</span></pre><pre class="programlisting">[CM_SID=cm1@100.100.100.12]$ cat $<span>TB</span>_HOME/<span>tac1</span>.profile
export <span>TB</span>_SID=<span>tac1</span></pre>
        </li><li>
          <p>우선 첫 번째 노드에서 <span>TAS</span> 인스턴스를 구성할 때에 부팅한 클러스터 매니저에 <span>Tibero</span> 클러스터링을 위해 사용할 리소스를 생성한다.
          </p><pre class="programlisting">[CM_SID=cm0@100.100.100.11]$ cmrctl add service --type db --name <span>tibero</span>
--cname cls0
[CM_SID=cm0@100.100.100.11]$ cmrctl add db --name <span>tac0</span> --svcname <span>tibero</span>
--envfile "$<span>TB</span>_HOME/<span>tac0</span>.profile" --dbhome "$<span>TB</span>_HOME"</pre>
        </li><li>
          <p>인스턴스를 NOMOUNT 모드로 기동한다. </p><pre class="programlisting">[<span>TB</span>_SID=<span>tac0</span>@100.100.100.11]$ <span>tbboot</span> -t nomount</pre>
        </li><li>
          <p>인스턴스에 접속해 데이터베이스를 생성한다. </p><pre class="programlisting">[<span>TB</span>_SID=<span>tac0</span>@100.100.100.11]$ <span>tbsql</span> sys/<span>tibero</span>@<span>tac0</span>
SQL&gt; CREATE DATABASE "<span>tibero</span>"
    USER sys IDENTIFIED BY <span>tibero</span>
    MAXINSTANCES 32
    MAXDATAFILES 2048
    CHARACTER SET MSWIN949
    LOGFILE GROUP 1 '+DS0/log001' SIZE 2G,
            GROUP 2 '+DS0/log002' SIZE 2G,
            GROUP 3 '+DS0/log003' SIZE 2G
    MAXLOGGROUPS 255
    MAXLOGMEMBERS 8
    NOARCHIVELOG
    DATAFILE '+DS0/system.tdf' SIZE 4G
            AUTOEXTEND ON NEXT 64M MAXSIZE UNLIMITED
    SYSSUB DATAFILE '+DS0/syssub.tdf' SIZE 4G
            AUTOEXTEND ON NEXT 64M MAXSIZE UNLIMITED
    DEFAULT TEMPORARY TABLESPACE temp
            TEMPFILE '+DS0/temp00.tdf' SIZE 32G AUTOEXTEND OFF
    UNDO TABLESPACE undo00
            DATAFILE '+DS0/undo00.tdf' SIZE 32G AUTOEXTEND OFF
    DEFAULT TABLESPACE usr DATAFILE '+DS0/usr.tdf' SIZE 4G
            AUTOEXTEND ON NEXT 64m MAXSIZE UNLIMITED;</pre>
        </li><li>
          <p>인스턴스를 NORMAL 모드로 재기동한 후 두 번째 노드에서 사용할 UNDO 테이블 스페이스와 REDO
          THREAD를 생성한다.</p>

          <pre class="programlisting">[<span>TB</span>_SID=<span>tac0</span>@100.100.100.11]$ <span>tbboot</span>
[<span>TB</span>_SID=<span>tac0</span>@100.100.100.11]$ <span>tbsql</span> sys/<span>tibero</span>@<span>tac0</span>
SQL&gt; CREATE UNDO TABLESPACE undo01
            DATAFILE '+DS0/undo01.tdf' size 32G autoextend off;
SQL&gt; ALTER DATABASE ADD LOGFILE THREAD 1 GROUP 4 '+DS0/log004' size 2G;
SQL&gt; ALTER DATABASE ADD LOGFILE THREAD 1 GROUP 5 '+DS0/log005' size 2G;
SQL&gt; ALTER DATABASE ADD LOGFILE THREAD 1 GROUP 6 '+DS0/log006' size 2G;
SQL&gt; ALTER DATABASE ENABLE PUBLIC THREAD 1;</pre>
        </li><li>
          <p>두 번째 노드의 클러스터 매니저에 DB 리소스를 추가한다. </p><pre class="programlisting">[CM_SID=cm1@100.100.100.12]$ cmrctl add db --name <span>tac1</span> --svcname <span>tibero</span>
--envfile "$<span>TB</span>_HOME/<span>tac1</span>.profile" --dbhome "$<span>TB</span>_HOME"</pre>
        </li><li>
          <p>두 번째 노드의 인스턴스를 기동한다. </p><pre class="programlisting">[<span>TB</span>_SID=<span>tac1</span>@100.100.100.12]$ <span>tbboot</span></pre>
        </li></ol></div>

      <p/>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="d5e3216"/>A.4. <span>TAS</span> 운영 권장사항</h2></div></div></div>
    

    <p><span>TAS</span>를 설치하고 운영하는데 필요한 권장사항이다.</p>

    <div class="itemizedlist"><ul type="disc" compact="compact"><li>
        <p><span><strong class="guibutton">초기화 파라미터 설정</strong></span></p>

        <p>Active Storage 인스턴스는 데이터베이스 인스턴스보다 더 적은 양의 메모리를 사용한다. 원활한 운영을
        위해서 다음 예와 같이 메모리 파라미터를 설정하는 것이 좋다.</p>

        <div class="informaltable">
          <table border="1"><colgroup><col width="180" align="left"/><col/></colgroup><thead><tr><th align="left">파라미터</th><th>값</th></tr></thead><tbody><tr><td align="left">TOTAL_SHM_SIZE<a id="d5e3236" class="indexterm"/></td><td>1GB 이상</td></tr><tr><td align="left">MEMORY_TARGET<a id="d5e3241" class="indexterm"/></td><td>2GB 이상</td></tr></tbody></table>
        </div>
      </li><li>
        <p><span><strong class="guibutton">디스크 스페이스 REDUNDANCY 설정</strong></span></p>

        <p>RAID와 같이 외부적인 데이터 복제 기능을 사용하고 있는 경우 REDUNDANCY를 EXTERNAL로 설정해도
        무방하고, 그렇지 않은 경우라면 REDUNDANCY를 NORMAL로 설정하는 것이 좋다. 만약 속도적인 측면보다 데이터의
        가용성 측면이 중요한 경우라면 REDUNDANCY를 HIGH로 설정하는 것이 좋다.</p>
      </li><li>
        <p><span><strong class="guibutton">디스크 스페이스 실패 그룹 설정</strong></span></p>

        <p>물리적으로 같은 서버 또는 같은 스위치에 속해 있는 디스크들은 같은 실패 그룹으로 설정하는 것이 좋다. 스위치
        고장, 케이블 고장 등이 발생했을 때 이 디스크들은 동시에 접근 불가 상태가 될 확률이 높기 때문이다. Active
        Storage는 다른 실패 그룹에 복사본을 저장해놓기 때문에 한 실패 그룹에 문제가 생겨도 데이터 접근이 가능하다. 디스크
        스페이스의 총 실패 그룹 개수는 3 개 이상으로 구성하는 것이 좋다.</p>
      </li><li>
        <p><span><strong class="guibutton">디스크 스페이스 용량 설정</strong></span></p>

        <p>디스크 스페이스의 용량은 운영할 데이터베이스의 용량에 따라 적절히 구성한다. 한 디스크 스페이스가 가질 수 있는
        최대 용량은 8 엑사바이트이다. 디스크 장애가 발생하여 데이터 복사본을 새로 만들어야 하는 경우가 생길 수 있으므로 남는
        용량이 존재하도록 구성하는 것이 좋다.</p>
      </li><li>
        <p><span><strong class="guibutton">DBA용 관리 팁</strong></span></p>

        <p>SYS 사용자로 SQL을 이용해 Active Storage 인스턴스에 접속을 할 수 있으며 <a href="chapter_view.html" title="제4장 TAS 정보 조회">“제4장 <span>TAS</span> 정보 조회”</a>에 설명한 뷰들을 이용해 현재 디스크 스페이스 상태, 디스크 상태를 확인할 수
        있다. 만약 디스크 장애가 발생하면 뷰에서 디스크 상태가 FAIL로 바뀌게 된다.</p>
      </li><li>
        <p><span><strong class="guibutton">디스크 속성</strong></span></p>

        <p>디스크 스페이스를 구성하는 디스크들의 속성(크기와 속도)은 비슷한 것이 좋다. 디스크가 크기와 속도가 같으면 각
        디스크가 같은 비율로 사용이 되며 이러한 경우 스트라이핑에 효과적이다.</p>
      </li></ul></div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chapter_cmd.html">이전</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="idx.html">다음</a></td></tr><tr><td width="40%" align="left" valign="top">제6장 커맨드라인 툴 </td><td width="20%" align="center"><a accesskey="h" href="index.html">처음으로</a></td><td width="40%" align="right" valign="top"> 색인</td></tr></table></div><div xmlns="" align="center"/></body></html>